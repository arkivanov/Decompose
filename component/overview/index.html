<!doctype html><html lang=en class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Kotlin Multiplatform lifecycle-aware business logic components (aka BLoCs) with routing functionality and pluggable UI (Compose, SwiftUI, JS React, etc.)"><meta name=author content="Arkadii Ivanov"><link href=https://arkivanov.github.io/Decompose/component/overview/ rel=canonical><link href=../../getting-started/contributing/ rel=prev><link href=../child-components/ rel=next><link rel=icon href=../../media/logo/circle-2.png><meta name=generator content="mkdocs-1.6.1, mkdocs-material-9.6.22"><title>Overview - Decompose</title><link rel=stylesheet href=../../assets/stylesheets/main.84d31ad4.min.css><link rel=stylesheet href=../../assets/stylesheets/palette.06af60db.min.css><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback"><style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style><script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script></head> <body dir=ltr data-md-color-scheme=default data-md-color-primary=indigo data-md-color-accent=indigo> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#component-overview class=md-skip> Skip to content </a> </div> <div data-md-component=announce> </div> <header class=md-header data-md-component=header> <nav class="md-header__inner md-grid" aria-label=Header> <a href=../.. title=Decompose class="md-header__button md-logo" aria-label=Decompose data-md-component=logo> <img src=../../media/logo/circle-2.png alt=logo> </a> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> Decompose </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> Overview </span> </div> </div> </div> <form class=md-header__option data-md-component=palette> <input class=md-option data-md-color-media data-md-color-scheme=default data-md-color-primary=indigo data-md-color-accent=indigo aria-label="Switch to dark mode" type=radio name=__palette id=__palette_0> <label class="md-header__button md-icon" title="Switch to dark mode" for=__palette_1 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg> </label> <input class=md-option data-md-color-media data-md-color-scheme=slate data-md-color-primary=indigo data-md-color-accent=indigo aria-label="Switch to light mode" type=radio name=__palette id=__palette_1> <label class="md-header__button md-icon" title="Switch to light mode" for=__palette_0 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg> </label> </form> <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script> <label class="md-header__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Search placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg> </label> <nav class=md-search__options aria-label=Search> <button type=reset class="md-search__icon md-icon" title=Clear aria-label=Clear tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg> </button> </nav> </form> <div class=md-search__output> <div class=md-search__scrollwrap tabindex=0 data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Initializing search </div> <ol class=md-search-result__list role=presentation></ol> </div> </div> </div> </div> </div> <div class=md-header__source> <a href=https://github.com/arkivanov/Decompose title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg> </div> <div class=md-source__repository> arkivanov/Decompose </div> </a> </div> </nav> </header> <div class=md-container data-md-component=container> <nav class=md-tabs aria-label=Tabs data-md-component=tabs> <div class=md-grid> <ul class=md-tabs__list> <li class=md-tabs__item> <a href=../.. class=md-tabs__link> Getting started </a> </li> <li class="md-tabs__item md-tabs__item--active"> <a href=./ class=md-tabs__link> Component </a> </li> <li class=md-tabs__item> <a href=../../navigation/overview/ class=md-tabs__link> Navigation </a> </li> <li class=md-tabs__item> <a href=../../extensions/overview/ class=md-tabs__link> Extensions </a> </li> <li class=md-tabs__item> <a href=../../samples/ class=md-tabs__link> Samples </a> </li> <li class=md-tabs__item> <a href=../../tips-tricks/overview/ class=md-tabs__link> Tips and Tricks </a> </li> <li class=md-tabs__item> <a href=../../faq/ class=md-tabs__link> FAQ </a> </li> <li class=md-tabs__item> <a href=../../community/ class=md-tabs__link> Community </a> </li> </ul> </div> </nav> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary md-nav--lifted" aria-label=Navigation data-md-level=0> <label class=md-nav__title for=__drawer> <a href=../.. title=Decompose class="md-nav__button md-logo" aria-label=Decompose data-md-component=logo> <img src=../../media/logo/circle-2.png alt=logo> </a> Decompose </label> <div class=md-nav__source> <a href=https://github.com/arkivanov/Decompose title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg> </div> <div class=md-source__repository> arkivanov/Decompose </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_1> <label class=md-nav__link for=__nav_1 id=__nav_1_label tabindex=0> <span class=md-ellipsis> Getting started </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_1_label aria-expanded=false> <label class=md-nav__title for=__nav_1> <span class="md-nav__icon md-icon"></span> Getting started </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../.. class=md-nav__link> <span class=md-ellipsis> Overview </span> </a> </li> <li class=md-nav__item> <a href=../../getting-started/installation/ class=md-nav__link> <span class=md-ellipsis> Installation </span> </a> </li> <li class=md-nav__item> <a href=../../getting-started/quick-start/ class=md-nav__link> <span class=md-ellipsis> Quick start </span> </a> </li> <li class=md-nav__item> <a href=../../getting-started/license/ class=md-nav__link> <span class=md-ellipsis> License </span> </a> </li> <li class=md-nav__item> <a href=../../getting-started/contributing/ class=md-nav__link> <span class=md-ellipsis> Contributing </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2 checked> <label class=md-nav__link for=__nav_2 id=__nav_2_label tabindex> <span class=md-ellipsis> Component </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_2_label aria-expanded=true> <label class=md-nav__title for=__nav_2> <span class="md-nav__icon md-icon"></span> Component </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" type=checkbox id=__toc> <label class="md-nav__link md-nav__link--active" for=__toc> <span class=md-ellipsis> Overview </span> <span class="md-nav__icon md-icon"></span> </label> <a href=./ class="md-nav__link md-nav__link--active"> <span class=md-ellipsis> Overview </span> </a> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#component-hierarchy class=md-nav__link> <span class=md-ellipsis> Component hierarchy </span> </a> </li> <li class=md-nav__item> <a href=#pluggable-ui-hierarchy class=md-nav__link> <span class=md-ellipsis> Pluggable UI hierarchy </span> </a> </li> <li class=md-nav__item> <a href=#typical-component-structure class=md-nav__link> <span class=md-ellipsis> Typical component structure </span> </a> </li> <li class=md-nav__item> <a href=#componentcontext class=md-nav__link> <span class=md-ellipsis> ComponentContext </span> </a> </li> <li class=md-nav__item> <a href=#root-componentcontext class=md-nav__link> <span class=md-ellipsis> Root ComponentContext </span> </a> <nav class=md-nav aria-label="Root ComponentContext"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#root-componentcontext-in-android class=md-nav__link> <span class=md-ellipsis> Root ComponentContext in Android </span> </a> <nav class=md-nav aria-label="Root ComponentContext in Android"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#root-componentcontext-in-activity class=md-nav__link> <span class=md-ellipsis> Root ComponentContext in Activity </span> </a> </li> <li class=md-nav__item> <a href=#root-componentcontext-in-fragment class=md-nav__link> <span class=md-ellipsis> Root ComponentContext in Fragment </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#root-componentcontext-in-jetpackjetbrains-compose class=md-nav__link> <span class=md-ellipsis> Root ComponentContext in Jetpack/JetBrains Compose </span> </a> <nav class=md-nav aria-label="Root ComponentContext in Jetpack/JetBrains Compose"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#android-with-compose class=md-nav__link> <span class=md-ellipsis> Android with Compose </span> </a> </li> <li class=md-nav__item> <a href=#jvmdesktop-with-compose class=md-nav__link> <span class=md-ellipsis> JVM/Desktop with Compose </span> </a> </li> <li class=md-nav__item> <a href=#other-platforms-with-compose class=md-nav__link> <span class=md-ellipsis> Other platforms with Compose </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#value-and-mutablevalue-state-holders class=md-nav__link> <span class=md-ellipsis> Value and MutableValue state holders </span> </a> <nav class=md-nav aria-label="Value and MutableValue state holders"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#why-not-stateflow class=md-nav__link> <span class=md-ellipsis> Why not StateFlow? </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#examples class=md-nav__link> <span class=md-ellipsis> Examples </span> </a> <nav class=md-nav aria-label=Examples> <ul class=md-nav__list> <li class=md-nav__item> <a href=#simplest-component-example class=md-nav__link> <span class=md-ellipsis> Simplest Component Example </span> </a> </li> <li class=md-nav__item> <a href=#jetpackjetbrains-compose-ui-example class=md-nav__link> <span class=md-ellipsis> Jetpack/JetBrains Compose UI Example </span> </a> </li> <li class=md-nav__item> <a href=#swiftui-example class=md-nav__link> <span class=md-ellipsis> SwiftUI Example </span> </a> <nav class=md-nav aria-label="SwiftUI Example"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#what-is-statevalue class=md-nav__link> <span class=md-ellipsis> What is StateValue </span> </a> </li> <li class=md-nav__item> <a href=#more-swift-utilities class=md-nav__link> <span class=md-ellipsis> More Swift utilities </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../child-components/ class=md-nav__link> <span class=md-ellipsis> Child components </span> </a> </li> <li class=md-nav__item> <a href=../lifecycle/ class=md-nav__link> <span class=md-ellipsis> Lifecycle </span> </a> </li> <li class=md-nav__item> <a href=../state-preservation/ class=md-nav__link> <span class=md-ellipsis> State preservation (aka SavedStateHandle) </span> </a> </li> <li class=md-nav__item> <a href=../instance-retaining/ class=md-nav__link> <span class=md-ellipsis> Instance retaining (aka ViewModel) </span> </a> </li> <li class=md-nav__item> <a href=../back-button/ class=md-nav__link> <span class=md-ellipsis> Back button </span> </a> </li> <li class=md-nav__item> <a href=../scopes/ class=md-nav__link> <span class=md-ellipsis> Scoping jobs and subscriptions </span> </a> </li> <li class=md-nav__item> <a href=../custom-component-context/ class=md-nav__link> <span class=md-ellipsis> Custom ComponentContext </span> </a> </li> <li class=md-nav__item> <a href=../jetpack-component-context/ class=md-nav__link> <span class=md-ellipsis> JetpackComponentContext </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_3> <label class=md-nav__link for=__nav_3 id=__nav_3_label tabindex=0> <span class=md-ellipsis> Navigation </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_3_label aria-expanded=false> <label class=md-nav__title for=__nav_3> <span class="md-nav__icon md-icon"></span> Navigation </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../navigation/overview/ class=md-nav__link> <span class=md-ellipsis> Overview </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_3_2> <label class=md-nav__link for=__nav_3_2 id=__nav_3_2_label tabindex=0> <span class=md-ellipsis> Child Stack </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_3_2_label aria-expanded=false> <label class=md-nav__title for=__nav_3_2> <span class="md-nav__icon md-icon"></span> Child Stack </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../navigation/stack/overview/ class=md-nav__link> <span class=md-ellipsis> Overview </span> </a> </li> <li class=md-nav__item> <a href=../../navigation/stack/navigation/ class=md-nav__link> <span class=md-ellipsis> Navigation </span> </a> </li> <li class=md-nav__item> <a href=../../navigation/stack/deeplinking/ class=md-nav__link> <span class=md-ellipsis> Deep linking </span> </a> </li> <li class=md-nav__item> <a href=../../navigation/stack/browser-history/ class=md-nav__link> <span class=md-ellipsis> Web browser history </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_3_3> <label class=md-nav__link for=__nav_3_3 id=__nav_3_3_label tabindex=0> <span class=md-ellipsis> Child Slot </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_3_3_label aria-expanded=false> <label class=md-nav__title for=__nav_3_3> <span class="md-nav__icon md-icon"></span> Child Slot </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../navigation/slot/overview/ class=md-nav__link> <span class=md-ellipsis> Overview </span> </a> </li> <li class=md-nav__item> <a href=../../navigation/slot/navigation/ class=md-nav__link> <span class=md-ellipsis> Navigation </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_3_4> <label class=md-nav__link for=__nav_3_4 id=__nav_3_4_label tabindex=0> <span class=md-ellipsis> Child Pages </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_3_4_label aria-expanded=false> <label class=md-nav__title for=__nav_3_4> <span class="md-nav__icon md-icon"></span> Child Pages </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../navigation/pages/overview/ class=md-nav__link> <span class=md-ellipsis> Overview </span> </a> </li> <li class=md-nav__item> <a href=../../navigation/pages/navigation/ class=md-nav__link> <span class=md-ellipsis> Navigation </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_3_5> <label class=md-nav__link for=__nav_3_5 id=__nav_3_5_label tabindex=0> <span class=md-ellipsis> Child Panels </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_3_5_label aria-expanded=false> <label class=md-nav__title for=__nav_3_5> <span class="md-nav__icon md-icon"></span> Child Panels </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../navigation/panels/overview/ class=md-nav__link> <span class=md-ellipsis> Overview </span> </a> </li> <li class=md-nav__item> <a href=../../navigation/panels/navigation/ class=md-nav__link> <span class=md-ellipsis> Navigation </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_3_6> <label class=md-nav__link for=__nav_3_6 id=__nav_3_6_label tabindex=0> <span class=md-ellipsis> Child Items </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_3_6_label aria-expanded=false> <label class=md-nav__title for=__nav_3_6> <span class="md-nav__icon md-icon"></span> Child Items </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../navigation/items/overview/ class=md-nav__link> <span class=md-ellipsis> Overview </span> </a> </li> <li class=md-nav__item> <a href=../../navigation/items/navigation/ class=md-nav__link> <span class=md-ellipsis> Navigation </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_3_7> <label class=md-nav__link for=__nav_3_7 id=__nav_3_7_label tabindex=0> <span class=md-ellipsis> Generic Navigation </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_3_7_label aria-expanded=false> <label class=md-nav__title for=__nav_3_7> <span class="md-nav__icon md-icon"></span> Generic Navigation </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../navigation/children/overview/ class=md-nav__link> <span class=md-ellipsis> Overview </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../../navigation/web-navigation/ class=md-nav__link> <span class=md-ellipsis> Web Navigation </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_4> <label class=md-nav__link for=__nav_4 id=__nav_4_label tabindex=0> <span class=md-ellipsis> Extensions </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_4_label aria-expanded=false> <label class=md-nav__title for=__nav_4> <span class="md-nav__icon md-icon"></span> Extensions </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../extensions/overview/ class=md-nav__link> <span class=md-ellipsis> Overview </span> </a> </li> <li class=md-nav__item> <a href=../../extensions/compose/ class=md-nav__link> <span class=md-ellipsis> Extensions for Jetpack/JetBrains Compose </span> </a> </li> <li class=md-nav__item> <a href=../../extensions/android/ class=md-nav__link> <span class=md-ellipsis> Extensions for Android views </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../../samples/ class=md-nav__link> <span class=md-ellipsis> Samples </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_6> <label class=md-nav__link for=__nav_6 id=__nav_6_label tabindex=0> <span class=md-ellipsis> Tips and Tricks </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_6_label aria-expanded=false> <label class=md-nav__title for=__nav_6> <span class="md-nav__icon md-icon"></span> Tips and Tricks </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../tips-tricks/overview/ class=md-nav__link> <span class=md-ellipsis> Overview </span> </a> </li> <li class=md-nav__item> <a href=../../tips-tricks/composable-viewmodel/ class=md-nav__link> <span class=md-ellipsis> Calling Composable functions with ViewModels </span> </a> </li> <li class=md-nav__item> <a href=../../tips-tricks/navigation-compose-component/ class=md-nav__link> <span class=md-ellipsis> Hosting a component in navigation-compose </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../../faq/ class=md-nav__link> <span class=md-ellipsis> FAQ </span> </a> </li> <li class=md-nav__item> <a href=../../community/ class=md-nav__link> <span class=md-ellipsis> Community </span> </a> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=sidebar data-md-type=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#component-hierarchy class=md-nav__link> <span class=md-ellipsis> Component hierarchy </span> </a> </li> <li class=md-nav__item> <a href=#pluggable-ui-hierarchy class=md-nav__link> <span class=md-ellipsis> Pluggable UI hierarchy </span> </a> </li> <li class=md-nav__item> <a href=#typical-component-structure class=md-nav__link> <span class=md-ellipsis> Typical component structure </span> </a> </li> <li class=md-nav__item> <a href=#componentcontext class=md-nav__link> <span class=md-ellipsis> ComponentContext </span> </a> </li> <li class=md-nav__item> <a href=#root-componentcontext class=md-nav__link> <span class=md-ellipsis> Root ComponentContext </span> </a> <nav class=md-nav aria-label="Root ComponentContext"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#root-componentcontext-in-android class=md-nav__link> <span class=md-ellipsis> Root ComponentContext in Android </span> </a> <nav class=md-nav aria-label="Root ComponentContext in Android"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#root-componentcontext-in-activity class=md-nav__link> <span class=md-ellipsis> Root ComponentContext in Activity </span> </a> </li> <li class=md-nav__item> <a href=#root-componentcontext-in-fragment class=md-nav__link> <span class=md-ellipsis> Root ComponentContext in Fragment </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#root-componentcontext-in-jetpackjetbrains-compose class=md-nav__link> <span class=md-ellipsis> Root ComponentContext in Jetpack/JetBrains Compose </span> </a> <nav class=md-nav aria-label="Root ComponentContext in Jetpack/JetBrains Compose"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#android-with-compose class=md-nav__link> <span class=md-ellipsis> Android with Compose </span> </a> </li> <li class=md-nav__item> <a href=#jvmdesktop-with-compose class=md-nav__link> <span class=md-ellipsis> JVM/Desktop with Compose </span> </a> </li> <li class=md-nav__item> <a href=#other-platforms-with-compose class=md-nav__link> <span class=md-ellipsis> Other platforms with Compose </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#value-and-mutablevalue-state-holders class=md-nav__link> <span class=md-ellipsis> Value and MutableValue state holders </span> </a> <nav class=md-nav aria-label="Value and MutableValue state holders"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#why-not-stateflow class=md-nav__link> <span class=md-ellipsis> Why not StateFlow? </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#examples class=md-nav__link> <span class=md-ellipsis> Examples </span> </a> <nav class=md-nav aria-label=Examples> <ul class=md-nav__list> <li class=md-nav__item> <a href=#simplest-component-example class=md-nav__link> <span class=md-ellipsis> Simplest Component Example </span> </a> </li> <li class=md-nav__item> <a href=#jetpackjetbrains-compose-ui-example class=md-nav__link> <span class=md-ellipsis> Jetpack/JetBrains Compose UI Example </span> </a> </li> <li class=md-nav__item> <a href=#swiftui-example class=md-nav__link> <span class=md-ellipsis> SwiftUI Example </span> </a> <nav class=md-nav aria-label="SwiftUI Example"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#what-is-statevalue class=md-nav__link> <span class=md-ellipsis> What is StateValue </span> </a> </li> <li class=md-nav__item> <a href=#more-swift-utilities class=md-nav__link> <span class=md-ellipsis> More Swift utilities </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <article class="md-content__inner md-typeset"> <h1 id=component-overview>Component Overview<a class=headerlink href=#component-overview title="Permanent link">&para;</a></h1> <p>A component is just a normal class that encapsulates some logic and possibly another (child) components. Every component has its own lifecycle, which is automatically managed by Decompose. So everything encapsulated by a component is scoped. Please head to the <a href=../lifecycle/ >Lifecycle documentation page</a> for more information.</p> <p>UI is optional and is pluggable from outside of components. Components do not depend on UI, the UI depends on components.</p> <p>Unlike the traditional approach with <code>ViewModels</code> and navigation from UI (when a <code>ViewModel</code> is passed to a Composable function or a SwiftUI View, etc.), Decompose uses the Component concept for navigation. So the UI is only responsible for displaying the information, and everything else is behind the component boundary. This allows more code to be shared between platforms while keeping the UI layer thinner.</p> <p>Additionally, this approach significantly simplifies testing. A component can be tested by a unit or integration test, often without instrumentation, which is fast and reliable. Plus, various tools can be used for UI testing, including but not limited to screenshot testing.</p> <h2 id=component-hierarchy>Component hierarchy<a class=headerlink href=#component-hierarchy title="Permanent link">&para;</a></h2> <p><img src=https://raw.githubusercontent.com/arkivanov/Decompose/master/docs/media/ComponentHierarchy.png width=512></p> <h2 id=pluggable-ui-hierarchy>Pluggable UI hierarchy<a class=headerlink href=#pluggable-ui-hierarchy title="Permanent link">&para;</a></h2> <p><img src=https://raw.githubusercontent.com/arkivanov/Decompose/master/docs/media/PluggableUiHierarchy.png width=512></p> <h2 id=typical-component-structure>Typical component structure<a class=headerlink href=#typical-component-structure title="Permanent link">&para;</a></h2> <p><img src=https://raw.githubusercontent.com/arkivanov/Decompose/master/docs/media/ComponentStructure.png width=512></p> <h2 id=componentcontext>ComponentContext<a class=headerlink href=#componentcontext title="Permanent link">&para;</a></h2> <p>Each component has an associated <a href=https://github.com/arkivanov/Decompose/blob/master/decompose/src/commonMain/kotlin/com/arkivanov/decompose/ComponentContext.kt><code>ComponentContext</code></a> which implements the following interfaces:</p> <ul> <li><code>LifecycleOwner</code>, provided by Essenty library, so each component has its own lifecycle</li> <li><code>StateKeeperOwner</code>, provided by Essenty library, so you can preserve any state during configuration changes and/or process death</li> <li><code>InstanceKeeperOwner</code>, provided by Essenty library, so you can retain arbitrary object instances in your components (like with AndroidX ViewModels)</li> <li><code>BackHandlerOwner</code>, provided by Essenty library, so each component can handle back button events</li> </ul> <p>So if a component requires any of the above features, just pass the <code>ComponentContext</code> via the component's constructor. You can use the delegation pattern to add the <code>ComponentContext</code> to <code>this</code> scope:</p> <div class=highlight><pre><span></span><code><span class=k>import</span><span class=w> </span><span class=nn>com.arkivanov.decompose.ComponentContext</span>

<span class=kd>class</span><span class=w> </span><span class=nc>RootComponent</span><span class=p>(</span>
<span class=w>    </span><span class=n>componentContext</span><span class=p>:</span><span class=w> </span><span class=n>ComponentContext</span>
<span class=p>)</span><span class=w> </span><span class=p>:</span><span class=w> </span><span class=n>ComponentContext</span><span class=w> </span><span class=k>by</span><span class=w> </span><span class=n>componentContext</span><span class=w> </span><span class=p>{</span>

<span class=w>    </span><span class=c1>// Some code here</span>
<span class=p>}</span>
</code></pre></div> <p>It may also be useful to extract an interface, e.g. for creating separate implementations for Compose/SwiftUI previews, or writing test doubles.</p> <div class=highlight><pre><span></span><code><span class=k>import</span><span class=w> </span><span class=nn>com.arkivanov.decompose.ComponentContext</span>

<span class=kd>interface</span><span class=w> </span><span class=nc>RootComponent</span>

<span class=kd>class</span><span class=w> </span><span class=nc>DefaultRootComponent</span><span class=p>(</span>
<span class=w>    </span><span class=n>componentContext</span><span class=p>:</span><span class=w> </span><span class=n>ComponentContext</span>
<span class=p>)</span><span class=w> </span><span class=p>:</span><span class=w> </span><span class=n>RootComponent</span><span class=p>,</span><span class=w> </span><span class=n>ComponentContext</span><span class=w> </span><span class=k>by</span><span class=w> </span><span class=n>componentContext</span><span class=w> </span><span class=p>{</span>

<span class=w>    </span><span class=c1>// Some code here</span>
<span class=p>}</span>
</code></pre></div> <h2 id=root-componentcontext>Root ComponentContext<a class=headerlink href=#root-componentcontext title="Permanent link">&para;</a></h2> <p>When instantiating a root component, the <code>ComponentContext</code> should be created manually. There is <a href=https://github.com/arkivanov/Decompose/blob/master/decompose/src/commonMain/kotlin/com/arkivanov/decompose/DefaultComponentContext.kt>DefaultComponentContext</a> which is the default implementation class of the <code>ComponentContext</code>.</p> <div class="admonition warning"> <p class=admonition-title>Warning</p> <p>The root <code>ComponentContext</code> and the root component should be always created on the UI thread.</p> </div> <h3 id=root-componentcontext-in-android>Root ComponentContext in Android<a class=headerlink href=#root-componentcontext-in-android title="Permanent link">&para;</a></h3> <p>Decompose provides a few handy <a href=https://github.com/arkivanov/Decompose/blob/master/decompose/src/androidMain/kotlin/com/arkivanov/decompose/DefaultComponentContextBuilder.kt>helper functions</a> for creating the root <code>ComponentContext</code> in Android. The preferred way is to create the root <code>ComponentContext</code> in an <code>Activity</code> or a <code>Fragment</code>.</p> <h4 id=root-componentcontext-in-activity>Root ComponentContext in Activity<a class=headerlink href=#root-componentcontext-in-activity title="Permanent link">&para;</a></h4> <p>For this case Decompose provides <code>defaultComponentContext()</code> extension function, which can be called in scope of an <code>Activity</code>.</p> <div class="admonition warning"> <p class=admonition-title>Warning</p> <p>The <code>defaultComponentContext</code> function must only be called once during the lifetime of the host Activity or Fragment, typically in <code>onCreate</code>. Calling it a second time will result in a crash.</p> </div> <div class=highlight><pre><span></span><code><span class=k>import</span><span class=w> </span><span class=nn>android.os.Bundle</span>
<span class=k>import</span><span class=w> </span><span class=nn>androidx.appcompat.app.AppCompatActivity</span>
<span class=k>import</span><span class=w> </span><span class=nn>com.arkivanov.decompose.defaultComponentContext</span>

<span class=kd>class</span><span class=w> </span><span class=nc>MainActivity</span><span class=w> </span><span class=p>:</span><span class=w> </span><span class=n>AppCompatActivity</span><span class=p>()</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=kd>override</span><span class=w> </span><span class=kd>fun</span><span class=w> </span><span class=nf>onCreate</span><span class=p>(</span><span class=n>savedInstanceState</span><span class=p>:</span><span class=w> </span><span class=n>Bundle?)</span><span class=w> </span><span class=p>{</span>
<span class=w>        </span><span class=k>super</span><span class=p>.</span><span class=na>onCreate</span><span class=p>(</span><span class=n>savedInstanceState</span><span class=p>)</span>

<span class=w>        </span><span class=kd>val</span><span class=w> </span><span class=nv>root</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>DefaultRootComponent</span><span class=p>(</span><span class=n>defaultComponentContext</span><span class=p>())</span>
<span class=w>    </span><span class=p>}</span>
<span class=p>}</span>
</code></pre></div> <h4 id=root-componentcontext-in-fragment>Root ComponentContext in Fragment<a class=headerlink href=#root-componentcontext-in-fragment title="Permanent link">&para;</a></h4> <p>Use <code>defaultComponentContext(OnBackPressedDispatcher?)</code> extension function, which can be called in scope of <code>Fragment</code>.</p> <div class=highlight><pre><span></span><code><span class=k>import</span><span class=w> </span><span class=nn>android.os.Bundle</span>
<span class=k>import</span><span class=w> </span><span class=nn>androidx.fragment.app.Fragment</span>
<span class=k>import</span><span class=w> </span><span class=nn>com.arkivanov.decompose.defaultComponentContext</span>

<span class=kd>class</span><span class=w> </span><span class=nc>SomeFragment</span><span class=w> </span><span class=p>:</span><span class=w> </span><span class=n>Fragment</span><span class=p>()</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=kd>private</span><span class=w> </span><span class=kd>lateinit</span><span class=w> </span><span class=kd>var</span><span class=w> </span><span class=nv>root</span><span class=p>:</span><span class=w> </span><span class=n>RootComponent</span>

<span class=w>    </span><span class=kd>override</span><span class=w> </span><span class=kd>fun</span><span class=w> </span><span class=nf>onCreate</span><span class=p>(</span><span class=n>savedInstanceState</span><span class=p>:</span><span class=w> </span><span class=n>Bundle?)</span><span class=w> </span><span class=p>{</span>
<span class=w>        </span><span class=k>super</span><span class=p>.</span><span class=na>onCreate</span><span class=p>(</span><span class=n>savedInstanceState</span><span class=p>)</span>

<span class=w>        </span><span class=n>root</span><span class=w> </span><span class=o>=</span>
<span class=w>            </span><span class=n>DefaultRootComponent</span><span class=p>(</span>
<span class=w>                </span><span class=n>componentContext</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>defaultComponentContext</span><span class=p>(</span>
<span class=w>                    </span><span class=n>onBackPressedDispatcher</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>requireActivity</span><span class=p>().</span><span class=na>onBackPressedDispatcher</span>
<span class=w>                </span><span class=p>)</span>
<span class=w>            </span><span class=p>)</span>
<span class=w>    </span><span class=p>}</span>
<span class=p>}</span>
</code></pre></div> <h3 id=root-componentcontext-in-jetpackjetbrains-compose>Root ComponentContext in Jetpack/JetBrains Compose<a class=headerlink href=#root-componentcontext-in-jetpackjetbrains-compose title="Permanent link">&para;</a></h3> <p>It is advised to not create the root <code>ComponentContext</code> (and a root component) directly in a <code>Composable</code> function. Compositions may be performed in a background thread, which may break things. The preferred way is to create the root component on the UI thread outside of Compose.</p> <div class="admonition warning"> <p class=admonition-title>Warning</p> <p>If you can't avoid creating the root component in a <code>Composable</code> function, please make sure you use <code>remember</code>. This will prevent the root component and its <code>ComponentContext</code> from being recreated on each composition.</p> </div> <h4 id=android-with-compose>Android with Compose<a class=headerlink href=#android-with-compose title="Permanent link">&para;</a></h4> <p>Prefer creating the root <code>ComponentContext</code> (and a root component) before starting Compose, e.g. in an <code>Activity</code> or a <code>Fragment</code>.</p> <div class=highlight><pre><span></span><code><span class=k>import</span><span class=w> </span><span class=nn>android.os.Bundle</span>
<span class=k>import</span><span class=w> </span><span class=nn>androidx.activity.compose.setContent</span>
<span class=k>import</span><span class=w> </span><span class=nn>androidx.appcompat.app.AppCompatActivity</span>
<span class=k>import</span><span class=w> </span><span class=nn>com.arkivanov.decompose.defaultComponentContext</span>

<span class=kd>class</span><span class=w> </span><span class=nc>MainActivity</span><span class=w> </span><span class=p>:</span><span class=w> </span><span class=n>AppCompatActivity</span><span class=p>()</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=kd>override</span><span class=w> </span><span class=kd>fun</span><span class=w> </span><span class=nf>onCreate</span><span class=p>(</span><span class=n>savedInstanceState</span><span class=p>:</span><span class=w> </span><span class=n>Bundle?)</span><span class=w> </span><span class=p>{</span>
<span class=w>        </span><span class=k>super</span><span class=p>.</span><span class=na>onCreate</span><span class=p>(</span><span class=n>savedInstanceState</span><span class=p>)</span>

<span class=w>        </span><span class=c1>// Create the root component before starting Compose</span>
<span class=w>        </span><span class=kd>val</span><span class=w> </span><span class=nv>root</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>DefaultRootComponent</span><span class=p>(</span><span class=n>componentContext</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>defaultComponentContext</span><span class=p>())</span>

<span class=w>        </span><span class=c1>// Start Compose</span>
<span class=w>        </span><span class=n>setContent</span><span class=w> </span><span class=p>{</span>
<span class=w>            </span><span class=c1>// The rest of the code</span>
<span class=w>        </span><span class=p>}</span>
<span class=w>    </span><span class=p>}</span>
<span class=p>}</span>
</code></pre></div> <h4 id=jvmdesktop-with-compose>JVM/Desktop with Compose<a class=headerlink href=#jvmdesktop-with-compose title="Permanent link">&para;</a></h4> <p>Make sure you always create the root component on the UI thread. Please refer to samples for an example of <a href=https://github.com/arkivanov/Decompose/blob/master/sample/app-desktop/src/jvmMain/kotlin/com/arkivanov/sample/app/Utils.kt>runOnUiThread</a> function .</p> <div class=highlight><pre><span></span><code><span class=k>import</span><span class=w> </span><span class=nn>androidx.compose.ui.window.application</span>
<span class=k>import</span><span class=w> </span><span class=nn>com.arkivanov.decompose.DefaultComponentContext</span>

<span class=kd>fun</span><span class=w> </span><span class=nf>main</span><span class=p>()</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=c1>// Create the root component on the UI thread before starting Compose</span>
<span class=w>    </span><span class=kd>val</span><span class=w> </span><span class=nv>root</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>runOnUiThread</span><span class=w> </span><span class=p>{</span><span class=w> </span><span class=n>DefaultRootComponent</span><span class=p>(</span><span class=n>componentContext</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>DefaultComponentContext</span><span class=p>(...))</span><span class=w> </span><span class=p>}</span>

<span class=w>    </span><span class=c1>// Start Compose</span>
<span class=w>    </span><span class=n>application</span><span class=w> </span><span class=p>{</span>
<span class=w>        </span><span class=c1>// The rest of the code</span>
<span class=w>    </span><span class=p>}</span>
<span class=p>}</span>
</code></pre></div> <h4 id=other-platforms-with-compose>Other platforms with Compose<a class=headerlink href=#other-platforms-with-compose title="Permanent link">&para;</a></h4> <p>Prefer creating the root <code>ComponentContext</code> (and a root component) before starting Compose, e.g. in directly in the <code>main</code> function.</p> <div class=highlight><pre><span></span><code><span class=k>import</span><span class=w> </span><span class=nn>androidx.compose.ui.window.application</span>
<span class=k>import</span><span class=w> </span><span class=nn>com.arkivanov.decompose.DefaultComponentContext</span>

<span class=kd>fun</span><span class=w> </span><span class=nf>main</span><span class=p>()</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=c1>// Create the root component before starting Compose.</span>
<span class=w>    </span><span class=c1>// Make sure that this happens on the UI thread.</span>
<span class=w>    </span><span class=kd>val</span><span class=w> </span><span class=nv>root</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>DefaultRootComponent</span><span class=p>(</span><span class=n>componentContext</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>DefaultComponentContext</span><span class=p>(...))</span>

<span class=w>    </span><span class=c1>// Start Compose</span>
<span class=w>    </span><span class=n>application</span><span class=w> </span><span class=p>{</span>
<span class=w>        </span><span class=c1>// The rest of the code</span>
<span class=w>    </span><span class=p>}</span>
<span class=p>}</span>
</code></pre></div> <h2 id=value-and-mutablevalue-state-holders>Value and MutableValue state holders<a class=headerlink href=#value-and-mutablevalue-state-holders title="Permanent link">&para;</a></h2> <p><a href=https://github.com/arkivanov/Decompose/blob/master/decompose/src/commonMain/kotlin/com/arkivanov/decompose/value/Value.kt>Value</a> - is a multiplatform way to expose streams of states. It contains the <code>value</code> property, which always returns the current state. It also provides the ability to observe state changes via <code>subscribe</code>/<code>unsubscribe</code> methods. There is <a href=https://github.com/arkivanov/Decompose/blob/master/decompose/src/commonMain/kotlin/com/arkivanov/decompose/value/MutableValueBuilder.kt>MutableValue</a> which is a mutable variant of <code>Value</code>. Since <code>Value</code> is a class (not an interface) with a generic type parameter, it can be used to expose state streams to ObjC/Swift.</p> <p>Using <code>Value</code> is not mandatory, you can use any other state holders, e.g. <a href=https://kotlinlang.org/api/kotlinx.coroutines/kotlinx-coroutines-core/kotlinx.coroutines.flow/-state-flow/ >StateFlow</a>, <a href=https://developer.android.com/jetpack/compose/state>State</a>, <a href=https://github.com/badoo/Reaktive>Observable</a>, <a href=https://developer.android.com/topic/libraries/architecture/livedata>LiveData</a>, etc.</p> <p>If you are using Jetpack/JetBrains Compose, <code>Value</code> can be observed in Composable functions using one of the Compose <a href=../../extensions/compose/ >extension modules</a>.</p> <div class="admonition warning"> <p class=admonition-title>Warning</p> <p>Even though both <code>Value</code> and <code>MutableValue</code> are thread-safe, it's recommended to subscribe and update it only on the main thread.</p> </div> <h3 id=why-not-stateflow>Why not StateFlow?<a class=headerlink href=#why-not-stateflow title="Permanent link">&para;</a></h3> <p>Decompose uses <code>Value</code> to avoid dependency on Kotlin coroutines. One may prefer using Reaktive, RxJava, etc. instead of coroutines. It also provides better interoperability with ObjC/Swift and simplifies testing. Feel free to convert <code>Value</code> to <code>StateFlow</code> or any other state holder if you need it.</p> <h2 id=examples>Examples<a class=headerlink href=#examples title="Permanent link">&para;</a></h2> <h3 id=simplest-component-example>Simplest Component Example<a class=headerlink href=#simplest-component-example title="Permanent link">&para;</a></h3> <p>Here is an example of simple Counter component:</p> <div class=highlight><pre><span></span><code><span class=k>import</span><span class=w> </span><span class=nn>com.arkivanov.decompose.value.MutableValue</span>
<span class=k>import</span><span class=w> </span><span class=nn>com.arkivanov.decompose.value.Value</span>
<span class=k>import</span><span class=w> </span><span class=nn>com.arkivanov.decompose.value.update</span>

<span class=kd>class</span><span class=w> </span><span class=nc>Counter</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=kd>private</span><span class=w> </span><span class=kd>val</span><span class=w> </span><span class=nv>_state</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>MutableValue</span><span class=p>(</span><span class=n>State</span><span class=p>())</span>
<span class=w>    </span><span class=kd>val</span><span class=w> </span><span class=nv>state</span><span class=p>:</span><span class=w> </span><span class=n>Value</span><span class=o>&lt;</span><span class=n>State</span><span class=o>&gt;</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>_state</span>

<span class=w>    </span><span class=kd>fun</span><span class=w> </span><span class=nf>increment</span><span class=p>()</span><span class=w> </span><span class=p>{</span>
<span class=w>        </span><span class=n>_state</span><span class=p>.</span><span class=na>update</span><span class=w> </span><span class=p>{</span><span class=w> </span><span class=nb>it</span><span class=p>.</span><span class=na>copy</span><span class=p>(</span><span class=n>count</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nb>it</span><span class=p>.</span><span class=na>count</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=m>1</span><span class=p>)</span><span class=w> </span><span class=p>}</span>
<span class=w>    </span><span class=p>}</span>

<span class=w>    </span><span class=kd>data</span><span class=w> </span><span class=kd>class</span><span class=w> </span><span class=nc>State</span><span class=p>(</span><span class=kd>val</span><span class=w> </span><span class=nv>count</span><span class=p>:</span><span class=w> </span><span class=kt>Int</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=m>0</span><span class=p>)</span>
<span class=p>}</span>
</code></pre></div> <h3 id=jetpackjetbrains-compose-ui-example>Jetpack/JetBrains Compose UI Example<a class=headerlink href=#jetpackjetbrains-compose-ui-example title="Permanent link">&para;</a></h3> <div class=highlight><pre><span></span><code><span class=k>import</span><span class=w> </span><span class=nn>androidx.compose.foundation.layout.Column</span>
<span class=k>import</span><span class=w> </span><span class=nn>androidx.compose.material.Button</span>
<span class=k>import</span><span class=w> </span><span class=nn>androidx.compose.material.Text</span>
<span class=k>import</span><span class=w> </span><span class=nn>androidx.compose.runtime.Composable</span>
<span class=k>import</span><span class=w> </span><span class=nn>androidx.compose.runtime.getValue</span>
<span class=k>import</span><span class=w> </span><span class=nn>com.arkivanov.decompose.extensions.compose.subscribeAsState</span>

<span class=nd>@Composable</span>
<span class=kd>fun</span><span class=w> </span><span class=nf>CounterContent</span><span class=p>(</span><span class=n>counter</span><span class=p>:</span><span class=w> </span><span class=n>Counter</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=kd>val</span><span class=w> </span><span class=nv>state</span><span class=w> </span><span class=k>by</span><span class=w> </span><span class=n>counter</span><span class=p>.</span><span class=na>state</span><span class=p>.</span><span class=na>subscribeAsState</span><span class=p>()</span>

<span class=w>    </span><span class=n>Column</span><span class=w> </span><span class=p>{</span>
<span class=w>        </span><span class=n>Text</span><span class=p>(</span><span class=n>text</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>state</span><span class=p>.</span><span class=na>count</span><span class=p>.</span><span class=na>toString</span><span class=p>())</span>

<span class=w>        </span><span class=n>Button</span><span class=p>(</span><span class=n>onClick</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>counter</span><span class=o>::</span><span class=n>increment</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>            </span><span class=n>Text</span><span class=p>(</span><span class=s>&quot;Increment&quot;</span><span class=p>)</span>
<span class=w>        </span><span class=p>}</span>
<span class=w>    </span><span class=p>}</span>
<span class=p>}</span>
</code></pre></div> <h3 id=swiftui-example>SwiftUI Example<a class=headerlink href=#swiftui-example title="Permanent link">&para;</a></h3> <div class=highlight><pre><span></span><code><span class=kd>struct</span><span class=w> </span><span class=nc>CounterView</span><span class=p>:</span><span class=w> </span><span class=n>View</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=kd>private</span><span class=w> </span><span class=kd>let</span><span class=w> </span><span class=nv>counter</span><span class=p>:</span><span class=w> </span><span class=n>Counter</span>

<span class=w>    </span><span class=p>@</span><span class=n>StateValue</span>
<span class=w>    </span><span class=kd>private</span><span class=w> </span><span class=kd>var</span><span class=w> </span><span class=nv>state</span><span class=p>:</span><span class=w> </span><span class=n>CounterState</span>

<span class=w>    </span><span class=kd>init</span><span class=p>(</span><span class=kc>_</span><span class=w> </span><span class=n>counter</span><span class=p>:</span><span class=w> </span><span class=n>Counter</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>        </span><span class=kc>self</span><span class=p>.</span><span class=n>counter</span><span class=w> </span><span class=p>=</span><span class=w> </span><span class=n>counter</span>
<span class=w>        </span><span class=n>_state</span><span class=w> </span><span class=p>=</span><span class=w> </span><span class=n>StateValue</span><span class=p>(</span><span class=n>counter</span><span class=p>.</span><span class=n>state</span><span class=p>)</span>
<span class=w>    </span><span class=p>}</span>

<span class=w>    </span><span class=kd>var</span><span class=w> </span><span class=nv>body</span><span class=p>:</span><span class=w> </span><span class=n>some</span><span class=w> </span><span class=n>View</span><span class=w> </span><span class=p>{</span>
<span class=w>        </span><span class=n>VStack</span><span class=p>(</span><span class=n>spacing</span><span class=p>:</span><span class=w> </span><span class=mi>8</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>            </span><span class=n>Text</span><span class=p>(</span><span class=n>state</span><span class=p>.</span><span class=n>value</span><span class=p>.</span><span class=n>text</span><span class=p>)</span>
<span class=w>            </span><span class=n>Button</span><span class=p>(</span><span class=n>action</span><span class=p>:</span><span class=w> </span><span class=n>counter</span><span class=p>.</span><span class=n>increment</span><span class=p>,</span><span class=w> </span><span class=n>label</span><span class=p>:</span><span class=w> </span><span class=p>{</span><span class=w> </span><span class=n>Text</span><span class=p>(</span><span class=s>&quot;Increment&quot;</span><span class=p>)</span><span class=w> </span><span class=p>})</span>
<span class=w>        </span><span class=p>}</span>
<span class=w>    </span><span class=p>}</span>
<span class=p>}</span>
</code></pre></div> <h4 id=what-is-statevalue>What is StateValue<a class=headerlink href=#what-is-statevalue title="Permanent link">&para;</a></h4> <p><a href=https://github.com/arkivanov/Decompose/blob/master/sample/app-ios/app-ios/DecomposeHelpers/StateValue.swift>StateValue</a> is a property wrapper for <code>Value</code> that makes it observable in SwiftUI. Unfortunately it <a href=https://github.com/arkivanov/Decompose/issues/206>does not look possible</a> to publish utils for SwiftUI as a library or framework, so it has to be copied in your project.</p> <h4 id=more-swift-utilities>More Swift utilities<a class=headerlink href=#more-swift-utilities title="Permanent link">&para;</a></h4> <p>You can find more useful utilities for SwiftUI in the <a href=https://github.com/arkivanov/Decompose/blob/master/sample/app-ios/app-ios/DecomposeHelpers>DecomposeHelpers/</a> folder:</p> <ul> <li><a href=https://github.com/arkivanov/Decompose/blob/master/sample/app-ios/app-ios/DecomposeHelpers/StackView.swift>StackView</a> - an adapter for SwiftUI's <code>NavigationStack</code> with fallback to <code>UINavigationView</code> that works with Decompose's <code>ChildStack</code>. See <a href=https://github.com/arkivanov/Decompose/blob/master/sample/app-ios/app-ios/CountersView.swift>CountersView.swift</a>.</li> <li><a href=https://github.com/arkivanov/Decompose/blob/master/sample/app-ios/app-ios/DecomposeHelpers/MutableValue.swift>MutableValue</a> - helps to stub Decompose's <code>Value</code>/<code>MutableValue</code> for Preview Components. See <code>PreviewMultiPaneComponent</code> in <a href=https://github.com/arkivanov/Decompose/blob/master/sample/app-ios/app-ios/MultiPaneView.swift>MultiPaneView.swift</a>.</li> <li><a href=https://github.com/arkivanov/Decompose/blob/master/sample/app-ios/app-ios/DecomposeHelpers/SimpleChildStack.swift>SimpleChildStack</a> - helps to stub Decompose's <code>ChildStack</code> for Preview Components. See <code>PreviewCountersComponent</code> in <a href=https://github.com/arkivanov/Decompose/blob/master/sample/app-ios/app-ios/CountersView.swift>CountersView.swift</a>.</li> </ul> </article> </div> <script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script> </div> </main> <footer class=md-footer> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-copyright> <div class=md-copyright__highlight> Copyright &copy; 2020 - 2024 Arkadii Ivanov </div> Made with <a href=https://squidfunk.github.io/mkdocs-material/ target=_blank rel=noopener> Material for MkDocs </a> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <script id=__config type=application/json>{"base": "../..", "features": ["navigation.tabs", "navigation.expand"], "search": "../../assets/javascripts/workers/search.973d3a69.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script> <script src=../../assets/javascripts/bundle.f55a23d4.min.js></script> </body> </html>