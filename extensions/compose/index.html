<!doctype html><html lang=en class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Kotlin Multiplatform lifecycle-aware business logic components (aka BLoCs) with routing functionality and pluggable UI (Compose, SwiftUI, JS React, etc.)"><meta name=author content="Arkadii Ivanov"><link href=https://arkivanov.github.io/Decompose/extensions/compose/ rel=canonical><link href=../overview/ rel=prev><link href=../android/ rel=next><link rel=icon href=../../media/logo/circle-2.png><meta name=generator content="mkdocs-1.6.1, mkdocs-material-9.7.1"><title>Extensions for Jetpack/JetBrains Compose - Decompose</title><link rel=stylesheet href=../../assets/stylesheets/main.484c7ddc.min.css><link rel=stylesheet href=../../assets/stylesheets/palette.ab4e12ef.min.css><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback"><style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style><script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script></head> <body dir=ltr data-md-color-scheme=default data-md-color-primary=indigo data-md-color-accent=indigo> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#extensions-for-jetpackjetbrains-compose class=md-skip> Skip to content </a> </div> <div data-md-component=announce> </div> <header class=md-header data-md-component=header> <nav class="md-header__inner md-grid" aria-label=Header> <a href=../.. title=Decompose class="md-header__button md-logo" aria-label=Decompose data-md-component=logo> <img src=../../media/logo/circle-2.png alt=logo> </a> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> Decompose </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> Extensions for Jetpack/JetBrains Compose </span> </div> </div> </div> <form class=md-header__option data-md-component=palette> <input class=md-option data-md-color-media data-md-color-scheme=default data-md-color-primary=indigo data-md-color-accent=indigo aria-label="Switch to dark mode" type=radio name=__palette id=__palette_0> <label class="md-header__button md-icon" title="Switch to dark mode" for=__palette_1 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg> </label> <input class=md-option data-md-color-media data-md-color-scheme=slate data-md-color-primary=indigo data-md-color-accent=indigo aria-label="Switch to light mode" type=radio name=__palette id=__palette_1> <label class="md-header__button md-icon" title="Switch to light mode" for=__palette_0 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg> </label> </form> <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script> <label class="md-header__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Search placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg> </label> <nav class=md-search__options aria-label=Search> <button type=reset class="md-search__icon md-icon" title=Clear aria-label=Clear tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg> </button> </nav> </form> <div class=md-search__output> <div class=md-search__scrollwrap tabindex=0 data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Initializing search </div> <ol class=md-search-result__list role=presentation></ol> </div> </div> </div> </div> </div> <div class=md-header__source> <a href=https://github.com/arkivanov/Decompose title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg> </div> <div class=md-source__repository> arkivanov/Decompose </div> </a> </div> </nav> </header> <div class=md-container data-md-component=container> <nav class=md-tabs aria-label=Tabs data-md-component=tabs> <div class=md-grid> <ul class=md-tabs__list> <li class=md-tabs__item> <a href=../.. class=md-tabs__link> Getting started </a> </li> <li class=md-tabs__item> <a href=../../component/overview/ class=md-tabs__link> Component </a> </li> <li class=md-tabs__item> <a href=../../navigation/overview/ class=md-tabs__link> Navigation </a> </li> <li class="md-tabs__item md-tabs__item--active"> <a href=../overview/ class=md-tabs__link> Extensions </a> </li> <li class=md-tabs__item> <a href=../../samples/ class=md-tabs__link> Samples </a> </li> <li class=md-tabs__item> <a href=../../tips-tricks/overview/ class=md-tabs__link> Tips and Tricks </a> </li> <li class=md-tabs__item> <a href=../../faq/ class=md-tabs__link> FAQ </a> </li> <li class=md-tabs__item> <a href=https://deepwiki.com/arkivanov/Decompose class=md-tabs__link> DeepWiki </a> </li> <li class=md-tabs__item> <a href=../../community/ class=md-tabs__link> Community </a> </li> </ul> </div> </nav> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary md-nav--lifted" aria-label=Navigation data-md-level=0> <label class=md-nav__title for=__drawer> <a href=../.. title=Decompose class="md-nav__button md-logo" aria-label=Decompose data-md-component=logo> <img src=../../media/logo/circle-2.png alt=logo> </a> Decompose </label> <div class=md-nav__source> <a href=https://github.com/arkivanov/Decompose title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg> </div> <div class=md-source__repository> arkivanov/Decompose </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_1> <label class=md-nav__link for=__nav_1 id=__nav_1_label tabindex=0> <span class=md-ellipsis> Getting started </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_1_label aria-expanded=false> <label class=md-nav__title for=__nav_1> <span class="md-nav__icon md-icon"></span> Getting started </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../.. class=md-nav__link> <span class=md-ellipsis> Overview </span> </a> </li> <li class=md-nav__item> <a href=../../getting-started/installation/ class=md-nav__link> <span class=md-ellipsis> Installation </span> </a> </li> <li class=md-nav__item> <a href=../../getting-started/quick-start/ class=md-nav__link> <span class=md-ellipsis> Quick start </span> </a> </li> <li class=md-nav__item> <a href=../../getting-started/license/ class=md-nav__link> <span class=md-ellipsis> License </span> </a> </li> <li class=md-nav__item> <a href=../../getting-started/contributing/ class=md-nav__link> <span class=md-ellipsis> Contributing </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_2> <label class=md-nav__link for=__nav_2 id=__nav_2_label tabindex=0> <span class=md-ellipsis> Component </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_2_label aria-expanded=false> <label class=md-nav__title for=__nav_2> <span class="md-nav__icon md-icon"></span> Component </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../component/overview/ class=md-nav__link> <span class=md-ellipsis> Overview </span> </a> </li> <li class=md-nav__item> <a href=../../component/child-components/ class=md-nav__link> <span class=md-ellipsis> Child components </span> </a> </li> <li class=md-nav__item> <a href=../../component/lifecycle/ class=md-nav__link> <span class=md-ellipsis> Lifecycle </span> </a> </li> <li class=md-nav__item> <a href=../../component/state-preservation/ class=md-nav__link> <span class=md-ellipsis> State preservation (aka SavedStateHandle) </span> </a> </li> <li class=md-nav__item> <a href=../../component/instance-retaining/ class=md-nav__link> <span class=md-ellipsis> Instance retaining (aka ViewModel) </span> </a> </li> <li class=md-nav__item> <a href=../../component/back-button/ class=md-nav__link> <span class=md-ellipsis> Back button </span> </a> </li> <li class=md-nav__item> <a href=../../component/scopes/ class=md-nav__link> <span class=md-ellipsis> Scoping jobs and subscriptions </span> </a> </li> <li class=md-nav__item> <a href=../../component/custom-component-context/ class=md-nav__link> <span class=md-ellipsis> Custom ComponentContext </span> </a> </li> <li class=md-nav__item> <a href=../../component/jetpack-component-context/ class=md-nav__link> <span class=md-ellipsis> JetpackComponentContext </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_3> <label class=md-nav__link for=__nav_3 id=__nav_3_label tabindex=0> <span class=md-ellipsis> Navigation </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_3_label aria-expanded=false> <label class=md-nav__title for=__nav_3> <span class="md-nav__icon md-icon"></span> Navigation </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../navigation/overview/ class=md-nav__link> <span class=md-ellipsis> Overview </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_3_2> <label class=md-nav__link for=__nav_3_2 id=__nav_3_2_label tabindex=0> <span class=md-ellipsis> Child Stack </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_3_2_label aria-expanded=false> <label class=md-nav__title for=__nav_3_2> <span class="md-nav__icon md-icon"></span> Child Stack </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../navigation/stack/overview/ class=md-nav__link> <span class=md-ellipsis> Overview </span> </a> </li> <li class=md-nav__item> <a href=../../navigation/stack/navigation/ class=md-nav__link> <span class=md-ellipsis> Navigation </span> </a> </li> <li class=md-nav__item> <a href=../../navigation/stack/deeplinking/ class=md-nav__link> <span class=md-ellipsis> Deep linking </span> </a> </li> <li class=md-nav__item> <a href=../../navigation/stack/browser-history/ class=md-nav__link> <span class=md-ellipsis> Web browser history </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_3_3> <label class=md-nav__link for=__nav_3_3 id=__nav_3_3_label tabindex=0> <span class=md-ellipsis> Child Slot </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_3_3_label aria-expanded=false> <label class=md-nav__title for=__nav_3_3> <span class="md-nav__icon md-icon"></span> Child Slot </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../navigation/slot/overview/ class=md-nav__link> <span class=md-ellipsis> Overview </span> </a> </li> <li class=md-nav__item> <a href=../../navigation/slot/navigation/ class=md-nav__link> <span class=md-ellipsis> Navigation </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_3_4> <label class=md-nav__link for=__nav_3_4 id=__nav_3_4_label tabindex=0> <span class=md-ellipsis> Child Pages </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_3_4_label aria-expanded=false> <label class=md-nav__title for=__nav_3_4> <span class="md-nav__icon md-icon"></span> Child Pages </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../navigation/pages/overview/ class=md-nav__link> <span class=md-ellipsis> Overview </span> </a> </li> <li class=md-nav__item> <a href=../../navigation/pages/navigation/ class=md-nav__link> <span class=md-ellipsis> Navigation </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_3_5> <label class=md-nav__link for=__nav_3_5 id=__nav_3_5_label tabindex=0> <span class=md-ellipsis> Child Panels </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_3_5_label aria-expanded=false> <label class=md-nav__title for=__nav_3_5> <span class="md-nav__icon md-icon"></span> Child Panels </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../navigation/panels/overview/ class=md-nav__link> <span class=md-ellipsis> Overview </span> </a> </li> <li class=md-nav__item> <a href=../../navigation/panels/navigation/ class=md-nav__link> <span class=md-ellipsis> Navigation </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_3_6> <label class=md-nav__link for=__nav_3_6 id=__nav_3_6_label tabindex=0> <span class=md-ellipsis> Child Items </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_3_6_label aria-expanded=false> <label class=md-nav__title for=__nav_3_6> <span class="md-nav__icon md-icon"></span> Child Items </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../navigation/items/overview/ class=md-nav__link> <span class=md-ellipsis> Overview </span> </a> </li> <li class=md-nav__item> <a href=../../navigation/items/navigation/ class=md-nav__link> <span class=md-ellipsis> Navigation </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_3_7> <label class=md-nav__link for=__nav_3_7 id=__nav_3_7_label tabindex=0> <span class=md-ellipsis> Generic Navigation </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_3_7_label aria-expanded=false> <label class=md-nav__title for=__nav_3_7> <span class="md-nav__icon md-icon"></span> Generic Navigation </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../navigation/children/overview/ class=md-nav__link> <span class=md-ellipsis> Overview </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../../navigation/web-navigation/ class=md-nav__link> <span class=md-ellipsis> Web Navigation </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_4 checked> <label class=md-nav__link for=__nav_4 id=__nav_4_label tabindex> <span class=md-ellipsis> Extensions </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_4_label aria-expanded=true> <label class=md-nav__title for=__nav_4> <span class="md-nav__icon md-icon"></span> Extensions </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../overview/ class=md-nav__link> <span class=md-ellipsis> Overview </span> </a> </li> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" type=checkbox id=__toc> <label class="md-nav__link md-nav__link--active" for=__toc> <span class=md-ellipsis> Extensions for Jetpack/JetBrains Compose </span> <span class="md-nav__icon md-icon"></span> </label> <a href=./ class="md-nav__link md-nav__link--active"> <span class=md-ellipsis> Extensions for Jetpack/JetBrains Compose </span> </a> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#setup class=md-nav__link> <span class=md-ellipsis> Setup </span> </a> <nav class=md-nav aria-label=Setup> <ul class=md-nav__list> <li class=md-nav__item> <a href=#proguard-rules-for-compose-for-desktop-jvm class=md-nav__link> <span class=md-ellipsis> ProGuard rules for Compose for Desktop (JVM) </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#converting-value-to-state class=md-nav__link> <span class=md-ellipsis> Converting Value to State </span> </a> </li> <li class=md-nav__item> <a href=#controlling-the-lifecycle-on-desktop class=md-nav__link> <span class=md-ellipsis> Controlling the Lifecycle on Desktop </span> </a> </li> <li class=md-nav__item> <a href=#observing-the-navigation-state-manually class=md-nav__link> <span class=md-ellipsis> Observing the navigation state manually </span> </a> </li> <li class=md-nav__item> <a href=#navigating-between-composable-components class=md-nav__link> <span class=md-ellipsis> Navigating between Composable components </span> </a> </li> <li class=md-nav__item> <a href=#child-slot-navigation-with-compose class=md-nav__link> <span class=md-ellipsis> Child Slot navigation with Compose </span> </a> </li> <li class=md-nav__item> <a href=#child-pages-navigation-with-compose class=md-nav__link> <span class=md-ellipsis> Child Pages navigation with Compose </span> </a> </li> <li class=md-nav__item> <a href=#child-panels-navigation-with-compose class=md-nav__link> <span class=md-ellipsis> Child Panels navigation with Compose </span> </a> </li> <li class=md-nav__item> <a href=#child-items-navigation-with-compose class=md-nav__link> <span class=md-ellipsis> Child Items navigation with Compose </span> </a> </li> <li class=md-nav__item> <a href=#animations class=md-nav__link> <span class=md-ellipsis> Animations </span> </a> <nav class=md-nav aria-label=Animations> <ul class=md-nav__list> <li class=md-nav__item> <a href=#the-new-experimental-animation-api class=md-nav__link> <span class=md-ellipsis> The new experimental animation API </span> </a> <nav class=md-nav aria-label="The new experimental animation API"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#adding-the-dependency-with-the-new-animation-api class=md-nav__link> <span class=md-ellipsis> Adding the dependency with the new animation API </span> </a> </li> <li class=md-nav__item> <a href=#the-childstack-composable-function class=md-nav__link> <span class=md-ellipsis> The ChildStack composable function </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#fade-animation class=md-nav__link> <span class=md-ellipsis> Fade animation </span> </a> </li> <li class=md-nav__item> <a href=#slide-animation class=md-nav__link> <span class=md-ellipsis> Slide animation </span> </a> </li> <li class=md-nav__item> <a href=#combining-animators class=md-nav__link> <span class=md-ellipsis> Combining animators </span> </a> </li> <li class=md-nav__item> <a href=#separate-animations-for-children class=md-nav__link> <span class=md-ellipsis> Separate animations for children </span> </a> </li> <li class=md-nav__item> <a href=#default-stack-animations class=md-nav__link> <span class=md-ellipsis> Default stack animations </span> </a> </li> <li class=md-nav__item> <a href=#custom-animations class=md-nav__link> <span class=md-ellipsis> Custom animations </span> </a> <nav class=md-nav aria-label="Custom animations"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#implementing-stackanimation class=md-nav__link> <span class=md-ellipsis> Implementing StackAnimation </span> </a> </li> <li class=md-nav__item> <a href=#implementing-stackanimator class=md-nav__link> <span class=md-ellipsis> Implementing StackAnimator </span> </a> </li> <li class=md-nav__item> <a href=#using-stackanimator-function class=md-nav__link> <span class=md-ellipsis> Using stackAnimator function </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#shared-element-transitions class=md-nav__link> <span class=md-ellipsis> Shared Element Transitions </span> </a> </li> <li class=md-nav__item> <a href=#predictive-back-gesture class=md-nav__link> <span class=md-ellipsis> Predictive Back Gesture </span> </a> <nav class=md-nav aria-label="Predictive Back Gesture"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#predefined-animations class=md-nav__link> <span class=md-ellipsis> Predefined animations </span> </a> <nav class=md-nav aria-label="Predefined animations"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#standard-android-like-system-animation class=md-nav__link> <span class=md-ellipsis> Standard Android-like system animation </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#predictive-back-gesture-on-android class=md-nav__link> <span class=md-ellipsis> Predictive Back Gesture on Android </span> </a> </li> <li class=md-nav__item> <a href=#predictive-back-gesture-on-other-platforms class=md-nav__link> <span class=md-ellipsis> Predictive Back Gesture on other platforms </span> </a> </li> <li class=md-nav__item> <a href=#predictive-back-gesture-on-ios class=md-nav__link> <span class=md-ellipsis> Predictive Back Gesture on iOS </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../android/ class=md-nav__link> <span class=md-ellipsis> Extensions for Android views </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../../samples/ class=md-nav__link> <span class=md-ellipsis> Samples </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_6> <label class=md-nav__link for=__nav_6 id=__nav_6_label tabindex=0> <span class=md-ellipsis> Tips and Tricks </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_6_label aria-expanded=false> <label class=md-nav__title for=__nav_6> <span class="md-nav__icon md-icon"></span> Tips and Tricks </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../tips-tricks/overview/ class=md-nav__link> <span class=md-ellipsis> Overview </span> </a> </li> <li class=md-nav__item> <a href=../../tips-tricks/composable-viewmodel/ class=md-nav__link> <span class=md-ellipsis> Calling Composable functions with ViewModels </span> </a> </li> <li class=md-nav__item> <a href=../../tips-tricks/navigation-compose-component/ class=md-nav__link> <span class=md-ellipsis> Hosting a component in navigation-compose </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../../faq/ class=md-nav__link> <span class=md-ellipsis> FAQ </span> </a> </li> <li class=md-nav__item> <a href=https://deepwiki.com/arkivanov/Decompose class=md-nav__link> <span class=md-ellipsis> DeepWiki </span> </a> </li> <li class=md-nav__item> <a href=../../community/ class=md-nav__link> <span class=md-ellipsis> Community </span> </a> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=sidebar data-md-type=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#setup class=md-nav__link> <span class=md-ellipsis> Setup </span> </a> <nav class=md-nav aria-label=Setup> <ul class=md-nav__list> <li class=md-nav__item> <a href=#proguard-rules-for-compose-for-desktop-jvm class=md-nav__link> <span class=md-ellipsis> ProGuard rules for Compose for Desktop (JVM) </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#converting-value-to-state class=md-nav__link> <span class=md-ellipsis> Converting Value to State </span> </a> </li> <li class=md-nav__item> <a href=#controlling-the-lifecycle-on-desktop class=md-nav__link> <span class=md-ellipsis> Controlling the Lifecycle on Desktop </span> </a> </li> <li class=md-nav__item> <a href=#observing-the-navigation-state-manually class=md-nav__link> <span class=md-ellipsis> Observing the navigation state manually </span> </a> </li> <li class=md-nav__item> <a href=#navigating-between-composable-components class=md-nav__link> <span class=md-ellipsis> Navigating between Composable components </span> </a> </li> <li class=md-nav__item> <a href=#child-slot-navigation-with-compose class=md-nav__link> <span class=md-ellipsis> Child Slot navigation with Compose </span> </a> </li> <li class=md-nav__item> <a href=#child-pages-navigation-with-compose class=md-nav__link> <span class=md-ellipsis> Child Pages navigation with Compose </span> </a> </li> <li class=md-nav__item> <a href=#child-panels-navigation-with-compose class=md-nav__link> <span class=md-ellipsis> Child Panels navigation with Compose </span> </a> </li> <li class=md-nav__item> <a href=#child-items-navigation-with-compose class=md-nav__link> <span class=md-ellipsis> Child Items navigation with Compose </span> </a> </li> <li class=md-nav__item> <a href=#animations class=md-nav__link> <span class=md-ellipsis> Animations </span> </a> <nav class=md-nav aria-label=Animations> <ul class=md-nav__list> <li class=md-nav__item> <a href=#the-new-experimental-animation-api class=md-nav__link> <span class=md-ellipsis> The new experimental animation API </span> </a> <nav class=md-nav aria-label="The new experimental animation API"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#adding-the-dependency-with-the-new-animation-api class=md-nav__link> <span class=md-ellipsis> Adding the dependency with the new animation API </span> </a> </li> <li class=md-nav__item> <a href=#the-childstack-composable-function class=md-nav__link> <span class=md-ellipsis> The ChildStack composable function </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#fade-animation class=md-nav__link> <span class=md-ellipsis> Fade animation </span> </a> </li> <li class=md-nav__item> <a href=#slide-animation class=md-nav__link> <span class=md-ellipsis> Slide animation </span> </a> </li> <li class=md-nav__item> <a href=#combining-animators class=md-nav__link> <span class=md-ellipsis> Combining animators </span> </a> </li> <li class=md-nav__item> <a href=#separate-animations-for-children class=md-nav__link> <span class=md-ellipsis> Separate animations for children </span> </a> </li> <li class=md-nav__item> <a href=#default-stack-animations class=md-nav__link> <span class=md-ellipsis> Default stack animations </span> </a> </li> <li class=md-nav__item> <a href=#custom-animations class=md-nav__link> <span class=md-ellipsis> Custom animations </span> </a> <nav class=md-nav aria-label="Custom animations"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#implementing-stackanimation class=md-nav__link> <span class=md-ellipsis> Implementing StackAnimation </span> </a> </li> <li class=md-nav__item> <a href=#implementing-stackanimator class=md-nav__link> <span class=md-ellipsis> Implementing StackAnimator </span> </a> </li> <li class=md-nav__item> <a href=#using-stackanimator-function class=md-nav__link> <span class=md-ellipsis> Using stackAnimator function </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#shared-element-transitions class=md-nav__link> <span class=md-ellipsis> Shared Element Transitions </span> </a> </li> <li class=md-nav__item> <a href=#predictive-back-gesture class=md-nav__link> <span class=md-ellipsis> Predictive Back Gesture </span> </a> <nav class=md-nav aria-label="Predictive Back Gesture"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#predefined-animations class=md-nav__link> <span class=md-ellipsis> Predefined animations </span> </a> <nav class=md-nav aria-label="Predefined animations"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#standard-android-like-system-animation class=md-nav__link> <span class=md-ellipsis> Standard Android-like system animation </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#predictive-back-gesture-on-android class=md-nav__link> <span class=md-ellipsis> Predictive Back Gesture on Android </span> </a> </li> <li class=md-nav__item> <a href=#predictive-back-gesture-on-other-platforms class=md-nav__link> <span class=md-ellipsis> Predictive Back Gesture on other platforms </span> </a> </li> <li class=md-nav__item> <a href=#predictive-back-gesture-on-ios class=md-nav__link> <span class=md-ellipsis> Predictive Back Gesture on iOS </span> </a> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <article class="md-content__inner md-typeset"> <h1 id=extensions-for-jetpackjetbrains-compose>Extensions for Jetpack/JetBrains Compose<a class=headerlink href=#extensions-for-jetpackjetbrains-compose title="Permanent link">&para;</a></h1> <p>Extensions and utilities for easier integration of Decompose with Jetpack and Multiplatform Compose.</p> <h2 id=setup>Setup<a class=headerlink href=#setup title="Permanent link">&para;</a></h2> <p>Please see the corresponding <a href=../../getting-started/installation/#extensions-for-jetpack-and-multiplatform-compose>Installation docs section</a>.</p> <h3 id=proguard-rules-for-compose-for-desktop-jvm>ProGuard rules for Compose for Desktop (JVM)<a class=headerlink href=#proguard-rules-for-compose-for-desktop-jvm title="Permanent link">&para;</a></h3> <p>If you support Compose for Desktop, you will need to add the following rule for ProGuard, so that the app works correctly in release mode. See <a href=https://github.com/JetBrains/compose-multiplatform/tree/master/tutorials/Native_distributions_and_local_execution#minification--obfuscation>Minification &amp; obfuscation</a> section in Compose docs for more information.</p> <div class=highlight><pre><span></span><code>-keep class com.arkivanov.decompose.extensions.compose.mainthread.SwingMainThreadChecker
</code></pre></div> <h2 id=converting-value-to-state>Converting Value to State<a class=headerlink href=#converting-value-to-state title="Permanent link">&para;</a></h2> <p>To convert Decompose <a href=https://github.com/arkivanov/Decompose/tree/master/decompose/src/commonMain/kotlin/com/arkivanov/decompose/value>Value</a> to Compose <code>State</code> use <code>Value&lt;T&gt;.subscribeAsState(): State&lt;T&gt;</code> extension function:</p> <div class=highlight><pre><span></span><code><span class=k>import</span><span class=w> </span><span class=nn>androidx.compose.runtime.Composable</span>
<span class=k>import</span><span class=w> </span><span class=nn>androidx.compose.runtime.State</span>
<span class=k>import</span><span class=w> </span><span class=nn>androidx.compose.runtime.getValue</span>
<span class=k>import</span><span class=w> </span><span class=nn>com.arkivanov.decompose.extensions.compose.subscribeAsState</span>
<span class=k>import</span><span class=w> </span><span class=nn>com.arkivanov.decompose.value.Value</span>

<span class=kd>interface</span><span class=w> </span><span class=nc>SomeComponent</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=kd>val</span><span class=w> </span><span class=nv>model</span><span class=p>:</span><span class=w> </span><span class=n>Value</span><span class=o>&lt;</span><span class=n>Model</span><span class=o>&gt;</span>

<span class=w>    </span><span class=kd>data</span><span class=w> </span><span class=kd>class</span><span class=w> </span><span class=nc>Model</span><span class=p>(</span><span class=cm>/*...*/</span><span class=p>)</span>
<span class=p>}</span>

<span class=nd>@Composable</span>
<span class=kd>fun</span><span class=w> </span><span class=nf>SomeContent</span><span class=p>(</span><span class=n>component</span><span class=p>:</span><span class=w> </span><span class=n>SomeComponent</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=kd>val</span><span class=w> </span><span class=nv>model</span><span class=p>:</span><span class=w> </span><span class=n>State</span><span class=o>&lt;</span><span class=n>SomeComponent</span><span class=p>.</span><span class=na>Model</span><span class=o>&gt;</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>component</span><span class=p>.</span><span class=na>model</span><span class=p>.</span><span class=na>subscribeAsState</span><span class=p>()</span>

<span class=w>    </span><span class=c1>// Or use the delegation pattern</span>
<span class=w>    </span><span class=kd>val</span><span class=w> </span><span class=nv>model</span><span class=w> </span><span class=k>by</span><span class=w> </span><span class=n>component</span><span class=p>.</span><span class=na>model</span><span class=p>.</span><span class=na>subscribeAsState</span><span class=p>()</span>
<span class=p>}</span>
</code></pre></div> <h2 id=controlling-the-lifecycle-on-desktop>Controlling the Lifecycle on Desktop<a class=headerlink href=#controlling-the-lifecycle-on-desktop title="Permanent link">&para;</a></h2> <p>When using JetBrains Compose, you can have the <code>LifecycleRegistry</code> react to changes in the window state using the <code>LifecycleController()</code> composable. This will trigger appropriate lifecycle events when the window is minimized, restored or closed.</p> <p>It is also possible to manually start the lifecycle using <code>LifecycleRegistry.resume()</code> when the instance is created.</p> <div class=highlight><pre><span></span><code><span class=k>import</span><span class=w> </span><span class=nn>androidx.compose.ui.window.Window</span>
<span class=k>import</span><span class=w> </span><span class=nn>androidx.compose.ui.window.application</span>
<span class=k>import</span><span class=w> </span><span class=nn>androidx.compose.ui.window.rememberWindowState</span>
<span class=k>import</span><span class=w> </span><span class=nn>com.arkivanov.decompose.DefaultComponentContext</span>
<span class=k>import</span><span class=w> </span><span class=nn>com.arkivanov.decompose.extensions.compose.jetbrains.lifecycle.LifecycleController</span>
<span class=k>import</span><span class=w> </span><span class=nn>com.arkivanov.essenty.lifecycle.LifecycleRegistry</span>

<span class=kd>fun</span><span class=w> </span><span class=nf>main</span><span class=p>()</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=kd>val</span><span class=w> </span><span class=nv>lifecycle</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>LifecycleRegistry</span><span class=p>()</span>

<span class=w>    </span><span class=kd>val</span><span class=w> </span><span class=nv>root</span><span class=w> </span><span class=o>=</span>
<span class=w>        </span><span class=n>runOnUiThread</span><span class=w> </span><span class=p>{</span>
<span class=w>            </span><span class=n>DefaultRootComponent</span><span class=p>(</span><span class=n>DefaultComponentContext</span><span class=p>(</span><span class=n>lifecycle</span><span class=p>))</span>
<span class=w>        </span><span class=p>}</span>

<span class=w>    </span><span class=n>application</span><span class=w> </span><span class=p>{</span>
<span class=w>        </span><span class=kd>val</span><span class=w> </span><span class=nv>windowState</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>rememberWindowState</span><span class=p>()</span>
<span class=w>        </span><span class=n>LifecycleController</span><span class=p>(</span><span class=n>lifecycle</span><span class=p>,</span><span class=w> </span><span class=n>windowState</span><span class=p>)</span>

<span class=w>        </span><span class=n>Window</span><span class=p>(</span><span class=n>onCloseRequest</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=o>::</span><span class=n>exitApplication</span><span class=p>,</span><span class=w> </span><span class=n>state</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>windowState</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>            </span><span class=n>RootContent</span><span class=p>(</span><span class=n>root</span><span class=p>)</span>
<span class=w>        </span><span class=p>}</span>
<span class=w>    </span><span class=p>}</span>
<span class=p>}</span>
</code></pre></div> <div class="admonition warning"> <p class=admonition-title>Warning</p> <p>When using Compose in desktop platforms, make sure to always use one of the methods above, or your components might not receive lifecycle events correctly.</p> </div> <div class="admonition note"> <p class=admonition-title>Note</p> <p>You can find the <code>runOnUiThread</code> method <a href=https://github.com/arkivanov/Decompose/blob/master/sample/app-desktop/src/jvmMain/kotlin/com/arkivanov/sample/app/Utils.kt>here</a>.</p> </div> <h2 id=observing-the-navigation-state-manually>Observing the navigation state manually<a class=headerlink href=#observing-the-navigation-state-manually title="Permanent link">&para;</a></h2> <p>In most of the cases there is no need to manually observe the navigation state. One of the ways described in the sections below can be used instead. For instance, it's advised to use the <code>Children</code> function to display a stack of components. However, in some cases observing the navigation state manually can be useful. Every navigation model exposes its state as <code>Value&lt;T&gt;</code>, which makes it possible to observe the navigation state in Compose just as any other state.</p> <div class=highlight><pre><span></span><code><span class=k>import</span><span class=w> </span><span class=nn>androidx.compose.runtime.Composable</span>
<span class=k>import</span><span class=w> </span><span class=nn>androidx.compose.runtime.getValue</span>
<span class=k>import</span><span class=w> </span><span class=nn>com.arkivanov.decompose.extensions.compose.subscribeAsState</span>

<span class=nd>@Composable</span>
<span class=kd>fun</span><span class=w> </span><span class=nf>RootContent</span><span class=p>(</span><span class=n>component</span><span class=p>:</span><span class=w> </span><span class=n>RootComponent</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=kd>val</span><span class=w> </span><span class=nv>stack</span><span class=w> </span><span class=k>by</span><span class=w> </span><span class=n>component</span><span class=p>.</span><span class=na>childStack</span><span class=p>.</span><span class=na>subscribeAsState</span><span class=p>()</span>
<span class=w>    </span><span class=c1>// Use the stack variable here</span>
<span class=p>}</span>
</code></pre></div> <h2 id=navigating-between-composable-components>Navigating between Composable components<a class=headerlink href=#navigating-between-composable-components title="Permanent link">&para;</a></h2> <p>The <a href=../../navigation/stack/overview/ >Child Stack</a> navigation model provides <a href=https://github.com/arkivanov/Decompose/blob/master/decompose/src/commonMain/kotlin/com/arkivanov/decompose/router/stack/ChildStack.kt>ChildStack</a> as <code>Value&lt;ChildStack&gt;</code> that can be observed in a <code>Composable</code> component. This makes it possible to switch child <code>Composable</code> components following the <code>ChildStack</code> changes.</p> <p>The Compose extension module provides the <a href=https://github.com/arkivanov/Decompose/blob/master/extensions-compose/src/commonMain/kotlin/com/arkivanov/decompose/extensions/compose/stack/Children.kt>Children(...)</a> function which has the following features:</p> <ul> <li>It listens for the <code>ChildStack</code> changes and displays the corresponding child <code>Composable</code> component using the provided slot lambda.</li> <li>It preserves components' UI state (e.g. scrolling position) in the back stack and over configuration changes and process death.</li> <li>It animates between children if there is an <code>animation</code> spec provided.</li> </ul> <p>Here is an example of switching child components on navigation:</p> <div class=highlight><pre><span></span><code><span class=k>import</span><span class=w> </span><span class=nn>androidx.compose.runtime.Composable</span>
<span class=k>import</span><span class=w> </span><span class=nn>com.arkivanov.decompose.extensions.compose.jetbrains.stack.Children</span>
<span class=k>import</span><span class=w> </span><span class=nn>com.arkivanov.decompose.router.stack.ChildStack</span>
<span class=k>import</span><span class=w> </span><span class=nn>com.arkivanov.decompose.value.Value</span>
<span class=k>import</span><span class=w> </span><span class=nn>com.sample.shared.RootComponent.Child.DetailsChild</span>
<span class=k>import</span><span class=w> </span><span class=nn>com.sample.shared.RootComponent.Child.MainChild</span>

<span class=c1>// Root</span>

<span class=kd>interface</span><span class=w> </span><span class=nc>RootComponent</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=kd>val</span><span class=w> </span><span class=nv>childStack</span><span class=p>:</span><span class=w> </span><span class=n>Value</span><span class=o>&lt;</span><span class=n>ChildStack</span><span class=o>&lt;*</span><span class=p>,</span><span class=w> </span><span class=n>Child</span><span class=o>&gt;&gt;</span>

<span class=w>    </span><span class=kd>sealed</span><span class=w> </span><span class=kd>class</span><span class=w> </span><span class=nc>Child</span><span class=w> </span><span class=p>{</span>
<span class=w>        </span><span class=kd>data</span><span class=w> </span><span class=kd>class</span><span class=w> </span><span class=nc>MainChild</span><span class=p>(</span><span class=kd>val</span><span class=w> </span><span class=nv>component</span><span class=p>:</span><span class=w> </span><span class=n>MainComponent</span><span class=p>)</span><span class=w> </span><span class=p>:</span><span class=w> </span><span class=n>Child</span><span class=p>()</span>
<span class=w>        </span><span class=kd>data</span><span class=w> </span><span class=kd>class</span><span class=w> </span><span class=nc>DetailsChild</span><span class=p>(</span><span class=kd>val</span><span class=w> </span><span class=nv>component</span><span class=p>:</span><span class=w> </span><span class=n>DetailsComponent</span><span class=p>)</span><span class=w> </span><span class=p>:</span><span class=w> </span><span class=n>Child</span><span class=p>()</span>
<span class=w>    </span><span class=p>}</span>
<span class=p>}</span>

<span class=nd>@Composable</span>
<span class=kd>fun</span><span class=w> </span><span class=nf>RootContent</span><span class=p>(</span><span class=n>rootComponent</span><span class=p>:</span><span class=w> </span><span class=n>RootComponent</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=n>Children</span><span class=p>(</span><span class=n>rootComponent</span><span class=p>.</span><span class=na>childStack</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>        </span><span class=k>when</span><span class=w> </span><span class=p>(</span><span class=kd>val</span><span class=w> </span><span class=nv>child</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nb>it</span><span class=p>.</span><span class=na>instance</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>            </span><span class=k>is</span><span class=w> </span><span class=n>MainChild</span><span class=w> </span><span class=o>-&gt;</span><span class=w> </span><span class=n>MainContent</span><span class=p>(</span><span class=n>child</span><span class=p>.</span><span class=na>component</span><span class=p>)</span>
<span class=w>            </span><span class=k>is</span><span class=w> </span><span class=n>DetailsChild</span><span class=w> </span><span class=o>-&gt;</span><span class=w> </span><span class=n>DetailsContent</span><span class=p>(</span><span class=n>child</span><span class=p>.</span><span class=na>component</span><span class=p>)</span>
<span class=w>        </span><span class=p>}</span>
<span class=w>    </span><span class=p>}</span>
<span class=p>}</span>

<span class=c1>// Children</span>

<span class=kd>interface</span><span class=w> </span><span class=nc>MainComponent</span>

<span class=kd>interface</span><span class=w> </span><span class=nc>DetailsComponent</span>

<span class=nd>@Composable</span>
<span class=kd>fun</span><span class=w> </span><span class=nf>MainContent</span><span class=p>(</span><span class=n>component</span><span class=p>:</span><span class=w> </span><span class=n>MainComponent</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=c1>// Omitted code</span>
<span class=p>}</span>

<span class=nd>@Composable</span>
<span class=kd>fun</span><span class=w> </span><span class=nf>DetailsContent</span><span class=p>(</span><span class=n>component</span><span class=p>:</span><span class=w> </span><span class=n>DetailsComponent</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=c1>// Omitted code</span>
<span class=p>}</span>
</code></pre></div> <h2 id=child-slot-navigation-with-compose>Child Slot navigation with Compose<a class=headerlink href=#child-slot-navigation-with-compose title="Permanent link">&para;</a></h2> <p>Child Slot navigation model can be used for different purposes. It can be used to just show/hide a certain part of UI, or to present a dialog, or a sheet (like Material Bottom Sheet). Although Decompose doesn't provide any special Compose API for Child Slot, it's pretty easy to do it manually.</p> <div class=highlight><span class=filename>AlertDialog example</span><pre><span></span><code><span class=k>import</span><span class=w> </span><span class=nn>androidx.compose.foundation.layout.width</span>
<span class=k>import</span><span class=w> </span><span class=nn>androidx.compose.material.AlertDialog</span>
<span class=k>import</span><span class=w> </span><span class=nn>androidx.compose.material.Text</span>
<span class=k>import</span><span class=w> </span><span class=nn>androidx.compose.material.TextButton</span>
<span class=k>import</span><span class=w> </span><span class=nn>androidx.compose.runtime.Composable</span>
<span class=k>import</span><span class=w> </span><span class=nn>androidx.compose.runtime.getValue</span>
<span class=k>import</span><span class=w> </span><span class=nn>androidx.compose.ui.Modifier</span>
<span class=k>import</span><span class=w> </span><span class=nn>androidx.compose.ui.unit.dp</span>
<span class=k>import</span><span class=w> </span><span class=nn>com.arkivanov.decompose.extensions.compose.subscribeAsState</span>
<span class=k>import</span><span class=w> </span><span class=nn>com.arkivanov.decompose.router.slot.ChildSlot</span>
<span class=k>import</span><span class=w> </span><span class=nn>com.arkivanov.decompose.value.Value</span>

<span class=kd>interface</span><span class=w> </span><span class=nc>RootComponent</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=kd>val</span><span class=w> </span><span class=nv>dialog</span><span class=p>:</span><span class=w> </span><span class=n>Value</span><span class=o>&lt;</span><span class=n>ChildSlot</span><span class=o>&lt;*</span><span class=p>,</span><span class=w> </span><span class=n>DialogComponent</span><span class=o>&gt;&gt;</span>
<span class=p>}</span>

<span class=nd>@Composable</span>
<span class=kd>fun</span><span class=w> </span><span class=nf>RootContent</span><span class=p>(</span><span class=n>component</span><span class=p>:</span><span class=w> </span><span class=n>RootComponent</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=kd>val</span><span class=w> </span><span class=nv>dialogSlot</span><span class=w> </span><span class=k>by</span><span class=w> </span><span class=n>component</span><span class=p>.</span><span class=na>dialog</span><span class=p>.</span><span class=na>subscribeAsState</span><span class=p>()</span>
<span class=w>    </span><span class=n>dialogSlot</span><span class=p>.</span><span class=na>child</span><span class=o>?.</span><span class=na>instance</span><span class=o>?.</span><span class=na>also</span><span class=w> </span><span class=p>{</span>
<span class=w>        </span><span class=n>DialogContent</span><span class=p>(</span><span class=n>component</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nb>it</span><span class=p>)</span>
<span class=w>    </span><span class=p>}</span>
<span class=p>}</span>

<span class=kd>interface</span><span class=w> </span><span class=nc>DialogComponent</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=kd>fun</span><span class=w> </span><span class=nf>onDismissClicked</span><span class=p>()</span>
<span class=p>}</span>

<span class=nd>@Composable</span>
<span class=kd>fun</span><span class=w> </span><span class=nf>DialogContent</span><span class=p>(</span><span class=n>component</span><span class=p>:</span><span class=w> </span><span class=n>DialogComponent</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=n>AlertDialog</span><span class=p>(</span>
<span class=w>        </span><span class=n>onDismissRequest</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>component</span><span class=o>::</span><span class=n>onDismissClicked</span><span class=p>,</span>
<span class=w>        </span><span class=n>title</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>{</span><span class=w> </span><span class=n>Text</span><span class=p>(</span><span class=n>text</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&quot;Title&quot;</span><span class=p>)</span><span class=w> </span><span class=p>},</span>
<span class=w>        </span><span class=n>text</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>{</span><span class=w> </span><span class=n>Text</span><span class=p>(</span><span class=n>text</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&quot;Message&quot;</span><span class=p>)</span><span class=w> </span><span class=p>},</span>
<span class=w>        </span><span class=n>confirmButton</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>{</span>
<span class=w>            </span><span class=n>TextButton</span><span class=p>(</span><span class=n>onClick</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>component</span><span class=o>::</span><span class=n>onDismissClicked</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>                </span><span class=n>Text</span><span class=p>(</span><span class=s>&quot;Dismiss&quot;</span><span class=p>)</span>
<span class=w>            </span><span class=p>}</span>
<span class=w>        </span><span class=p>},</span>
<span class=w>        </span><span class=n>modifier</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>Modifier</span><span class=p>.</span><span class=na>width</span><span class=p>(</span><span class=m>300.</span><span class=n>dp</span><span class=p>),</span>
<span class=w>    </span><span class=p>)</span>
<span class=p>}</span>
</code></pre></div> <div class="admonition note"> <p class=admonition-title>Note</p> <p>Child Slot might not be suitable for a Navigation Drawer. This is because the Navigation Drawer can be opened by a drag gesture at any time. The corresponding component should be <a href=https://arkivanov.github.io/Decompose/component/child-components/#adding-a-child-component-manually>always created</a> so that it's always ready to be rendered.</p> </div> <h2 id=child-pages-navigation-with-compose>Child Pages navigation with Compose<a class=headerlink href=#child-pages-navigation-with-compose title="Permanent link">&para;</a></h2> <p>The <a href=../../navigation/pages/overview/ >Child Pages</a> navigation model provides <a href=https://github.com/arkivanov/Decompose/blob/master/decompose/src/commonMain/kotlin/com/arkivanov/decompose/router/pages/ChildPages.kt>ChildPages</a> as <code>Value&lt;ChildPages&gt;</code> that can be observed in a <code>Composable</code> component.</p> <p>The Compose extension module provides the <a href=https://github.com/arkivanov/Decompose/blob/master/extensions-compose/src/commonMain/kotlin/com/arkivanov/decompose/extensions/compose/pages/ChildPages.kt>ChildPages(...)</a> function which has the following features:</p> <ul> <li>It listens for the <code>ChildPages</code> changes and displays child components using <code>HorizontalPager</code> or <code>VerticalPager</code> (see the related Jetpack Compose <a href=https://developer.android.com/jetpack/compose/layouts/pager>documentation</a>).</li> <li>It animates page changes if there is a <code>scrollAnimation</code> spec provided.</li> </ul> <div class="tabbed-set tabbed-alternate" data-tabs=1:2><input checked=checked id=__tabbed_1_1 name=__tabbed_1 type=radio><input id=__tabbed_1_2 name=__tabbed_1 type=radio><div class=tabbed-labels><label for=__tabbed_1_1>Before version 3.2.0-alpha03</label><label for=__tabbed_1_2>Since version 3.2.0-alpha03</label></div> <div class=tabbed-content> <div class=tabbed-block> <div class=highlight><span class=filename>Example</span><pre><span></span><code><span class=k>import</span><span class=w> </span><span class=nn>androidx.compose.runtime.Composable</span>
<span class=k>import</span><span class=w> </span><span class=nn>com.arkivanov.decompose.extensions.compose.jetbrains.pages.Pages</span>
<span class=k>import</span><span class=w> </span><span class=nn>com.arkivanov.decompose.extensions.compose.jetbrains.pages.PagesScrollAnimation</span>

<span class=nd>@Composable</span>
<span class=kd>fun</span><span class=w> </span><span class=nf>PagesContent</span><span class=p>(</span><span class=n>component</span><span class=p>:</span><span class=w> </span><span class=n>PagesComponent</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=n>Pages</span><span class=p>(</span>
<span class=w>        </span><span class=n>pages</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>component</span><span class=p>.</span><span class=na>pages</span><span class=p>,</span>
<span class=w>        </span><span class=n>onPageSelected</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>component</span><span class=o>::</span><span class=n>selectPage</span><span class=p>,</span>
<span class=w>        </span><span class=n>scrollAnimation</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>PagesScrollAnimation</span><span class=p>.</span><span class=na>Default</span><span class=p>,</span>
<span class=w>    </span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w> </span><span class=n>_</span><span class=p>,</span><span class=w> </span><span class=n>page</span><span class=w> </span><span class=o>-&gt;</span>
<span class=w>        </span><span class=n>PageContent</span><span class=p>(</span><span class=n>page</span><span class=p>)</span>
<span class=w>    </span><span class=p>}</span>
<span class=p>}</span>

<span class=nd>@Composable</span>
<span class=kd>fun</span><span class=w> </span><span class=nf>PageContent</span><span class=p>(</span><span class=n>component</span><span class=p>:</span><span class=w> </span><span class=n>PageComponent</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=c1>// Omitted code</span>
<span class=p>}</span>
</code></pre></div> </div> <div class=tabbed-block> <div class=highlight><span class=filename>Example</span><pre><span></span><code><span class=k>import</span><span class=w> </span><span class=nn>androidx.compose.runtime.Composable</span>
<span class=k>import</span><span class=w> </span><span class=nn>com.arkivanov.decompose.extensions.compose.jetbrains.pages.ChildPages</span>
<span class=k>import</span><span class=w> </span><span class=nn>com.arkivanov.decompose.extensions.compose.jetbrains.pages.PagesScrollAnimation</span>

<span class=nd>@Composable</span>
<span class=kd>fun</span><span class=w> </span><span class=nf>PagesContent</span><span class=p>(</span><span class=n>component</span><span class=p>:</span><span class=w> </span><span class=n>PagesComponent</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=n>ChildPages</span><span class=p>(</span>
<span class=w>        </span><span class=n>pages</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>component</span><span class=p>.</span><span class=na>pages</span><span class=p>,</span>
<span class=w>        </span><span class=n>onPageSelected</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>component</span><span class=o>::</span><span class=n>selectPage</span><span class=p>,</span>
<span class=w>        </span><span class=n>scrollAnimation</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>PagesScrollAnimation</span><span class=p>.</span><span class=na>Default</span><span class=p>,</span>
<span class=w>    </span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w> </span><span class=n>_</span><span class=p>,</span><span class=w> </span><span class=n>page</span><span class=w> </span><span class=o>-&gt;</span>
<span class=w>        </span><span class=n>PageContent</span><span class=p>(</span><span class=n>page</span><span class=p>)</span>
<span class=w>    </span><span class=p>}</span>
<span class=p>}</span>

<span class=nd>@Composable</span>
<span class=kd>fun</span><span class=w> </span><span class=nf>PageContent</span><span class=p>(</span><span class=n>component</span><span class=p>:</span><span class=w> </span><span class=n>PageComponent</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=c1>// Omitted code</span>
<span class=p>}</span>
</code></pre></div> </div> </div> </div> <h2 id=child-panels-navigation-with-compose>Child Panels navigation with Compose<a class=headerlink href=#child-panels-navigation-with-compose title="Permanent link">&para;</a></h2> <div class="admonition warning"> <p class=admonition-title>Warning</p> <p>This navigation model is experimental since version <code>3.2.0-beta01</code>, the API is subject to change.</p> </div> <p>The <a href=../../navigation/panels/overview/ >Child Panels</a> navigation model provides <a href=https://github.com/arkivanov/Decompose/blob/master/decompose/src/commonMain/kotlin/com/arkivanov/decompose/router/panels/ChildPanels.kt>ChildPanels</a> as <code>Value&lt;ChildPages&gt;</code> that can be observed in a <code>Composable</code> component.</p> <p>The experimental Compose extension module provides the <a href=https://github.com/arkivanov/Decompose/blob/master/extensions-compose-experimental/src/commonMain/kotlin/com/arkivanov/decompose/extensions/compose/experimental/panels/ChildPanels.kt>ChildPanels(...)</a> function which has the following features:</p> <ul> <li>It listens for the <code>ChildPanels</code> changes and displays child components (panels) using the provided <code>layout</code>.</li> <li>It animates panel changes using the provided <code>animators</code> and <code>predictiveBackParams</code> specs.</li> <li>It supports displaying either just two panels (Main and Details) or three panels (Main, Details and Extra).</li> </ul> <p>The following arguments are supported.</p> <ul> <li><code>panels</code> - an observable [ChildPanels] to be displayed.</li> <li><code>mainChild</code> - a <code>Composable</code> function that displays the provided Main component.</li> <li><code>detailsChild</code> - a <code>Composable</code> function that displays the provided Details component.</li> <li><code>extraChild</code> - a <code>Composable</code> function that displays the provided Extra component.</li> <li><code>modifier</code> - a <code>Modifier</code> to be applied to a wrapping container.</li> <li><code>layout</code> - an implementation of <a href=https://github.com/arkivanov/Decompose/blob/master/extensions-compose-experimental/src/commonMain/kotlin/com/arkivanov/decompose/extensions/compose/experimental/panels/ChildPanelsLayout.kt>ChildPanelsLayout</a> responsible for laying out panels. The default layout is <a href=https://github.com/arkivanov/Decompose/blob/master/extensions-compose-experimental/src/commonMain/kotlin/com/arkivanov/decompose/extensions/compose/experimental/panels/HorizontalChildPanelsLayout.kt>HorizontalChildPanelsLayout</a>.</li> <li><code>animators</code> - a <a href=https://github.com/arkivanov/Decompose/blob/master/extensions-compose-experimental/src/commonMain/kotlin/com/arkivanov/decompose/extensions/compose/experimental/panels/ChildPanelsAnimators.kt>ChildPanelsAnimators</a> containing panel animators for different kinds of layouts.</li> <li><code>predictiveBackParams</code> - a function that returns <code>PredictiveBackParams</code> for the specified <code>ChildPanels</code>, or <code>null</code>. The predictive back gesture is enabled if the value returned for the specified <code>ChildStack</code> is not <code>null</code>, and disabled if the returned value is <code>null</code>. Only works if <code>ChildPanels.mode</code> is <code>SINGLE</code>. Also see the related docs below.</li> </ul> <p>The default <code>HorizontalChildPanelsLayout</code> layout places child components (panels) in the following ways.</p> <ul> <li>If the <code>mode</code> is <code>SINGLE</code>, all panels are displayed in a stack. The Main panel, then the Details panel on top (if any), and finally the Extra panel (if any).</li> <li>If the <code>mode</code> is <code>DUAL</code>, the Main panel is always displayed on the left side, and then the Details and the Extra panels are displayed in a stack on the right side (next to the Main panel).</li> <li>If the <code>mode</code> is <code>TRIPLE</code>, all panels are displayed horizontally side by side.</li> </ul> <p>You can use window size classes from the <code>material3-window-size-class</code> package to determine which <code>ChildPanelsMode</code> should be used.</p> <div class=highlight><span class=filename>WindowSizeClass example</span><pre><span></span><code><span class=k>import</span><span class=w> </span><span class=nn>androidx.compose.material3.windowsizeclass.WindowWidthSizeClass</span>
<span class=k>import</span><span class=w> </span><span class=nn>androidx.compose.material3.windowsizeclass.WindowWidthSizeClass.Companion.Expanded</span>
<span class=k>import</span><span class=w> </span><span class=nn>androidx.compose.material3.windowsizeclass.calculateWindowSizeClass</span>
<span class=k>import</span><span class=w> </span><span class=nn>com.arkivanov.decompose.router.panels.ChildPanelsMode</span>
<span class=k>import</span><span class=w> </span><span class=nn>com.arkivanov.decompose.router.panels.ChildPanelsMode.SINGLE</span>
<span class=k>import</span><span class=w> </span><span class=nn>com.arkivanov.decompose.router.panels.ChildPanelsMode.DUAL</span>

<span class=nd>@Composable</span>
<span class=kd>fun</span><span class=w> </span><span class=nf>ChildPanelsModeChangedEffect</span><span class=p>(</span><span class=n>onModeChanged</span><span class=p>:</span><span class=w> </span><span class=p>(</span><span class=n>ChildPanelsMode</span><span class=p>)</span><span class=w> </span><span class=o>-&gt;</span><span class=w> </span><span class=kt>Unit</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=kd>val</span><span class=w> </span><span class=nv>windowSize</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>calculateWindowSizeClass</span><span class=p>()</span>
<span class=w>    </span><span class=kd>val</span><span class=w> </span><span class=nv>mode</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>windowSize</span><span class=p>.</span><span class=na>widthSizeClass</span><span class=w> </span><span class=o>&lt;</span><span class=w> </span><span class=n>Expanded</span><span class=p>)</span><span class=w> </span><span class=n>SINGLE</span><span class=w> </span><span class=k>else</span><span class=w> </span><span class=n>DUAL</span>

<span class=w>    </span><span class=n>DisposableEffect</span><span class=p>(</span><span class=n>mode</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>        </span><span class=n>onModeChanged</span><span class=p>(</span><span class=n>mode</span><span class=p>)</span>
<span class=w>        </span><span class=n>onDispose</span><span class=w> </span><span class=p>{}</span>
<span class=w>    </span><span class=p>}</span>
<span class=p>}</span>
</code></pre></div> <div class=highlight><span class=filename>Basic example</span><pre><span></span><code><span class=k>import</span><span class=w> </span><span class=nn>androidx.compose.runtime.Composable</span>
<span class=k>import</span><span class=w> </span><span class=nn>com.arkivanov.decompose.extensions.compose.experimental.panels.ChildPanels</span>
<span class=k>import</span><span class=w> </span><span class=nn>com.arkivanov.decompose.router.panels.ChildPanelsMode</span>

<span class=nd>@Composable</span>
<span class=kd>fun</span><span class=w> </span><span class=nf>PanelsContent</span><span class=p>(</span><span class=n>component</span><span class=p>:</span><span class=w> </span><span class=n>PanelsComponent</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=n>ChildPanelsModeChangedEffect</span><span class=p>(</span><span class=n>component</span><span class=o>::</span><span class=n>setMode</span><span class=p>)</span>

<span class=w>    </span><span class=n>ChildPanels</span><span class=p>(</span>
<span class=w>        </span><span class=n>panels</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>component</span><span class=p>.</span><span class=na>panels</span><span class=p>,</span>
<span class=w>        </span><span class=n>mainChild</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>{</span><span class=w> </span><span class=n>MainContent</span><span class=p>(</span><span class=nb>it</span><span class=p>.</span><span class=na>instance</span><span class=p>)</span><span class=w> </span><span class=p>},</span>
<span class=w>        </span><span class=n>detailsChild</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>{</span><span class=w> </span><span class=n>DetailsContent</span><span class=p>(</span><span class=nb>it</span><span class=p>.</span><span class=na>instance</span><span class=p>)</span><span class=w> </span><span class=p>},</span>
<span class=w>    </span><span class=p>)</span>
<span class=p>}</span>

<span class=nd>@Composable</span>
<span class=kd>fun</span><span class=w> </span><span class=nf>MainContent</span><span class=p>(</span><span class=n>component</span><span class=p>:</span><span class=w> </span><span class=n>MainComponent</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=c1>// Omitted code</span>
<span class=p>}</span>

<span class=nd>@Composable</span>
<span class=kd>fun</span><span class=w> </span><span class=nf>DetailsContent</span><span class=p>(</span><span class=n>component</span><span class=p>:</span><span class=w> </span><span class=n>DetailsComponent</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=c1>// Omitted code</span>
<span class=p>}</span>
</code></pre></div> <div class=highlight><span class=filename>Example with animations</span><pre><span></span><code><span class=k>import</span><span class=w> </span><span class=nn>androidx.compose.runtime.Composable</span>
<span class=k>import</span><span class=w> </span><span class=nn>com.arkivanov.decompose.extensions.compose.experimental.panels.ChildPanels</span>
<span class=k>import</span><span class=w> </span><span class=nn>com.arkivanov.decompose.extensions.compose.experimental.panels.ChildPanelsAnimators</span>
<span class=k>import</span><span class=w> </span><span class=nn>com.arkivanov.decompose.extensions.compose.experimental.stack.animation.PredictiveBackParams</span>
<span class=k>import</span><span class=w> </span><span class=nn>com.arkivanov.decompose.extensions.compose.experimental.stack.animation.fade</span>
<span class=k>import</span><span class=w> </span><span class=nn>com.arkivanov.decompose.extensions.compose.experimental.stack.animation.plus</span>
<span class=k>import</span><span class=w> </span><span class=nn>com.arkivanov.decompose.extensions.compose.experimental.stack.animation.scale</span>
<span class=k>import</span><span class=w> </span><span class=nn>com.arkivanov.decompose.extensions.compose.stack.animation.predictiveback.materialPredictiveBackAnimatable</span>
<span class=k>import</span><span class=w> </span><span class=nn>com.arkivanov.decompose.router.panels.ChildPanelsMode</span>

<span class=nd>@Composable</span>
<span class=kd>fun</span><span class=w> </span><span class=nf>PanelsContent</span><span class=p>(</span><span class=n>component</span><span class=p>:</span><span class=w> </span><span class=n>PanelsComponent</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=n>ChildPanelsModeChangedEffect</span><span class=p>(</span><span class=n>component</span><span class=o>::</span><span class=n>setMode</span><span class=p>)</span>

<span class=w>    </span><span class=n>ChildPanels</span><span class=p>(</span>
<span class=w>        </span><span class=n>panels</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>component</span><span class=p>.</span><span class=na>panels</span><span class=p>,</span>
<span class=w>        </span><span class=n>mainChild</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>{</span><span class=w> </span><span class=n>MainContent</span><span class=p>(</span><span class=nb>it</span><span class=p>.</span><span class=na>instance</span><span class=p>)</span><span class=w> </span><span class=p>},</span>
<span class=w>        </span><span class=n>detailsChild</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>{</span><span class=w> </span><span class=n>DetailsContent</span><span class=p>(</span><span class=nb>it</span><span class=p>.</span><span class=na>instance</span><span class=p>)</span><span class=w> </span><span class=p>},</span>
<span class=w>        </span><span class=n>animators</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>ChildPanelsAnimators</span><span class=p>(</span><span class=n>single</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>fade</span><span class=p>()</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=n>scale</span><span class=p>(),</span><span class=w> </span><span class=n>dual</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>fade</span><span class=p>()</span><span class=w> </span><span class=n>to</span><span class=w> </span><span class=n>fade</span><span class=p>()),</span>
<span class=w>        </span><span class=n>predictiveBackParams</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>{</span><span class=w> </span><span class=c1>// See the docs below</span>
<span class=w>            </span><span class=n>PredictiveBackParams</span><span class=p>(</span>
<span class=w>                </span><span class=n>backHandler</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>component</span><span class=p>.</span><span class=na>backHandler</span><span class=p>,</span>
<span class=w>                </span><span class=n>onBack</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>component</span><span class=o>::</span><span class=n>onBackClicked</span><span class=p>,</span>
<span class=w>                </span><span class=n>animatable</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=o>::</span><span class=n>materialPredictiveBackAnimatable</span><span class=p>,</span>
<span class=w>            </span><span class=p>)</span>
<span class=w>        </span><span class=p>},</span>
<span class=w>    </span><span class=p>)</span>
<span class=p>}</span>
</code></pre></div> <h2 id=child-items-navigation-with-compose>Child Items navigation with Compose<a class=headerlink href=#child-items-navigation-with-compose title="Permanent link">&para;</a></h2> <div class="admonition warning"> <p class=admonition-title>Warning</p> <p>This navigation model is experimental and is available since version <code>3.4.0-alpha02</code>, the API is subject to change.</p> </div> <p>The <a href=../../navigation/items/overview/ >Child Items</a> navigation model provides <a href=https://github.com/arkivanov/Decompose/blob/master/decompose/src/commonMain/kotlin/com/arkivanov/decompose/router/items/ChildItems.kt>ChildItems</a> as <code>LazyChildItems</code> that extends both <code>Value&lt;ChildItems&gt;</code> and <code>ItemsNavigator</code>, meaning it can be observed and manipulated in a <code>Composable</code> component.</p> <p>The Compose extension module provides the <a href=https://github.com/arkivanov/Decompose/blob/master/extensions-compose/src/commonMain/kotlin/com/arkivanov/decompose/extensions/compose/lazyitems/ChildItemsLifecycleController.kt>ChildItemsLifecycleController(...)</a> function which has the following features:</p> <ul> <li>It automatically manages the lifecycle states of child items in lazy lists and grids based on their visibility in the viewport.</li> <li>Items within the viewport are moved to <code>RESUMED</code> state.</li> <li>Items outside the viewport but within the preloading delta are moved to <code>CREATED</code> state.</li> <li>Items outside the viewport and outside the preloading delta are destroyed.</li> </ul> <p>This is particularly useful for optimizing performance in lazy lists/grids by only keeping visible and nearby items active.</p> <p>The controller provides two main variants:</p> <ol> <li>For lazy lists (<code>LazyColumn</code>, <code>LazyRow</code>):</li> </ol> <div class=highlight><pre><span></span><code><span class=nd>@Composable</span>
<span class=kd>fun</span><span class=w> </span><span class=o>&lt;</span><span class=n>C</span><span class=w> </span><span class=p>:</span><span class=w> </span><span class=n>Any</span><span class=o>&gt;</span><span class=w> </span><span class=nf>ChildItemsLifecycleController</span><span class=p>(</span>
<span class=w>    </span><span class=n>items</span><span class=p>:</span><span class=w> </span><span class=n>LazyChildItems</span><span class=o>&lt;</span><span class=n>C</span><span class=p>,</span><span class=w> </span><span class=o>*&gt;</span><span class=p>,</span>
<span class=w>    </span><span class=n>lazyListState</span><span class=p>:</span><span class=w> </span><span class=n>LazyListState</span><span class=p>,</span>
<span class=w>    </span><span class=n>itemIndexConverter</span><span class=p>:</span><span class=w> </span><span class=p>(</span><span class=kt>Int</span><span class=p>)</span><span class=w> </span><span class=o>-&gt;</span><span class=w> </span><span class=kt>Int</span><span class=p>,</span>
<span class=w>    </span><span class=n>forwardPreloadCount</span><span class=p>:</span><span class=w> </span><span class=kt>Int</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=m>0</span><span class=p>,</span>
<span class=w>    </span><span class=n>backwardPreloadCount</span><span class=p>:</span><span class=w> </span><span class=kt>Int</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=m>0</span><span class=p>,</span>
<span class=p>)</span>
</code></pre></div> <ol> <li>For lazy grids (<code>LazyVerticalGrid</code>, <code>LazyHorizontalGrid</code>):</li> </ol> <div class=highlight><pre><span></span><code><span class=nd>@Composable</span>
<span class=kd>fun</span><span class=w> </span><span class=o>&lt;</span><span class=n>C</span><span class=w> </span><span class=p>:</span><span class=w> </span><span class=n>Any</span><span class=o>&gt;</span><span class=w> </span><span class=nf>ChildItemsLifecycleController</span><span class=p>(</span>
<span class=w>    </span><span class=n>items</span><span class=p>:</span><span class=w> </span><span class=n>LazyChildItems</span><span class=o>&lt;</span><span class=n>C</span><span class=p>,</span><span class=w> </span><span class=o>*&gt;</span><span class=p>,</span>
<span class=w>    </span><span class=n>lazyGridState</span><span class=p>:</span><span class=w> </span><span class=n>LazyGridState</span><span class=p>,</span>
<span class=w>    </span><span class=n>itemIndexConverter</span><span class=p>:</span><span class=w> </span><span class=p>(</span><span class=kt>Int</span><span class=p>)</span><span class=w> </span><span class=o>-&gt;</span><span class=w> </span><span class=kt>Int</span><span class=p>,</span>
<span class=w>    </span><span class=n>forwardPreloadCount</span><span class=p>:</span><span class=w> </span><span class=kt>Int</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=m>0</span><span class=p>,</span>
<span class=w>    </span><span class=n>backwardPreloadCount</span><span class=p>:</span><span class=w> </span><span class=kt>Int</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=m>0</span><span class=p>,</span>
<span class=p>)</span>
</code></pre></div> <p>Example:</p> <div class=highlight><span class=filename>Example</span><pre><span></span><code><span class=k>import</span><span class=w> </span><span class=nn>androidx.compose.foundation.lazy.LazyColumn</span>
<span class=k>import</span><span class=w> </span><span class=nn>androidx.compose.foundation.lazy.items</span>
<span class=k>import</span><span class=w> </span><span class=nn>androidx.compose.foundation.lazy.rememberLazyListState</span>
<span class=k>import</span><span class=w> </span><span class=nn>androidx.compose.runtime.Composable</span>
<span class=k>import</span><span class=w> </span><span class=nn>androidx.compose.runtime.getValue</span>
<span class=k>import</span><span class=w> </span><span class=nn>com.arkivanov.decompose.extensions.compose.lazyitems.ChildItemsLifecycleController</span>
<span class=k>import</span><span class=w> </span><span class=nn>com.arkivanov.decompose.extensions.compose.subscribeAsState</span>
<span class=k>import</span><span class=w> </span><span class=nn>com.arkivanov.sample.shared.foo.ItemComponent</span>
<span class=k>import</span><span class=w> </span><span class=nn>com.arkivanov.sample.shared.foo.ItemsComponent</span>

<span class=nd>@Composable</span>
<span class=kd>fun</span><span class=w> </span><span class=nf>ItemsContent</span><span class=p>(</span><span class=n>component</span><span class=p>:</span><span class=w> </span><span class=n>ItemsComponent</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=kd>val</span><span class=w> </span><span class=nv>childItems</span><span class=w> </span><span class=k>by</span><span class=w> </span><span class=n>component</span><span class=p>.</span><span class=na>items</span><span class=p>.</span><span class=na>subscribeAsState</span><span class=p>()</span>
<span class=w>    </span><span class=kd>val</span><span class=w> </span><span class=nv>lazyListState</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>rememberLazyListState</span><span class=p>()</span>

<span class=w>    </span><span class=n>LazyColumn</span><span class=p>(</span><span class=n>state</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>lazyListState</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>        </span><span class=n>items</span><span class=p>(</span><span class=n>items</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>childItems</span><span class=p>.</span><span class=na>items</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w> </span><span class=n>config</span><span class=w> </span><span class=o>-&gt;</span>
<span class=w>            </span><span class=n>ItemContent</span><span class=p>(</span><span class=n>component</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>component</span><span class=p>.</span><span class=na>items</span><span class=o>[</span><span class=n>config</span><span class=o>]</span><span class=p>)</span>
<span class=w>        </span><span class=p>}</span>
<span class=w>    </span><span class=p>}</span>

<span class=w>    </span><span class=n>ChildItemsLifecycleController</span><span class=p>(</span>
<span class=w>        </span><span class=n>items</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>component</span><span class=p>.</span><span class=na>items</span><span class=p>,</span>
<span class=w>        </span><span class=n>lazyListState</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>lazyListState</span><span class=p>,</span>
<span class=w>        </span><span class=n>forwardPreloadCount</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=m>3</span><span class=p>,</span><span class=w> </span><span class=c1>// Preload 3 components forward</span>
<span class=w>        </span><span class=n>backwardPreloadCount</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=m>3</span><span class=p>,</span><span class=w> </span><span class=c1>// Preload 3 components backward</span>
<span class=w>        </span><span class=n>itemIndexConverter</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>{</span><span class=w> </span><span class=nb>it</span><span class=w> </span><span class=p>},</span>
<span class=w>    </span><span class=p>)</span>
<span class=p>}</span>

<span class=nd>@Composable</span>
<span class=kd>fun</span><span class=w> </span><span class=nf>ItemContent</span><span class=p>(</span><span class=n>component</span><span class=p>:</span><span class=w> </span><span class=n>ItemComponent</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=c1>// Omitted code</span>
<span class=p>}</span>
</code></pre></div> <h2 id=animations>Animations<a class=headerlink href=#animations title="Permanent link">&para;</a></h2> <p>Decompose provides <a href=https://github.com/arkivanov/Decompose/tree/master/extensions-compose/src/commonMain/kotlin/com/arkivanov/decompose/extensions/compose/stack/animation>Child Animation API</a> for Compose, as well as some predefined animation specs. To enable child animations you need to pass the <code>animation</code> argument to the <code>Children</code> function. There are predefined animators provided by Decompose.</p> <h3 id=the-new-experimental-animation-api>The new experimental animation API<a class=headerlink href=#the-new-experimental-animation-api title="Permanent link">&para;</a></h3> <p>Since version <code>3.2.0-alpha04</code>, Decompose also provides additional module with experimental animation API. Unlike the default stable API, the new experimental animation API also supports the <a href=https://developer.android.com/develop/ui/compose/animation/shared-elements>Shared Element Transitions</a>.</p> <h4 id=adding-the-dependency-with-the-new-animation-api>Adding the dependency with the new animation API<a class=headerlink href=#adding-the-dependency-with-the-new-animation-api title="Permanent link">&para;</a></h4> <div class="tabbed-set tabbed-alternate" data-tabs=2:2><input checked=checked id=__tabbed_2_1 name=__tabbed_2 type=radio><input id=__tabbed_2_2 name=__tabbed_2 type=radio><div class=tabbed-labels><label for=__tabbed_2_1>Groovy</label><label for=__tabbed_2_2>Kotlin</label></div> <div class=tabbed-content> <div class=tabbed-block> <div class=highlight><pre><span></span><code><span class=n>implementation</span><span class=w> </span><span class=s2>&quot;com.arkivanov.decompose:extensions-compose-experimental:&lt;version&gt;&quot;</span>
</code></pre></div> </div> <div class=tabbed-block> <div class=highlight><pre><span></span><code><span class=n>implementation</span><span class=p>(</span><span class=s>&quot;com.arkivanov.decompose:extensions-compose-experimental:&lt;version&gt;&quot;</span><span class=p>)</span>
</code></pre></div> </div> </div> </div> <h4 id=the-childstack-composable-function>The ChildStack composable function<a class=headerlink href=#the-childstack-composable-function title="Permanent link">&para;</a></h4> <p>The <a href=https://github.com/arkivanov/Decompose/blob/master/extensions-compose-experimental/src/commonMain/kotlin/com/arkivanov/decompose/extensions/compose/experimental/stack/ChildStack.kt>ChildStack</a> composable function is a replacement for the default <code>Children</code> composable function and serves the same purpose: displaying Child Stack components with transition animations.</p> <div class=highlight><span class=filename>Example</span><pre><span></span><code><span class=k>import</span><span class=w> </span><span class=nn>androidx.compose.runtime.Composable</span>
<span class=k>import</span><span class=w> </span><span class=nn>com.arkivanov.decompose.extensions.compose.experimental.stack.ChildStack</span>

<span class=nd>@Composable</span>
<span class=kd>fun</span><span class=w> </span><span class=nf>RootContent</span><span class=p>(</span><span class=n>rootComponent</span><span class=p>:</span><span class=w> </span><span class=n>RootComponent</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=n>ChildStack</span><span class=p>(</span><span class=n>rootComponent</span><span class=p>.</span><span class=na>childStack</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>        </span><span class=k>when</span><span class=w> </span><span class=p>(</span><span class=kd>val</span><span class=w> </span><span class=nv>child</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nb>it</span><span class=p>.</span><span class=na>instance</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>            </span><span class=k>is</span><span class=w> </span><span class=n>MainChild</span><span class=w> </span><span class=o>-&gt;</span><span class=w> </span><span class=n>MainContent</span><span class=p>(</span><span class=n>child</span><span class=p>.</span><span class=na>component</span><span class=p>)</span>
<span class=w>            </span><span class=k>is</span><span class=w> </span><span class=n>DetailsChild</span><span class=w> </span><span class=o>-&gt;</span><span class=w> </span><span class=n>DetailsContent</span><span class=p>(</span><span class=n>child</span><span class=p>.</span><span class=na>component</span><span class=p>)</span>
<span class=w>        </span><span class=p>}</span>
<span class=w>    </span><span class=p>}</span>
<span class=p>}</span>
</code></pre></div> <h3 id=fade-animation>Fade animation<a class=headerlink href=#fade-animation title="Permanent link">&para;</a></h3> <div class="tabbed-set tabbed-alternate" data-tabs=3:2><input checked=checked id=__tabbed_3_1 name=__tabbed_3 type=radio><input id=__tabbed_3_2 name=__tabbed_3 type=radio><div class=tabbed-labels><label for=__tabbed_3_1>Default API</label><label for=__tabbed_3_2>Experimental API</label></div> <div class=tabbed-content> <div class=tabbed-block> <div class=highlight><pre><span></span><code><span class=k>import</span><span class=w> </span><span class=nn>androidx.compose.runtime.Composable</span>
<span class=k>import</span><span class=w> </span><span class=nn>com.arkivanov.decompose.extensions.compose.stack.Children</span>
<span class=k>import</span><span class=w> </span><span class=nn>com.arkivanov.decompose.extensions.compose.stack.animation.fade</span>
<span class=k>import</span><span class=w> </span><span class=nn>com.arkivanov.decompose.extensions.compose.stack.animation.stackAnimation</span>

<span class=nd>@Composable</span>
<span class=kd>fun</span><span class=w> </span><span class=nf>RootContent</span><span class=p>(</span><span class=n>component</span><span class=p>:</span><span class=w> </span><span class=n>RootComponent</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=n>Children</span><span class=p>(</span>
<span class=w>        </span><span class=n>stack</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>component</span><span class=p>.</span><span class=na>childStack</span><span class=p>,</span>
<span class=w>        </span><span class=n>animation</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>stackAnimation</span><span class=p>(</span><span class=n>fade</span><span class=p>()),</span>
<span class=w>    </span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>        </span><span class=c1>// Omitted code</span>
<span class=w>    </span><span class=p>}</span>
<span class=p>}</span>
</code></pre></div> </div> <div class=tabbed-block> <div class=highlight><pre><span></span><code><span class=k>import</span><span class=w> </span><span class=nn>androidx.compose.runtime.Composable</span>
<span class=k>import</span><span class=w> </span><span class=nn>com.arkivanov.decompose.extensions.compose.experimental.stack.ChildStack</span>
<span class=k>import</span><span class=w> </span><span class=nn>com.arkivanov.decompose.extensions.compose.experimental.stack.animation.fade</span>
<span class=k>import</span><span class=w> </span><span class=nn>com.arkivanov.decompose.extensions.compose.experimental.stack.animation.stackAnimation</span>

<span class=nd>@Composable</span>
<span class=kd>fun</span><span class=w> </span><span class=nf>RootContent</span><span class=p>(</span><span class=n>component</span><span class=p>:</span><span class=w> </span><span class=n>RootComponent</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=n>ChildStack</span><span class=p>(</span>
<span class=w>        </span><span class=n>stack</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>component</span><span class=p>.</span><span class=na>childStack</span><span class=p>,</span>
<span class=w>        </span><span class=n>animation</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>stackAnimation</span><span class=p>(</span><span class=n>fade</span><span class=p>()),</span>
<span class=w>    </span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>        </span><span class=c1>// Omitted code</span>
<span class=w>    </span><span class=p>}</span>
<span class=p>}</span>
</code></pre></div> </div> </div> </div> <p><img src=https://raw.githubusercontent.com/arkivanov/Decompose/master/docs/media/ComposeAnimationFade.gif width=512></p> <h3 id=slide-animation>Slide animation<a class=headerlink href=#slide-animation title="Permanent link">&para;</a></h3> <div class="tabbed-set tabbed-alternate" data-tabs=4:2><input checked=checked id=__tabbed_4_1 name=__tabbed_4 type=radio><input id=__tabbed_4_2 name=__tabbed_4 type=radio><div class=tabbed-labels><label for=__tabbed_4_1>Default API</label><label for=__tabbed_4_2>Experimental API</label></div> <div class=tabbed-content> <div class=tabbed-block> <div class=highlight><pre><span></span><code><span class=k>import</span><span class=w> </span><span class=nn>androidx.compose.runtime.Composable</span>
<span class=k>import</span><span class=w> </span><span class=nn>com.arkivanov.decompose.extensions.compose.stack.Children</span>
<span class=k>import</span><span class=w> </span><span class=nn>com.arkivanov.decompose.extensions.compose.stack.animation.slide</span>
<span class=k>import</span><span class=w> </span><span class=nn>com.arkivanov.decompose.extensions.compose.stack.animation.stackAnimation</span>

<span class=nd>@Composable</span>
<span class=kd>fun</span><span class=w> </span><span class=nf>RootContent</span><span class=p>(</span><span class=n>component</span><span class=p>:</span><span class=w> </span><span class=n>RootComponent</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=n>Children</span><span class=p>(</span>
<span class=w>        </span><span class=n>stack</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>component</span><span class=p>.</span><span class=na>childStack</span><span class=p>,</span>
<span class=w>        </span><span class=n>animation</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>stackAnimation</span><span class=p>(</span><span class=n>slide</span><span class=p>()),</span>
<span class=w>    </span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>        </span><span class=c1>// Omitted code</span>
<span class=w>    </span><span class=p>}</span>
<span class=p>}</span>
</code></pre></div> </div> <div class=tabbed-block> <div class=highlight><pre><span></span><code><span class=k>import</span><span class=w> </span><span class=nn>androidx.compose.runtime.Composable</span>
<span class=k>import</span><span class=w> </span><span class=nn>com.arkivanov.decompose.extensions.compose.experimental.stack.ChildStack</span>
<span class=k>import</span><span class=w> </span><span class=nn>com.arkivanov.decompose.extensions.compose.experimental.stack.animation.slide</span>
<span class=k>import</span><span class=w> </span><span class=nn>com.arkivanov.decompose.extensions.compose.experimental.stack.animation.stackAnimation</span>

<span class=nd>@Composable</span>
<span class=kd>fun</span><span class=w> </span><span class=nf>RootContent</span><span class=p>(</span><span class=n>component</span><span class=p>:</span><span class=w> </span><span class=n>RootComponent</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=n>ChildStack</span><span class=p>(</span>
<span class=w>        </span><span class=n>stack</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>component</span><span class=p>.</span><span class=na>childStack</span><span class=p>,</span>
<span class=w>        </span><span class=n>animation</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>stackAnimation</span><span class=p>(</span><span class=n>slide</span><span class=p>()),</span>
<span class=w>    </span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>        </span><span class=c1>// Omitted code</span>
<span class=w>    </span><span class=p>}</span>
<span class=p>}</span>
</code></pre></div> </div> </div> </div> <p><img src=https://raw.githubusercontent.com/arkivanov/Decompose/master/docs/media/ComposeAnimationSlide.gif width=512></p> <h3 id=combining-animators>Combining animators<a class=headerlink href=#combining-animators title="Permanent link">&para;</a></h3> <p>It is also possible to combine animators using the <code>plus</code> operator. Please note that the order matters - the right animator is applied after the left animator.</p> <div class="tabbed-set tabbed-alternate" data-tabs=5:2><input checked=checked id=__tabbed_5_1 name=__tabbed_5 type=radio><input id=__tabbed_5_2 name=__tabbed_5 type=radio><div class=tabbed-labels><label for=__tabbed_5_1>Default API</label><label for=__tabbed_5_2>Experimental API</label></div> <div class=tabbed-content> <div class=tabbed-block> <div class=highlight><pre><span></span><code><span class=k>import</span><span class=w> </span><span class=nn>androidx.compose.runtime.Composable</span>
<span class=k>import</span><span class=w> </span><span class=nn>com.arkivanov.decompose.extensions.compose.stack.Children</span>
<span class=k>import</span><span class=w> </span><span class=nn>com.arkivanov.decompose.extensions.compose.stack.animation.fade</span>
<span class=k>import</span><span class=w> </span><span class=nn>com.arkivanov.decompose.extensions.compose.stack.animation.plus</span>
<span class=k>import</span><span class=w> </span><span class=nn>com.arkivanov.decompose.extensions.compose.stack.animation.scale</span>
<span class=k>import</span><span class=w> </span><span class=nn>com.arkivanov.decompose.extensions.compose.stack.animation.stackAnimation</span>

<span class=nd>@Composable</span>
<span class=kd>fun</span><span class=w> </span><span class=nf>RootContent</span><span class=p>(</span><span class=n>component</span><span class=p>:</span><span class=w> </span><span class=n>RootComponent</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=n>Children</span><span class=p>(</span>
<span class=w>        </span><span class=n>stack</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>component</span><span class=p>.</span><span class=na>childStack</span><span class=p>,</span>
<span class=w>        </span><span class=n>animation</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>stackAnimation</span><span class=p>(</span><span class=n>fade</span><span class=p>()</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=n>scale</span><span class=p>())</span>
<span class=w>    </span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>        </span><span class=c1>// Omitted code</span>
<span class=w>    </span><span class=p>}</span>
<span class=p>}</span>
</code></pre></div> </div> <div class=tabbed-block> <div class=highlight><pre><span></span><code><span class=k>import</span><span class=w> </span><span class=nn>androidx.compose.runtime.Composable</span>
<span class=k>import</span><span class=w> </span><span class=nn>com.arkivanov.decompose.extensions.compose.experimental.stack.ChildStack</span>
<span class=k>import</span><span class=w> </span><span class=nn>com.arkivanov.decompose.extensions.compose.experimental.stack.animation.fade</span>
<span class=k>import</span><span class=w> </span><span class=nn>com.arkivanov.decompose.extensions.compose.experimental.stack.animation.plus</span>
<span class=k>import</span><span class=w> </span><span class=nn>com.arkivanov.decompose.extensions.compose.experimental.stack.animation.scale</span>
<span class=k>import</span><span class=w> </span><span class=nn>com.arkivanov.decompose.extensions.compose.experimental.stack.animation.stackAnimation</span>

<span class=nd>@Composable</span>
<span class=kd>fun</span><span class=w> </span><span class=nf>RootContent</span><span class=p>(</span><span class=n>component</span><span class=p>:</span><span class=w> </span><span class=n>RootComponent</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=n>ChildStack</span><span class=p>(</span>
<span class=w>        </span><span class=n>stack</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>component</span><span class=p>.</span><span class=na>childStack</span><span class=p>,</span>
<span class=w>        </span><span class=n>animation</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>stackAnimation</span><span class=p>(</span><span class=n>fade</span><span class=p>()</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=n>scale</span><span class=p>())</span>
<span class=w>    </span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>        </span><span class=c1>// Omitted code</span>
<span class=w>    </span><span class=p>}</span>
<span class=p>}</span>
</code></pre></div> </div> </div> </div> <p><img src=https://raw.githubusercontent.com/arkivanov/Decompose/master/docs/media/ComposeAnimationFadeScale.gif width=512></p> <h3 id=separate-animations-for-children>Separate animations for children<a class=headerlink href=#separate-animations-for-children title="Permanent link">&para;</a></h3> <p>Previous examples demonstrate simple cases when all children have the same animation. But it is also possible to specify separate animations for children.</p> <div class="tabbed-set tabbed-alternate" data-tabs=6:2><input checked=checked id=__tabbed_6_1 name=__tabbed_6 type=radio><input id=__tabbed_6_2 name=__tabbed_6 type=radio><div class=tabbed-labels><label for=__tabbed_6_1>Default API</label><label for=__tabbed_6_2>Experimental API</label></div> <div class=tabbed-content> <div class=tabbed-block> <div class=highlight><pre><span></span><code><span class=k>import</span><span class=w> </span><span class=nn>androidx.compose.runtime.Composable</span>
<span class=k>import</span><span class=w> </span><span class=nn>com.arkivanov.decompose.extensions.compose.stack.Children</span>
<span class=k>import</span><span class=w> </span><span class=nn>com.arkivanov.decompose.extensions.compose.stack.animation.fade</span>
<span class=k>import</span><span class=w> </span><span class=nn>com.arkivanov.decompose.extensions.compose.stack.animation.plus</span>
<span class=k>import</span><span class=w> </span><span class=nn>com.arkivanov.decompose.extensions.compose.stack.animation.scale</span>
<span class=k>import</span><span class=w> </span><span class=nn>com.arkivanov.decompose.extensions.compose.stack.animation.slide</span>
<span class=k>import</span><span class=w> </span><span class=nn>com.arkivanov.decompose.extensions.compose.stack.animation.stackAnimation</span>

<span class=nd>@Composable</span>
<span class=kd>fun</span><span class=w> </span><span class=nf>RootContent</span><span class=p>(</span><span class=n>component</span><span class=p>:</span><span class=w> </span><span class=n>RootComponent</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=n>Children</span><span class=p>(</span>
<span class=w>        </span><span class=n>stack</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>component</span><span class=p>.</span><span class=na>childStack</span><span class=p>,</span>
<span class=w>        </span><span class=n>animation</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>stackAnimation</span><span class=w> </span><span class=p>{</span><span class=w> </span><span class=n>child</span><span class=w> </span><span class=o>-&gt;</span>
<span class=w>            </span><span class=k>when</span><span class=w> </span><span class=p>(</span><span class=n>child</span><span class=p>.</span><span class=na>instance</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>                </span><span class=k>is</span><span class=w> </span><span class=n>MainChild</span><span class=w> </span><span class=o>-&gt;</span><span class=w> </span><span class=n>fade</span><span class=p>()</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=n>scale</span><span class=p>()</span>
<span class=w>                </span><span class=k>is</span><span class=w> </span><span class=n>DetailsChild</span><span class=w> </span><span class=o>-&gt;</span><span class=w> </span><span class=n>fade</span><span class=p>()</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=n>slide</span><span class=p>()</span>
<span class=w>            </span><span class=p>}</span>
<span class=w>        </span><span class=p>}</span>
<span class=w>    </span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>        </span><span class=c1>// Omitted code</span>
<span class=w>    </span><span class=p>}</span>
<span class=p>}</span>
</code></pre></div> </div> <div class=tabbed-block> <p>Not avilable. Please use the veriant below.</p> </div> </div> </div> <p><img src=https://raw.githubusercontent.com/arkivanov/Decompose/master/docs/media/ComposeAnimationSeparate.gif width=512></p> <p>It is also possible to take into account the other child and the animation direction when selecting the animation.</p> <div class="tabbed-set tabbed-alternate" data-tabs=7:2><input checked=checked id=__tabbed_7_1 name=__tabbed_7 type=radio><input id=__tabbed_7_2 name=__tabbed_7 type=radio><div class=tabbed-labels><label for=__tabbed_7_1>Default API</label><label for=__tabbed_7_2>Experimental API</label></div> <div class=tabbed-content> <div class=tabbed-block> <div class=highlight><pre><span></span><code><span class=k>import</span><span class=w> </span><span class=nn>androidx.compose.runtime.Composable</span>
<span class=k>import</span><span class=w> </span><span class=nn>com.arkivanov.decompose.extensions.compose.stack.Children</span>
<span class=k>import</span><span class=w> </span><span class=nn>com.arkivanov.decompose.extensions.compose.stack.animation.stackAnimation</span>

<span class=nd>@Composable</span>
<span class=kd>fun</span><span class=w> </span><span class=nf>RootContent</span><span class=p>(</span><span class=n>component</span><span class=p>:</span><span class=w> </span><span class=n>RootComponent</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=n>Children</span><span class=p>(</span>
<span class=w>        </span><span class=n>stack</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>component</span><span class=p>.</span><span class=na>childStack</span><span class=p>,</span>
<span class=w>        </span><span class=n>animation</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>stackAnimation</span><span class=w> </span><span class=p>{</span><span class=w> </span><span class=n>child</span><span class=p>,</span><span class=w> </span><span class=n>otherChild</span><span class=p>,</span><span class=w> </span><span class=n>direction</span><span class=w> </span><span class=o>-&gt;</span>
<span class=w>            </span><span class=c1>// Select and return an animator here</span>
<span class=w>        </span><span class=p>}</span>
<span class=w>    </span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>        </span><span class=c1>// Omitted code</span>
<span class=w>    </span><span class=p>}</span>
<span class=p>}</span>
</code></pre></div> </div> <div class=tabbed-block> <div class=highlight><pre><span></span><code><span class=k>import</span><span class=w> </span><span class=nn>androidx.compose.runtime.Composable</span>
<span class=k>import</span><span class=w> </span><span class=nn>com.arkivanov.decompose.extensions.compose.experimental.stack.ChildStack</span>
<span class=k>import</span><span class=w> </span><span class=nn>com.arkivanov.decompose.extensions.compose.experimental.stack.animation.stackAnimation</span>

<span class=nd>@Composable</span>
<span class=kd>fun</span><span class=w> </span><span class=nf>RootContent</span><span class=p>(</span><span class=n>component</span><span class=p>:</span><span class=w> </span><span class=n>RootComponent</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=n>ChildStack</span><span class=p>(</span>
<span class=w>        </span><span class=n>stack</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>component</span><span class=p>.</span><span class=na>childStack</span><span class=p>,</span>
<span class=w>        </span><span class=n>animation</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>stackAnimation</span><span class=w> </span><span class=p>{</span><span class=w> </span><span class=n>child</span><span class=p>,</span><span class=w> </span><span class=n>otherChild</span><span class=p>,</span><span class=w> </span><span class=n>direction</span><span class=w> </span><span class=o>-&gt;</span>
<span class=w>            </span><span class=c1>// Select and return an animator here</span>
<span class=w>        </span><span class=p>}</span>
<span class=w>    </span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>        </span><span class=c1>// Omitted code</span>
<span class=w>    </span><span class=p>}</span>
<span class=p>}</span>
</code></pre></div> </div> </div> </div> <h3 id=default-stack-animations>Default stack animations<a class=headerlink href=#default-stack-animations title="Permanent link">&para;</a></h3> <p>By default, the <code>Children</code> function (and all other functions with stack animations) does not animate stack changes, the change is performed instantly. The default stack animation is configurable so that it's possible to avoid specifying the same animation multiple times.</p> <div class="tabbed-set tabbed-alternate" data-tabs=8:2><input checked=checked id=__tabbed_8_1 name=__tabbed_8 type=radio><input id=__tabbed_8_2 name=__tabbed_8 type=radio><div class=tabbed-labels><label for=__tabbed_8_1>Default API</label><label for=__tabbed_8_2>Experimental API</label></div> <div class=tabbed-content> <div class=tabbed-block> <div class=highlight><pre><span></span><code><span class=k>import</span><span class=w> </span><span class=nn>androidx.compose.runtime.Composable</span>
<span class=k>import</span><span class=w> </span><span class=nn>androidx.compose.runtime.CompositionLocalProvider</span>
<span class=k>import</span><span class=w> </span><span class=nn>com.arkivanov.decompose.extensions.compose.stack.animation.LocalStackAnimationProvider</span>
<span class=k>import</span><span class=w> </span><span class=nn>com.arkivanov.decompose.extensions.compose.stack.animation.StackAnimation</span>
<span class=k>import</span><span class=w> </span><span class=nn>com.arkivanov.decompose.extensions.compose.stack.animation.StackAnimationProvider</span>
<span class=k>import</span><span class=w> </span><span class=nn>com.arkivanov.decompose.extensions.compose.stack.animation.plus</span>
<span class=k>import</span><span class=w> </span><span class=nn>com.arkivanov.decompose.extensions.compose.stack.animation.scale</span>
<span class=k>import</span><span class=w> </span><span class=nn>com.arkivanov.decompose.extensions.compose.stack.animation.slide</span>
<span class=k>import</span><span class=w> </span><span class=nn>com.arkivanov.decompose.extensions.compose.stack.animation.stackAnimation</span>

<span class=nd>@Composable</span>
<span class=kd>fun</span><span class=w> </span><span class=nf>App</span><span class=p>()</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=n>CompositionLocalProvider</span><span class=p>(</span><span class=n>LocalStackAnimationProvider</span><span class=w> </span><span class=n>provides</span><span class=w> </span><span class=n>DefaultStackAnimationProvider</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>        </span><span class=c1>// The rest of the code</span>
<span class=w>    </span><span class=p>}</span>
<span class=p>}</span>

<span class=kd>private</span><span class=w> </span><span class=kd>object</span><span class=w> </span><span class=nc>DefaultStackAnimationProvider</span><span class=w> </span><span class=p>:</span><span class=w> </span><span class=n>StackAnimationProvider</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=kd>override</span><span class=w> </span><span class=kd>fun</span><span class=w> </span><span class=o>&lt;</span><span class=n>C</span><span class=w> </span><span class=p>:</span><span class=w> </span><span class=n>Any</span><span class=p>,</span><span class=w> </span><span class=n>T</span><span class=w> </span><span class=p>:</span><span class=w> </span><span class=n>Any</span><span class=o>&gt;</span><span class=w> </span><span class=nf>provide</span><span class=p>():</span><span class=w> </span><span class=n>StackAnimation</span><span class=o>&lt;</span><span class=n>C</span><span class=p>,</span><span class=w> </span><span class=n>T</span><span class=o>&gt;</span><span class=w> </span><span class=o>=</span>
<span class=w>        </span><span class=n>stackAnimation</span><span class=p>(</span><span class=n>slide</span><span class=p>()</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=n>scale</span><span class=p>())</span>
<span class=p>}</span>
</code></pre></div> </div> <div class=tabbed-block> <div class=highlight><pre><span></span><code><span class=k>import</span><span class=w> </span><span class=nn>androidx.compose.runtime.Composable</span>
<span class=k>import</span><span class=w> </span><span class=nn>androidx.compose.runtime.CompositionLocalProvider</span>
<span class=k>import</span><span class=w> </span><span class=nn>com.arkivanov.decompose.extensions.compose.experimental.stack.animation.LocalStackAnimationProvider</span>
<span class=k>import</span><span class=w> </span><span class=nn>com.arkivanov.decompose.extensions.compose.experimental.stack.animation.StackAnimation</span>
<span class=k>import</span><span class=w> </span><span class=nn>com.arkivanov.decompose.extensions.compose.experimental.stack.animation.StackAnimationProvider</span>
<span class=k>import</span><span class=w> </span><span class=nn>com.arkivanov.decompose.extensions.compose.experimental.stack.animation.plus</span>
<span class=k>import</span><span class=w> </span><span class=nn>com.arkivanov.decompose.extensions.compose.experimental.stack.animation.scale</span>
<span class=k>import</span><span class=w> </span><span class=nn>com.arkivanov.decompose.extensions.compose.experimental.stack.animation.slide</span>
<span class=k>import</span><span class=w> </span><span class=nn>com.arkivanov.decompose.extensions.compose.experimental.stack.animation.stackAnimation</span>

<span class=nd>@Composable</span>
<span class=kd>fun</span><span class=w> </span><span class=nf>App</span><span class=p>()</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=n>CompositionLocalProvider</span><span class=p>(</span><span class=n>LocalStackAnimationProvider</span><span class=w> </span><span class=n>provides</span><span class=w> </span><span class=n>DefaultStackAnimationProvider</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>        </span><span class=c1>// The rest of the code</span>
<span class=w>    </span><span class=p>}</span>
<span class=p>}</span>

<span class=kd>private</span><span class=w> </span><span class=kd>object</span><span class=w> </span><span class=nc>DefaultStackAnimationProvider</span><span class=w> </span><span class=p>:</span><span class=w> </span><span class=n>StackAnimationProvider</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=kd>override</span><span class=w> </span><span class=kd>fun</span><span class=w> </span><span class=o>&lt;</span><span class=n>C</span><span class=w> </span><span class=p>:</span><span class=w> </span><span class=n>Any</span><span class=p>,</span><span class=w> </span><span class=n>T</span><span class=w> </span><span class=p>:</span><span class=w> </span><span class=n>Any</span><span class=o>&gt;</span><span class=w> </span><span class=nf>provide</span><span class=p>():</span><span class=w> </span><span class=n>StackAnimation</span><span class=o>&lt;</span><span class=n>C</span><span class=p>,</span><span class=w> </span><span class=n>T</span><span class=o>&gt;</span><span class=w> </span><span class=o>=</span>
<span class=w>        </span><span class=n>stackAnimation</span><span class=p>(</span><span class=n>slide</span><span class=p>()</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=n>scale</span><span class=p>())</span>
<span class=p>}</span>
</code></pre></div> </div> </div> </div> <h3 id=custom-animations>Custom animations<a class=headerlink href=#custom-animations title="Permanent link">&para;</a></h3> <p>It is also possible to define custom animations.</p> <h4 id=implementing-stackanimation>Implementing <code>StackAnimation</code><a class=headerlink href=#implementing-stackanimation title="Permanent link">&para;</a></h4> <p>This is the most flexible low-level API. The animation block receives the current <code>ChildStack</code> and animates children using the provided <code>content</code> slot.</p> <div class="tabbed-set tabbed-alternate" data-tabs=9:2><input checked=checked id=__tabbed_9_1 name=__tabbed_9 type=radio><input id=__tabbed_9_2 name=__tabbed_9 type=radio><div class=tabbed-labels><label for=__tabbed_9_1>Default API</label><label for=__tabbed_9_2>Experimental API</label></div> <div class=tabbed-content> <div class=tabbed-block> <div class=highlight><pre><span></span><code><span class=k>import</span><span class=w> </span><span class=nn>androidx.compose.runtime.Composable</span>
<span class=k>import</span><span class=w> </span><span class=nn>androidx.compose.ui.Modifier</span>
<span class=k>import</span><span class=w> </span><span class=nn>com.arkivanov.decompose.Child</span>
<span class=k>import</span><span class=w> </span><span class=nn>com.arkivanov.decompose.extensions.compose.stack.Children</span>
<span class=k>import</span><span class=w> </span><span class=nn>com.arkivanov.decompose.extensions.compose.stack.animation.StackAnimation</span>
<span class=k>import</span><span class=w> </span><span class=nn>com.arkivanov.decompose.router.stack.ChildStack</span>

<span class=nd>@Composable</span>
<span class=kd>fun</span><span class=w> </span><span class=nf>RootContent</span><span class=p>(</span><span class=n>component</span><span class=p>:</span><span class=w> </span><span class=n>RootComponent</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=n>Children</span><span class=p>(</span>
<span class=w>        </span><span class=n>stack</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>component</span><span class=p>.</span><span class=na>childStack</span><span class=p>,</span>
<span class=w>        </span><span class=n>animation</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>someAnimation</span><span class=p>(),</span>
<span class=w>    </span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>        </span><span class=c1>// Omitted code</span>
<span class=w>    </span><span class=p>}</span>
<span class=p>}</span>

<span class=kd>fun</span><span class=w> </span><span class=o>&lt;</span><span class=n>C</span><span class=w> </span><span class=p>:</span><span class=w> </span><span class=n>Any</span><span class=p>,</span><span class=w> </span><span class=n>T</span><span class=w> </span><span class=p>:</span><span class=w> </span><span class=n>Any</span><span class=o>&gt;</span><span class=w> </span><span class=nf>someAnimation</span><span class=p>():</span><span class=w> </span><span class=n>StackAnimation</span><span class=o>&lt;</span><span class=n>C</span><span class=p>,</span><span class=w> </span><span class=n>T</span><span class=o>&gt;</span><span class=w> </span><span class=o>=</span>
<span class=w>    </span><span class=n>StackAnimation</span><span class=w> </span><span class=p>{</span><span class=w> </span><span class=n>stack</span><span class=p>:</span><span class=w> </span><span class=n>ChildStack</span><span class=o>&lt;</span><span class=n>C</span><span class=p>,</span><span class=w> </span><span class=n>T</span><span class=o>&gt;</span><span class=p>,</span>
<span class=w>                     </span><span class=n>modifier</span><span class=p>:</span><span class=w> </span><span class=n>Modifier</span><span class=p>,</span>
<span class=w>                     </span><span class=n>content</span><span class=p>:</span><span class=w> </span><span class=nd>@Composable</span><span class=w> </span><span class=p>(</span><span class=n>Child</span><span class=p>.</span><span class=na>Created</span><span class=o>&lt;</span><span class=n>C</span><span class=p>,</span><span class=w> </span><span class=n>T</span><span class=o>&gt;</span><span class=p>)</span><span class=w> </span><span class=o>-&gt;</span><span class=w> </span><span class=kt>Unit</span><span class=w> </span><span class=o>-&gt;</span>
<span class=w>        </span><span class=c1>// Render each frame here</span>
<span class=w>    </span><span class=p>}</span>
</code></pre></div> </div> <div class=tabbed-block> <div class=highlight><pre><span></span><code><span class=k>import</span><span class=w> </span><span class=nn>androidx.compose.animation.AnimatedVisibilityScope</span>
<span class=k>import</span><span class=w> </span><span class=nn>androidx.compose.runtime.Composable</span>
<span class=k>import</span><span class=w> </span><span class=nn>androidx.compose.ui.Modifier</span>
<span class=k>import</span><span class=w> </span><span class=nn>com.arkivanov.decompose.Child</span>
<span class=k>import</span><span class=w> </span><span class=nn>com.arkivanov.decompose.extensions.compose.experimental.stack.ChildStack</span>
<span class=k>import</span><span class=w> </span><span class=nn>com.arkivanov.decompose.extensions.compose.experimental.stack.animation.StackAnimation</span>
<span class=k>import</span><span class=w> </span><span class=nn>com.arkivanov.decompose.router.stack.ChildStack</span>

<span class=nd>@Composable</span>
<span class=kd>fun</span><span class=w> </span><span class=nf>RootContent</span><span class=p>(</span><span class=n>component</span><span class=p>:</span><span class=w> </span><span class=n>RootComponent</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=n>ChildStack</span><span class=p>(</span>
<span class=w>        </span><span class=n>stack</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>component</span><span class=p>.</span><span class=na>childStack</span><span class=p>,</span>
<span class=w>        </span><span class=n>animation</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>someAnimation</span><span class=p>(),</span>
<span class=w>    </span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>        </span><span class=c1>// Omitted code</span>
<span class=w>    </span><span class=p>}</span>
<span class=p>}</span>

<span class=kd>fun</span><span class=w> </span><span class=o>&lt;</span><span class=n>C</span><span class=w> </span><span class=p>:</span><span class=w> </span><span class=n>Any</span><span class=p>,</span><span class=w> </span><span class=n>T</span><span class=w> </span><span class=p>:</span><span class=w> </span><span class=n>Any</span><span class=o>&gt;</span><span class=w> </span><span class=nf>someAnimation</span><span class=p>():</span><span class=w> </span><span class=n>StackAnimation</span><span class=o>&lt;</span><span class=n>C</span><span class=p>,</span><span class=w> </span><span class=n>T</span><span class=o>&gt;</span><span class=w> </span><span class=o>=</span>
<span class=w>    </span><span class=n>StackAnimation</span><span class=w> </span><span class=p>{</span><span class=w> </span><span class=n>stack</span><span class=p>:</span><span class=w> </span><span class=n>ChildStack</span><span class=o>&lt;</span><span class=n>C</span><span class=p>,</span><span class=w> </span><span class=n>T</span><span class=o>&gt;</span><span class=p>,</span>
<span class=w>                     </span><span class=n>modifier</span><span class=p>:</span><span class=w> </span><span class=n>Modifier</span><span class=p>,</span>
<span class=w>                     </span><span class=n>content</span><span class=p>:</span><span class=w> </span><span class=nd>@Composable</span><span class=w> </span><span class=n>AnimatedVisibilityScope</span><span class=p>.(</span><span class=n>Child</span><span class=p>.</span><span class=na>Created</span><span class=o>&lt;</span><span class=n>C</span><span class=p>,</span><span class=w> </span><span class=n>T</span><span class=o>&gt;</span><span class=p>)</span><span class=w> </span><span class=o>-&gt;</span><span class=w> </span><span class=kt>Unit</span><span class=w> </span><span class=o>-&gt;</span>
<span class=w>        </span><span class=c1>// Render each frame here</span>
<span class=w>    </span><span class=p>}</span>
</code></pre></div> </div> </div> </div> <h4 id=implementing-stackanimator>Implementing <code>StackAnimator</code><a class=headerlink href=#implementing-stackanimator title="Permanent link">&para;</a></h4> <div class="tabbed-set tabbed-alternate" data-tabs=10:2><input checked=checked id=__tabbed_10_1 name=__tabbed_10 type=radio><input id=__tabbed_10_2 name=__tabbed_10 type=radio><div class=tabbed-labels><label for=__tabbed_10_1>Default API</label><label for=__tabbed_10_2>Experimental API</label></div> <div class=tabbed-content> <div class=tabbed-block> <p>The <code>stackAnimation</code> function takes care of tracking the <code>ChildStack</code> changes. <code>StackAnimator</code> is only responsible for manipulating the <code>Modifier</code> in the given <code>direction</code>, and calling <code>onFinished</code> at the end.</p> <div class=highlight><pre><span></span><code><span class=k>import</span><span class=w> </span><span class=nn>androidx.compose.runtime.Composable</span>
<span class=k>import</span><span class=w> </span><span class=nn>androidx.compose.ui.Modifier</span>
<span class=k>import</span><span class=w> </span><span class=nn>com.arkivanov.decompose.extensions.compose.stack.Children</span>
<span class=k>import</span><span class=w> </span><span class=nn>com.arkivanov.decompose.extensions.compose.stack.animation.Direction</span>
<span class=k>import</span><span class=w> </span><span class=nn>com.arkivanov.decompose.extensions.compose.stack.animation.StackAnimator</span>
<span class=k>import</span><span class=w> </span><span class=nn>com.arkivanov.decompose.extensions.compose.stack.animation.stackAnimation</span>

<span class=nd>@Composable</span>
<span class=kd>fun</span><span class=w> </span><span class=nf>RootContent</span><span class=p>(</span><span class=n>component</span><span class=p>:</span><span class=w> </span><span class=n>RootComponent</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=n>Children</span><span class=p>(</span>
<span class=w>        </span><span class=n>stack</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>component</span><span class=p>.</span><span class=na>childStack</span><span class=p>,</span>
<span class=w>        </span><span class=n>animation</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>stackAnimation</span><span class=p>(</span><span class=n>someAnimator</span><span class=p>()),</span>
<span class=w>    </span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>        </span><span class=c1>// Omitted code</span>
<span class=w>    </span><span class=p>}</span>
<span class=p>}</span>

<span class=kd>fun</span><span class=w> </span><span class=nf>someAnimator</span><span class=p>():</span><span class=w> </span><span class=n>StackAnimator</span><span class=w> </span><span class=o>=</span>
<span class=w>    </span><span class=n>StackAnimator</span><span class=w> </span><span class=p>{</span><span class=w> </span><span class=n>direction</span><span class=p>:</span><span class=w> </span><span class=n>Direction</span><span class=p>,</span>
<span class=w>                    </span><span class=n>isInitial</span><span class=p>:</span><span class=w> </span><span class=kt>Boolean</span><span class=p>,</span>
<span class=w>                    </span><span class=n>onFinished</span><span class=p>:</span><span class=w> </span><span class=p>()</span><span class=w> </span><span class=o>-&gt;</span><span class=w> </span><span class=kt>Unit</span><span class=p>,</span>
<span class=w>                    </span><span class=n>content</span><span class=p>:</span><span class=w> </span><span class=nd>@Composable</span><span class=w> </span><span class=p>(</span><span class=n>Modifier</span><span class=p>)</span><span class=w> </span><span class=o>-&gt;</span><span class=w> </span><span class=kt>Unit</span><span class=w> </span><span class=o>-&gt;</span>
<span class=w>        </span><span class=c1>// Manipulate the Modifier in the given direction and call onFinished at the end</span>
<span class=w>    </span><span class=p>}</span>
</code></pre></div> </div> <div class=tabbed-block> <p>The <code>stackAnimation</code> function takes care of tracking the <code>ChildStack</code> changes. <code>StackAnimator</code> is only responsible for animating a <code>Modifier</code> in the given <code>direction</code> and returning it from the <code>StackAnimator</code> composable block.</p> <div class=highlight><pre><span></span><code><span class=k>import</span><span class=w> </span><span class=nn>androidx.compose.runtime.Composable</span>
<span class=k>import</span><span class=w> </span><span class=nn>com.arkivanov.decompose.extensions.compose.experimental.stack.ChildStack</span>
<span class=k>import</span><span class=w> </span><span class=nn>com.arkivanov.decompose.extensions.compose.experimental.stack.animation.StackAnimator</span>
<span class=k>import</span><span class=w> </span><span class=nn>com.arkivanov.decompose.extensions.compose.experimental.stack.animation.stackAnimation</span>
<span class=k>import</span><span class=w> </span><span class=nn>com.arkivanov.decompose.extensions.compose.stack.animation.Direction</span>

<span class=nd>@Composable</span>
<span class=kd>fun</span><span class=w> </span><span class=nf>RootContent</span><span class=p>(</span><span class=n>component</span><span class=p>:</span><span class=w> </span><span class=n>RootComponent</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=n>ChildStack</span><span class=p>(</span>
<span class=w>        </span><span class=n>stack</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>component</span><span class=p>.</span><span class=na>childStack</span><span class=p>,</span>
<span class=w>        </span><span class=n>animation</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>stackAnimation</span><span class=p>(</span><span class=n>someAnimator</span><span class=p>()),</span>
<span class=w>    </span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>        </span><span class=c1>// Omitted code</span>
<span class=w>    </span><span class=p>}</span>
<span class=p>}</span>

<span class=kd>fun</span><span class=w> </span><span class=nf>someAnimator</span><span class=p>():</span><span class=w> </span><span class=n>StackAnimator</span><span class=w> </span><span class=o>=</span>
<span class=w>    </span><span class=n>StackAnimator</span><span class=w> </span><span class=p>{</span><span class=w> </span><span class=n>direction</span><span class=p>:</span><span class=w> </span><span class=n>Direction</span><span class=w> </span><span class=o>-&gt;</span>
<span class=w>        </span><span class=c1>// Animate and return a Modifier for the given direction</span>
<span class=w>    </span><span class=p>}</span>
</code></pre></div> </div> </div> </div> <h4 id=using-stackanimator-function>Using <code>stackAnimator</code> function<a class=headerlink href=#using-stackanimator-function title="Permanent link">&para;</a></h4> <div class="tabbed-set tabbed-alternate" data-tabs=11:2><input checked=checked id=__tabbed_11_1 name=__tabbed_11 type=radio><input id=__tabbed_11_2 name=__tabbed_11 type=radio><div class=tabbed-labels><label for=__tabbed_11_1>Default API</label><label for=__tabbed_11_2>Experimental API</label></div> <div class=tabbed-content> <div class=tabbed-block> <p>This is the simplest, but less powerful way. The <code>stackAnimator</code> function takes care of running the animation. Its block has a very limited responsibility: to render the current frame using the provided <code>factor</code> and <code>direction</code>.</p> <div class=highlight><pre><span></span><code><span class=k>import</span><span class=w> </span><span class=nn>androidx.compose.runtime.Composable</span>
<span class=k>import</span><span class=w> </span><span class=nn>androidx.compose.ui.Modifier</span>
<span class=k>import</span><span class=w> </span><span class=nn>com.arkivanov.decompose.extensions.compose.stack.Children</span>
<span class=k>import</span><span class=w> </span><span class=nn>com.arkivanov.decompose.extensions.compose.stack.animation.Direction</span>
<span class=k>import</span><span class=w> </span><span class=nn>com.arkivanov.decompose.extensions.compose.stack.animation.StackAnimator</span>
<span class=k>import</span><span class=w> </span><span class=nn>com.arkivanov.decompose.extensions.compose.stack.animation.stackAnimation</span>
<span class=k>import</span><span class=w> </span><span class=nn>com.arkivanov.decompose.extensions.compose.stack.animation.stackAnimator</span>

<span class=nd>@Composable</span>
<span class=kd>fun</span><span class=w> </span><span class=nf>RootContent</span><span class=p>(</span><span class=n>component</span><span class=p>:</span><span class=w> </span><span class=n>RootComponent</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=n>Children</span><span class=p>(</span>
<span class=w>        </span><span class=n>stack</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>component</span><span class=p>.</span><span class=na>childStack</span><span class=p>,</span>
<span class=w>        </span><span class=n>animation</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>stackAnimation</span><span class=p>(</span><span class=n>someAnimator</span><span class=p>()),</span>
<span class=w>    </span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>        </span><span class=c1>// Omitted code</span>
<span class=w>    </span><span class=p>}</span>
<span class=p>}</span>

<span class=kd>fun</span><span class=w> </span><span class=nf>someAnimator</span><span class=p>():</span><span class=w> </span><span class=n>StackAnimator</span><span class=w> </span><span class=o>=</span>
<span class=w>    </span><span class=n>stackAnimator</span><span class=w> </span><span class=p>{</span><span class=w> </span><span class=n>factor</span><span class=p>:</span><span class=w> </span><span class=kt>Float</span><span class=p>,</span>
<span class=w>                    </span><span class=n>direction</span><span class=p>:</span><span class=w> </span><span class=n>Direction</span><span class=p>,</span>
<span class=w>                    </span><span class=n>content</span><span class=p>:</span><span class=w> </span><span class=p>(</span><span class=n>Modifier</span><span class=p>)</span><span class=w> </span><span class=o>-&gt;</span><span class=w> </span><span class=kt>Unit</span><span class=w> </span><span class=o>-&gt;</span>
<span class=w>        </span><span class=c1>// Render the current frame</span>
<span class=w>    </span><span class=p>}</span>
</code></pre></div> </div> <div class=tabbed-block> <p>This is the simplest, but less powerful way. The <code>stackAnimator</code> function takes care of running the animation. Its block has a very limited responsibility: to create and return a <code>Modifier</code> for the current frame using the provided <code>factor</code> and <code>direction</code>.</p> <div class=highlight><pre><span></span><code><span class=k>import</span><span class=w> </span><span class=nn>androidx.compose.runtime.Composable</span>
<span class=k>import</span><span class=w> </span><span class=nn>com.arkivanov.decompose.extensions.compose.experimental.stack.ChildStack</span>
<span class=k>import</span><span class=w> </span><span class=nn>com.arkivanov.decompose.extensions.compose.experimental.stack.animation.StackAnimator</span>
<span class=k>import</span><span class=w> </span><span class=nn>com.arkivanov.decompose.extensions.compose.experimental.stack.animation.stackAnimation</span>
<span class=k>import</span><span class=w> </span><span class=nn>com.arkivanov.decompose.extensions.compose.experimental.stack.animation.stackAnimator</span>
<span class=k>import</span><span class=w> </span><span class=nn>com.arkivanov.decompose.extensions.compose.stack.animation.Direction</span>

<span class=nd>@Composable</span>
<span class=kd>fun</span><span class=w> </span><span class=nf>RootContent</span><span class=p>(</span><span class=n>component</span><span class=p>:</span><span class=w> </span><span class=n>RootComponent</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=n>ChildStack</span><span class=p>(</span>
<span class=w>        </span><span class=n>stack</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>component</span><span class=p>.</span><span class=na>childStack</span><span class=p>,</span>
<span class=w>        </span><span class=n>animation</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>stackAnimation</span><span class=p>(</span><span class=n>someAnimator</span><span class=p>()),</span>
<span class=w>    </span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>        </span><span class=c1>// Omitted code</span>
<span class=w>    </span><span class=p>}</span>
<span class=p>}</span>

<span class=kd>fun</span><span class=w> </span><span class=nf>someAnimator</span><span class=p>():</span><span class=w> </span><span class=n>StackAnimator</span><span class=w> </span><span class=o>=</span>
<span class=w>    </span><span class=n>stackAnimator</span><span class=w> </span><span class=p>{</span><span class=w> </span><span class=n>factor</span><span class=p>:</span><span class=w> </span><span class=kt>Float</span><span class=p>,</span><span class=w> </span><span class=n>direction</span><span class=p>:</span><span class=w> </span><span class=n>Direction</span><span class=w> </span><span class=o>-&gt;</span>
<span class=w>        </span><span class=c1>// Create and return a Modifier for the current frame</span>
<span class=w>    </span><span class=p>}</span>
</code></pre></div> </div> </div> </div> <p>Please refer to the predefined animators (<code>fade</code>, <code>slide</code>, etc.) for implementation examples.</p> <h2 id=shared-element-transitions>Shared Element Transitions<a class=headerlink href=#shared-element-transitions title="Permanent link">&para;</a></h2> <p>The support of the <a href=https://developer.android.com/develop/ui/compose/animation/shared-elements>Shared Element Transitions</a> is experimental since version <code>3.2.0-alpha03</code>. It requires using the new experimental animation API from the <a href=#adding-the-dependency-with-the-new-animation-api>extensions-compose-experimental</a> module.</p> <p>The <code>ChildStack</code> composable function exposes <a href=https://developer.android.com/reference/kotlin/androidx/compose/animation/AnimatedVisibilityScope>AnimatedVisibilityScope</a> as a receiver parameter of the <code>content</code> composable block. The scope is automatically controlled by Decompose when playing the animations, including predictive back gesture animations. So this can be used as usual for Shared Element Transitions. Please follow the Jetpack Compose docs linked above for more information and examples.</p> <h2 id=predictive-back-gesture>Predictive Back Gesture<a class=headerlink href=#predictive-back-gesture title="Permanent link">&para;</a></h2> <div class="admonition warning"> <p class=admonition-title>Warning</p> <p>Predictive Back Gesture support is experimental, the API is subject to change.</p> </div> <p><code>Child Stack</code> supports the new <a href=https://developer.android.com/guide/navigation/custom-back/predictive-back-gesture>Android Predictive Back Gesture</a> on all platforms. By default, the gesture animation resembles the <a href=https://developer.android.com/design/ui/mobile/guides/patterns/predictive-back>predictive back design for Android</a>, but it's customizable.</p> <p>If you are using the experimental animation API, then the default gesture animation is the one used by <code>ChildStack</code> composable function. E.g. if you have <code>stackAnimation(slide())</code> specified for <code>ChildStack</code>, then the same slide animation will be playing for predictive back gesture.</p> <p>To enable the gesture, first implement <code>BackHandlerOwner</code> interface in your component with <code>Child Stack</code>, then just pass <code>predictiveBackAnimation</code> to the <code>Children</code> function.</p> <div class=highlight><span class=filename>RootComponent</span><pre><span></span><code><span class=k>import</span><span class=w> </span><span class=nn>com.arkivanov.decompose.ComponentContext</span>
<span class=k>import</span><span class=w> </span><span class=nn>com.arkivanov.decompose.router.stack.ChildStack</span>
<span class=k>import</span><span class=w> </span><span class=nn>com.arkivanov.decompose.router.stack.StackNavigation</span>
<span class=k>import</span><span class=w> </span><span class=nn>com.arkivanov.decompose.value.Value</span>
<span class=k>import</span><span class=w> </span><span class=nn>com.arkivanov.essenty.backhandler.BackHandlerOwner</span>

<span class=kd>interface</span><span class=w> </span><span class=nc>RootComponent</span><span class=w> </span><span class=p>:</span><span class=w> </span><span class=n>BackHandlerOwner</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=kd>val</span><span class=w> </span><span class=nv>childStack</span><span class=p>:</span><span class=w> </span><span class=n>Value</span><span class=o>&lt;</span><span class=n>ChildStack</span><span class=o>&lt;</span><span class=p>...</span><span class=o>&gt;&gt;</span>

<span class=w>    </span><span class=kd>fun</span><span class=w> </span><span class=nf>onBackClicked</span><span class=p>()</span>
<span class=p>}</span>

<span class=kd>class</span><span class=w> </span><span class=nc>DefaultRootComponent</span><span class=p>(</span>
<span class=w>    </span><span class=n>componentContext</span><span class=p>:</span><span class=w> </span><span class=n>ComponentContext</span><span class=p>,</span>
<span class=p>)</span><span class=w> </span><span class=p>:</span><span class=w> </span><span class=n>RootComponent</span><span class=p>,</span><span class=w> </span><span class=n>ComponentContext</span><span class=w> </span><span class=k>by</span><span class=w> </span><span class=n>componentContext</span><span class=p>,</span><span class=w> </span><span class=n>BackHandlerOwner</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=kd>private</span><span class=w> </span><span class=kd>val</span><span class=w> </span><span class=nv>navigation</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>StackNavigation</span><span class=o>&lt;</span><span class=n>Config</span><span class=o>&gt;</span><span class=p>()</span>

<span class=w>    </span><span class=c1>// ComponentContext already implements BackHandlerOwner, no need to implement it separately</span>

<span class=w>    </span><span class=c1>// Omitted body</span>

<span class=w>    </span><span class=kd>override</span><span class=w> </span><span class=kd>fun</span><span class=w> </span><span class=nf>onBackClicked</span><span class=p>()</span><span class=w> </span><span class=p>{</span>
<span class=w>        </span><span class=n>navigation</span><span class=p>.</span><span class=na>pop</span><span class=p>()</span>
<span class=w>    </span><span class=p>}</span>
<span class=p>}</span>
</code></pre></div> <div class="tabbed-set tabbed-alternate" data-tabs=12:2><input checked=checked id=__tabbed_12_1 name=__tabbed_12 type=radio><input id=__tabbed_12_2 name=__tabbed_12 type=radio><div class=tabbed-labels><label for=__tabbed_12_1>Default API</label><label for=__tabbed_12_2>Experimental API</label></div> <div class=tabbed-content> <div class=tabbed-block> <div class=highlight><span class=filename>RootContent</span><pre><span></span><code><span class=k>import</span><span class=w> </span><span class=nn>androidx.compose.runtime.Composable</span>
<span class=k>import</span><span class=w> </span><span class=nn>com.arkivanov.decompose.extensions.compose.stack.Children</span>
<span class=k>import</span><span class=w> </span><span class=nn>com.arkivanov.decompose.extensions.compose.stack.animation.fade</span>
<span class=k>import</span><span class=w> </span><span class=nn>com.arkivanov.decompose.extensions.compose.stack.animation.plus</span>
<span class=k>import</span><span class=w> </span><span class=nn>com.arkivanov.decompose.extensions.compose.stack.animation.predictiveback.predictiveBackAnimation</span>
<span class=k>import</span><span class=w> </span><span class=nn>com.arkivanov.decompose.extensions.compose.stack.animation.scale</span>
<span class=k>import</span><span class=w> </span><span class=nn>com.arkivanov.decompose.extensions.compose.stack.animation.stackAnimation</span>

<span class=nd>@Composable</span>
<span class=kd>fun</span><span class=w> </span><span class=nf>RootContent</span><span class=p>(</span><span class=n>component</span><span class=p>:</span><span class=w> </span><span class=n>RootComponent</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=n>Children</span><span class=p>(</span>
<span class=w>        </span><span class=n>stack</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>component</span><span class=p>.</span><span class=na>childStack</span><span class=p>,</span>
<span class=w>        </span><span class=n>animation</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>predictiveBackAnimation</span><span class=p>(</span>
<span class=w>            </span><span class=n>backHandler</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>component</span><span class=p>.</span><span class=na>backHandler</span><span class=p>,</span>
<span class=w>            </span><span class=n>fallbackAnimation</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>stackAnimation</span><span class=p>(</span><span class=n>fade</span><span class=p>()</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=n>scale</span><span class=p>()),</span><span class=w> </span><span class=c1>// Your usual animation here</span>
<span class=w>            </span><span class=n>onBack</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>component</span><span class=o>::</span><span class=n>onBackClicked</span><span class=p>,</span>
<span class=w>        </span><span class=p>),</span>
<span class=w>    </span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>        </span><span class=c1>// Omitted code</span>
<span class=w>    </span><span class=p>}</span>
<span class=p>}</span>
</code></pre></div> </div> <div class=tabbed-block> <div class=highlight><pre><span></span><code><span class=k>import</span><span class=w> </span><span class=nn>androidx.compose.runtime.Composable</span>
<span class=k>import</span><span class=w> </span><span class=nn>com.arkivanov.decompose.extensions.compose.experimental.stack.ChildStack</span>
<span class=k>import</span><span class=w> </span><span class=nn>com.arkivanov.decompose.extensions.compose.experimental.stack.animation.PredictiveBackParams</span>
<span class=k>import</span><span class=w> </span><span class=nn>com.arkivanov.decompose.extensions.compose.experimental.stack.animation.fade</span>
<span class=k>import</span><span class=w> </span><span class=nn>com.arkivanov.decompose.extensions.compose.experimental.stack.animation.plus</span>
<span class=k>import</span><span class=w> </span><span class=nn>com.arkivanov.decompose.extensions.compose.experimental.stack.animation.scale</span>
<span class=k>import</span><span class=w> </span><span class=nn>com.arkivanov.decompose.extensions.compose.experimental.stack.animation.stackAnimation</span>

<span class=nd>@Composable</span>
<span class=kd>fun</span><span class=w> </span><span class=nf>RootContent</span><span class=p>(</span><span class=n>component</span><span class=p>:</span><span class=w> </span><span class=n>RootComponent</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=n>ChildStack</span><span class=p>(</span>
<span class=w>        </span><span class=n>stack</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>component</span><span class=p>.</span><span class=na>childStack</span><span class=p>,</span>
<span class=w>        </span><span class=n>animation</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>stackAnimation</span><span class=p>(</span>
<span class=w>            </span><span class=n>animator</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>fade</span><span class=p>()</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=n>scale</span><span class=p>(),</span>
<span class=w>            </span><span class=n>predictiveBackParams</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>{</span>
<span class=w>                </span><span class=n>PredictiveBackParams</span><span class=p>(</span>
<span class=w>                    </span><span class=n>backHandler</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>component</span><span class=p>.</span><span class=na>backHandler</span><span class=p>,</span>
<span class=w>                    </span><span class=n>onBack</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>component</span><span class=o>::</span><span class=n>onBackClicked</span><span class=p>,</span>
<span class=w>                </span><span class=p>)</span>
<span class=w>            </span><span class=p>},</span>
<span class=w>        </span><span class=p>),</span>
<span class=w>    </span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>        </span><span class=c1>// Omitted code</span>
<span class=w>    </span><span class=p>}</span>
<span class=p>}</span>
</code></pre></div> </div> </div> </div> <h3 id=predefined-animations>Predefined animations<a class=headerlink href=#predefined-animations title="Permanent link">&para;</a></h3> <div class="tabbed-set tabbed-alternate" data-tabs=13:2><input checked=checked id=__tabbed_13_1 name=__tabbed_13 type=radio><input id=__tabbed_13_2 name=__tabbed_13 type=radio><div class=tabbed-labels><label for=__tabbed_13_1>Default API</label><label for=__tabbed_13_2>Experimental API</label></div> <div class=tabbed-content> <div class=tabbed-block> <p>By default, the gesture animation resembles the <a href=https://developer.android.com/design/ui/mobile/guides/patterns/predictive-back>predictive back design for Android</a> on all platforms. There is no need to do anything special.</p> </div> <div class=tabbed-block> <p>As mentioned earlier, if you are using the experimental animation API, then the default gesture animation is the one used by <code>ChildStack</code> composable function. Use the following code to enable <a href=https://developer.android.com/design/ui/mobile/guides/patterns/predictive-back>predictive back design for Android</a>.</p> <div class=highlight><pre><span></span><code><span class=k>import</span><span class=w> </span><span class=nn>androidx.compose.runtime.Composable</span>
<span class=k>import</span><span class=w> </span><span class=nn>com.arkivanov.decompose.extensions.compose.experimental.stack.ChildStack</span>
<span class=k>import</span><span class=w> </span><span class=nn>com.arkivanov.decompose.extensions.compose.experimental.stack.animation.PredictiveBackParams</span>
<span class=k>import</span><span class=w> </span><span class=nn>com.arkivanov.decompose.extensions.compose.experimental.stack.animation.fade</span>
<span class=k>import</span><span class=w> </span><span class=nn>com.arkivanov.decompose.extensions.compose.experimental.stack.animation.plus</span>
<span class=k>import</span><span class=w> </span><span class=nn>com.arkivanov.decompose.extensions.compose.experimental.stack.animation.scale</span>
<span class=k>import</span><span class=w> </span><span class=nn>com.arkivanov.decompose.extensions.compose.experimental.stack.animation.stackAnimation</span>
<span class=k>import</span><span class=w> </span><span class=nn>com.arkivanov.decompose.extensions.compose.stack.animation.predictiveback.materialPredictiveBackAnimatable</span>

<span class=nd>@Composable</span>
<span class=kd>fun</span><span class=w> </span><span class=nf>RootContent</span><span class=p>(</span><span class=n>component</span><span class=p>:</span><span class=w> </span><span class=n>RootComponent</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=n>ChildStack</span><span class=p>(</span>
<span class=w>        </span><span class=n>stack</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>component</span><span class=p>.</span><span class=na>childStack</span><span class=p>,</span>
<span class=w>        </span><span class=n>animation</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>stackAnimation</span><span class=p>(</span>
<span class=w>            </span><span class=n>animator</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>fade</span><span class=p>()</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=n>scale</span><span class=p>(),</span>
<span class=w>            </span><span class=n>predictiveBackParams</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>{</span>
<span class=w>                </span><span class=n>PredictiveBackParams</span><span class=p>(</span>
<span class=w>                    </span><span class=n>backHandler</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>component</span><span class=p>.</span><span class=na>backHandler</span><span class=p>,</span>
<span class=w>                    </span><span class=n>onBack</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>component</span><span class=o>::</span><span class=n>onBackClicked</span><span class=p>,</span>
<span class=w>                    </span><span class=n>animatable</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=o>::</span><span class=n>materialPredictiveBackAnimatable</span><span class=p>,</span>
<span class=w>                </span><span class=p>)</span>
<span class=w>            </span><span class=p>},</span>
<span class=w>        </span><span class=p>),</span>
<span class=w>    </span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>        </span><span class=c1>// Omitted code</span>
<span class=w>    </span><span class=p>}</span>
<span class=p>}</span>
</code></pre></div> </div> </div> </div> <video width=192 autoplay loop muted><source src=/Decompose/media/BackGestureMaterial.mp4 type=video/mp4></video> <h4 id=standard-android-like-system-animation>Standard Android-like system animation<a class=headerlink href=#standard-android-like-system-animation title="Permanent link">&para;</a></h4> <p>The <code>androidPredictiveBackAnimatable</code> API resembles the standard back gesture animation used on some Android Upside Down Cake devices (e.g. in system settings on Pixel phones).</p> <p>Starting with Decompose version <code>3.4.0-alpha04</code> the function has been renamed to <code>androidPredictiveBackAnimatableV1</code>. Plus, <code>androidPredictiveBackAnimatableV2</code> was added, resembling the standard back gesture animation from Android Vanilla Ice Cream and Baklava.</p> <div class="tabbed-set tabbed-alternate" data-tabs=14:2><input checked=checked id=__tabbed_14_1 name=__tabbed_14 type=radio><input id=__tabbed_14_2 name=__tabbed_14 type=radio><div class=tabbed-labels><label for=__tabbed_14_1>Default API</label><label for=__tabbed_14_2>Experimental API</label></div> <div class=tabbed-content> <div class=tabbed-block> <div class=highlight><pre><span></span><code><span class=k>import</span><span class=w> </span><span class=nn>androidx.compose.runtime.Composable</span>
<span class=k>import</span><span class=w> </span><span class=nn>com.arkivanov.decompose.extensions.compose.stack.Children</span>
<span class=k>import</span><span class=w> </span><span class=nn>com.arkivanov.decompose.extensions.compose.stack.animation.fade</span>
<span class=k>import</span><span class=w> </span><span class=nn>com.arkivanov.decompose.extensions.compose.stack.animation.plus</span>
<span class=k>import</span><span class=w> </span><span class=nn>com.arkivanov.decompose.extensions.compose.stack.animation.predictiveback.androidPredictiveBackAnimatable</span>
<span class=k>import</span><span class=w> </span><span class=nn>com.arkivanov.decompose.extensions.compose.stack.animation.predictiveback.predictiveBackAnimation</span>
<span class=k>import</span><span class=w> </span><span class=nn>com.arkivanov.decompose.extensions.compose.stack.animation.scale</span>
<span class=k>import</span><span class=w> </span><span class=nn>com.arkivanov.decompose.extensions.compose.stack.animation.stackAnimation</span>

<span class=nd>@Composable</span>
<span class=kd>fun</span><span class=w> </span><span class=nf>RootContent</span><span class=p>(</span><span class=n>component</span><span class=p>:</span><span class=w> </span><span class=n>RootComponent</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=n>Children</span><span class=p>(</span>
<span class=w>        </span><span class=n>stack</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>component</span><span class=p>.</span><span class=na>childStack</span><span class=p>,</span>
<span class=w>        </span><span class=n>animation</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>predictiveBackAnimation</span><span class=p>(</span>
<span class=w>            </span><span class=n>backHandler</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>component</span><span class=p>.</span><span class=na>backHandler</span><span class=p>,</span>
<span class=w>            </span><span class=n>fallbackAnimation</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>stackAnimation</span><span class=p>(</span><span class=n>fade</span><span class=p>()</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=n>scale</span><span class=p>()),</span>
<span class=w>            </span><span class=n>selector</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>{</span><span class=w> </span><span class=n>backEvent</span><span class=p>,</span><span class=w> </span><span class=n>_</span><span class=p>,</span><span class=w> </span><span class=n>_</span><span class=w> </span><span class=o>-&gt;</span><span class=w> </span><span class=n>androidPredictiveBackAnimatable</span><span class=p>(</span><span class=n>backEvent</span><span class=p>)</span><span class=w> </span><span class=p>},</span>
<span class=w>            </span><span class=n>onBack</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>component</span><span class=o>::</span><span class=n>onBackClicked</span><span class=p>,</span>
<span class=w>        </span><span class=p>),</span>
<span class=w>    </span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>        </span><span class=c1>// Omitted code</span>
<span class=w>    </span><span class=p>}</span>
<span class=p>}</span>
</code></pre></div> </div> <div class=tabbed-block> <div class=highlight><pre><span></span><code><span class=k>import</span><span class=w> </span><span class=nn>androidx.compose.runtime.Composable</span>
<span class=k>import</span><span class=w> </span><span class=nn>com.arkivanov.decompose.extensions.compose.experimental.stack.ChildStack</span>
<span class=k>import</span><span class=w> </span><span class=nn>com.arkivanov.decompose.extensions.compose.experimental.stack.animation.PredictiveBackParams</span>
<span class=k>import</span><span class=w> </span><span class=nn>com.arkivanov.decompose.extensions.compose.experimental.stack.animation.fade</span>
<span class=k>import</span><span class=w> </span><span class=nn>com.arkivanov.decompose.extensions.compose.experimental.stack.animation.plus</span>
<span class=k>import</span><span class=w> </span><span class=nn>com.arkivanov.decompose.extensions.compose.experimental.stack.animation.scale</span>
<span class=k>import</span><span class=w> </span><span class=nn>com.arkivanov.decompose.extensions.compose.experimental.stack.animation.stackAnimation</span>
<span class=k>import</span><span class=w> </span><span class=nn>com.arkivanov.decompose.extensions.compose.stack.animation.predictiveback.androidPredictiveBackAnimatable</span>

<span class=nd>@Composable</span>
<span class=kd>fun</span><span class=w> </span><span class=nf>RootContent</span><span class=p>(</span><span class=n>component</span><span class=p>:</span><span class=w> </span><span class=n>RootComponent</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=n>ChildStack</span><span class=p>(</span>
<span class=w>        </span><span class=n>stack</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>component</span><span class=p>.</span><span class=na>childStack</span><span class=p>,</span>
<span class=w>        </span><span class=n>animation</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>stackAnimation</span><span class=p>(</span>
<span class=w>            </span><span class=n>animator</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>fade</span><span class=p>()</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=n>scale</span><span class=p>(),</span>
<span class=w>            </span><span class=n>predictiveBackParams</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>{</span>
<span class=w>                </span><span class=n>PredictiveBackParams</span><span class=p>(</span>
<span class=w>                    </span><span class=n>backHandler</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>component</span><span class=p>.</span><span class=na>backHandler</span><span class=p>,</span>
<span class=w>                    </span><span class=n>onBack</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>component</span><span class=o>::</span><span class=n>onBackClicked</span><span class=p>,</span>
<span class=w>                    </span><span class=n>animatable</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=o>::</span><span class=n>androidPredictiveBackAnimatable</span><span class=p>,</span>
<span class=w>                </span><span class=p>)</span>
<span class=w>            </span><span class=p>}</span>
<span class=w>        </span><span class=p>),</span>
<span class=w>    </span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>        </span><span class=c1>// Omitted code</span>
<span class=w>    </span><span class=p>}</span>
<span class=p>}</span>
</code></pre></div> </div> </div> </div> <p>Example of <code>androidPredictiveBackAnimatableV1</code> animation:</p> <video width=192 autoplay loop muted><source src=/Decompose/media/BackGestureAndroidV1.mp4 type=video/mp4></video> <p>Example of <code>androidPredictiveBackAnimatableV2</code> animation:</p> <video width=192 autoplay loop muted><source src=/Decompose/media/BackGestureAndroidV2.mp4 type=video/mp4></video> <h3 id=predictive-back-gesture-on-android>Predictive Back Gesture on Android<a class=headerlink href=#predictive-back-gesture-on-android title="Permanent link">&para;</a></h3> <p>On Android, the predictive back gesture only works starting with Android T. On Android T, it works only between Activities, if enabled in the system settings. Starting with Android U, the predictive back gesture <a href=https://developer.android.com/guide/navigation/custom-back/predictive-back-gesture#opt-predictive>can be enabled</a> between <code>Child Stack</code> screens inside a single Activity.</p> <h3 id=predictive-back-gesture-on-other-platforms>Predictive Back Gesture on other platforms<a class=headerlink href=#predictive-back-gesture-on-other-platforms title="Permanent link">&para;</a></h3> <p>On all other platforms, the predictive back gesture can be enabled by showing a special overlay that automatically handles the gesture and manipulates <code>BackDispatcher</code> as needed.</p> <ol> <li>Create <code>BackDispatcher</code> and assign it to a variable.</li> <li>Create the root <code>DefaultComponentContext</code> and pass the previously created <code>BackDispatcher</code> as <code>backHandler</code> argument.</li> <li>Pass the <strong>same</strong> <code>BackDispatcher</code> to <code>PredictiveBackGestureOverlay</code>.</li> </ol> <div class=highlight><span class=filename>Using Composable PredictiveBackGestureOverlay on iOS</span><pre><span></span><code><span class=k>import</span><span class=w> </span><span class=nn>androidx.compose.foundation.layout.fillMaxSize</span>
<span class=k>import</span><span class=w> </span><span class=nn>androidx.compose.material.icons.Icons</span>
<span class=k>import</span><span class=w> </span><span class=nn>androidx.compose.material.icons.filled.ArrowBack</span>
<span class=k>import</span><span class=w> </span><span class=nn>androidx.compose.ui.Modifier</span>
<span class=k>import</span><span class=w> </span><span class=nn>androidx.compose.ui.window.ComposeUIViewController</span>
<span class=k>import</span><span class=w> </span><span class=nn>com.arkivanov.decompose.extensions.compose.PredictiveBackGestureIcon</span>
<span class=k>import</span><span class=w> </span><span class=nn>com.arkivanov.decompose.extensions.compose.PredictiveBackGestureOverlay</span>
<span class=k>import</span><span class=w> </span><span class=nn>com.arkivanov.essenty.backhandler.BackDispatcher</span>
<span class=k>import</span><span class=w> </span><span class=nn>platform.UIKit.UIViewController</span>

<span class=kd>fun</span><span class=w> </span><span class=nf>rootViewController</span><span class=p>(</span><span class=n>root</span><span class=p>:</span><span class=w> </span><span class=n>RootComponent</span><span class=p>,</span><span class=w> </span><span class=n>backDispatcher</span><span class=p>:</span><span class=w> </span><span class=n>BackDispatcher</span><span class=p>):</span><span class=w> </span><span class=n>UIViewController</span><span class=w> </span><span class=o>=</span>
<span class=w>    </span><span class=n>ComposeUIViewController</span><span class=w> </span><span class=p>{</span>
<span class=w>        </span><span class=n>PredictiveBackGestureOverlay</span><span class=p>(</span>
<span class=w>            </span><span class=n>backDispatcher</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>backDispatcher</span><span class=p>,</span>
<span class=w>            </span><span class=n>backIcon</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>{</span><span class=w> </span><span class=n>progress</span><span class=p>,</span><span class=w> </span><span class=n>_</span><span class=w> </span><span class=o>-&gt;</span>
<span class=w>                </span><span class=n>PredictiveBackGestureIcon</span><span class=p>(</span>
<span class=w>                    </span><span class=n>imageVector</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>Icons</span><span class=p>.</span><span class=na>Default</span><span class=p>.</span><span class=na>ArrowBack</span><span class=p>,</span>
<span class=w>                    </span><span class=n>progress</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>progress</span><span class=p>,</span>
<span class=w>                </span><span class=p>)</span>
<span class=w>            </span><span class=p>},</span>
<span class=w>            </span><span class=n>modifier</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>Modifier</span><span class=p>.</span><span class=na>fillMaxSize</span><span class=p>(),</span>
<span class=w>        </span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>            </span><span class=n>RootContent</span><span class=p>(</span><span class=n>component</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>root</span><span class=p>,</span><span class=w> </span><span class=n>modifier</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>Modifier</span><span class=p>.</span><span class=na>fillMaxSize</span><span class=p>())</span>
<span class=w>        </span><span class=p>}</span>
<span class=w>    </span><span class=p>}</span>
</code></pre></div> <h3 id=predictive-back-gesture-on-ios>Predictive Back Gesture on iOS<a class=headerlink href=#predictive-back-gesture-on-ios title="Permanent link">&para;</a></h3> <p>It is possible to customize the predictive back gesture, so it looks native-ish on iOS.</p> <video width=192 autoplay loop muted><source src=/Decompose/media/BackGestureIos.mp4 type=video/mp4></video> <p>Add the following code in your <code>commonMain</code> source set.</p> <div class="tabbed-set tabbed-alternate" data-tabs=15:2><input checked=checked id=__tabbed_15_1 name=__tabbed_15 type=radio><input id=__tabbed_15_2 name=__tabbed_15 type=radio><div class=tabbed-labels><label for=__tabbed_15_1>Default API</label><label for=__tabbed_15_2>Experimental API</label></div> <div class=tabbed-content> <div class=tabbed-block> <div class=highlight><span class=filename>In commonMain source set</span><pre><span></span><code><span class=k>import</span><span class=w> </span><span class=nn>androidx.compose.runtime.Composable</span>
<span class=k>import</span><span class=w> </span><span class=nn>com.arkivanov.decompose.extensions.compose.stack.Children</span>
<span class=k>import</span><span class=w> </span><span class=nn>com.arkivanov.decompose.extensions.compose.stack.animation.StackAnimation</span>
<span class=k>import</span><span class=w> </span><span class=nn>com.arkivanov.essenty.backhandler.BackHandler</span>

<span class=nd>@Composable</span>
<span class=kd>fun</span><span class=w> </span><span class=nf>RootContent</span><span class=p>(</span><span class=n>component</span><span class=p>:</span><span class=w> </span><span class=n>RootComponent</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=n>Children</span><span class=p>(</span>
<span class=w>        </span><span class=n>stack</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>component</span><span class=p>.</span><span class=na>childStack</span><span class=p>,</span>
<span class=w>        </span><span class=n>animation</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>backAnimation</span><span class=p>(</span>
<span class=w>            </span><span class=n>backHandler</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>component</span><span class=p>.</span><span class=na>backHandler</span><span class=p>,</span>
<span class=w>            </span><span class=n>onBack</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>component</span><span class=o>::</span><span class=n>onBackClicked</span><span class=p>,</span>
<span class=w>        </span><span class=p>),</span>
<span class=w>    </span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>        </span><span class=c1>// Omitted code</span>
<span class=w>    </span><span class=p>}</span>
<span class=p>}</span>

<span class=kd>expect</span><span class=w> </span><span class=kd>fun</span><span class=w> </span><span class=o>&lt;</span><span class=n>C</span><span class=w> </span><span class=p>:</span><span class=w> </span><span class=n>Any</span><span class=p>,</span><span class=w> </span><span class=n>T</span><span class=w> </span><span class=p>:</span><span class=w> </span><span class=n>Any</span><span class=o>&gt;</span><span class=w> </span><span class=nf>backAnimation</span><span class=p>(</span>
<span class=w>    </span><span class=n>backHandler</span><span class=p>:</span><span class=w> </span><span class=n>BackHandler</span><span class=p>,</span>
<span class=w>    </span><span class=n>onBack</span><span class=p>:</span><span class=w> </span><span class=p>()</span><span class=w> </span><span class=o>-&gt;</span><span class=w> </span><span class=kt>Unit</span><span class=p>,</span>
<span class=p>):</span><span class=w> </span><span class=n>StackAnimation</span><span class=o>&lt;</span><span class=n>C</span><span class=p>,</span><span class=w> </span><span class=n>T</span><span class=o>&gt;</span>
</code></pre></div> </div> <div class=tabbed-block> <div class=highlight><span class=filename>In commonMain source set</span><pre><span></span><code><span class=k>import</span><span class=w> </span><span class=nn>androidx.compose.runtime.Composable</span>
<span class=k>import</span><span class=w> </span><span class=nn>com.arkivanov.decompose.extensions.compose.experimental.stack.ChildStack</span>
<span class=k>import</span><span class=w> </span><span class=nn>com.arkivanov.decompose.extensions.compose.experimental.stack.animation.StackAnimation</span>
<span class=k>import</span><span class=w> </span><span class=nn>com.arkivanov.essenty.backhandler.BackHandler</span>

<span class=nd>@Composable</span>
<span class=kd>fun</span><span class=w> </span><span class=nf>RootContent</span><span class=p>(</span><span class=n>component</span><span class=p>:</span><span class=w> </span><span class=n>RootComponent</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=n>ChildStack</span><span class=p>(</span>
<span class=w>        </span><span class=n>stack</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>component</span><span class=p>.</span><span class=na>childStack</span><span class=p>,</span>
<span class=w>        </span><span class=n>animation</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>backAnimation</span><span class=p>(</span>
<span class=w>            </span><span class=n>backHandler</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>component</span><span class=p>.</span><span class=na>backHandler</span><span class=p>,</span>
<span class=w>            </span><span class=n>onBack</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>component</span><span class=o>::</span><span class=n>onBackClicked</span><span class=p>,</span>
<span class=w>        </span><span class=p>),</span>
<span class=w>    </span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>        </span><span class=c1>// Omitted code</span>
<span class=w>    </span><span class=p>}</span>
<span class=p>}</span>

<span class=kd>expect</span><span class=w> </span><span class=kd>fun</span><span class=w> </span><span class=o>&lt;</span><span class=n>C</span><span class=w> </span><span class=p>:</span><span class=w> </span><span class=n>Any</span><span class=p>,</span><span class=w> </span><span class=n>T</span><span class=w> </span><span class=p>:</span><span class=w> </span><span class=n>Any</span><span class=o>&gt;</span><span class=w> </span><span class=nf>backAnimation</span><span class=p>(</span>
<span class=w>    </span><span class=n>backHandler</span><span class=p>:</span><span class=w> </span><span class=n>BackHandler</span><span class=p>,</span>
<span class=w>    </span><span class=n>onBack</span><span class=p>:</span><span class=w> </span><span class=p>()</span><span class=w> </span><span class=o>-&gt;</span><span class=w> </span><span class=kt>Unit</span><span class=p>,</span>
<span class=p>):</span><span class=w> </span><span class=n>StackAnimation</span><span class=o>&lt;</span><span class=n>C</span><span class=p>,</span><span class=w> </span><span class=n>T</span><span class=o>&gt;</span>
</code></pre></div> </div> </div> </div> <p>Add the following code in your <code>androidMain</code> source set.</p> <div class="tabbed-set tabbed-alternate" data-tabs=16:2><input checked=checked id=__tabbed_16_1 name=__tabbed_16 type=radio><input id=__tabbed_16_2 name=__tabbed_16 type=radio><div class=tabbed-labels><label for=__tabbed_16_1>Default API</label><label for=__tabbed_16_2>Experimental API</label></div> <div class=tabbed-content> <div class=tabbed-block> <div class=highlight><span class=filename>In androidMain source set</span><pre><span></span><code><span class=k>import</span><span class=w> </span><span class=nn>com.arkivanov.decompose.extensions.compose.stack.animation.StackAnimation</span>
<span class=k>import</span><span class=w> </span><span class=nn>com.arkivanov.decompose.extensions.compose.stack.animation.fade</span>
<span class=k>import</span><span class=w> </span><span class=nn>com.arkivanov.decompose.extensions.compose.stack.animation.predictiveback.predictiveBackAnimation</span>
<span class=k>import</span><span class=w> </span><span class=nn>com.arkivanov.decompose.extensions.compose.stack.animation.stackAnimation</span>
<span class=k>import</span><span class=w> </span><span class=nn>com.arkivanov.essenty.backhandler.BackHandler</span>

<span class=kd>actual</span><span class=w> </span><span class=kd>fun</span><span class=w> </span><span class=o>&lt;</span><span class=n>C</span><span class=w> </span><span class=p>:</span><span class=w> </span><span class=n>Any</span><span class=p>,</span><span class=w> </span><span class=n>T</span><span class=w> </span><span class=p>:</span><span class=w> </span><span class=n>Any</span><span class=o>&gt;</span><span class=w> </span><span class=nf>backAnimation</span><span class=p>(</span>
<span class=w>    </span><span class=n>backHandler</span><span class=p>:</span><span class=w> </span><span class=n>BackHandler</span><span class=p>,</span>
<span class=w>    </span><span class=n>onBack</span><span class=p>:</span><span class=w> </span><span class=p>()</span><span class=w> </span><span class=o>-&gt;</span><span class=w> </span><span class=kt>Unit</span><span class=p>,</span>
<span class=p>):</span><span class=w> </span><span class=n>StackAnimation</span><span class=o>&lt;</span><span class=n>C</span><span class=p>,</span><span class=w> </span><span class=n>T</span><span class=o>&gt;</span><span class=w> </span><span class=o>=</span>
<span class=w>    </span><span class=n>predictiveBackAnimation</span><span class=p>(</span>
<span class=w>        </span><span class=n>backHandler</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>backHandler</span><span class=p>,</span>
<span class=w>        </span><span class=n>fallbackAnimation</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>stackAnimation</span><span class=p>(</span><span class=n>fade</span><span class=p>()),</span>
<span class=w>        </span><span class=n>onBack</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>onBack</span><span class=p>,</span>
<span class=w>    </span><span class=p>)</span>
</code></pre></div> </div> <div class=tabbed-block> <div class=highlight><pre><span></span><code><span class=k>import</span><span class=w> </span><span class=nn>com.arkivanov.decompose.extensions.compose.experimental.stack.animation.PredictiveBackParams</span>
<span class=k>import</span><span class=w> </span><span class=nn>com.arkivanov.decompose.extensions.compose.experimental.stack.animation.StackAnimation</span>
<span class=k>import</span><span class=w> </span><span class=nn>com.arkivanov.decompose.extensions.compose.experimental.stack.animation.fade</span>
<span class=k>import</span><span class=w> </span><span class=nn>com.arkivanov.decompose.extensions.compose.experimental.stack.animation.stackAnimation</span>
<span class=k>import</span><span class=w> </span><span class=nn>com.arkivanov.decompose.extensions.compose.stack.animation.predictiveback.materialPredictiveBackAnimatable</span>
<span class=k>import</span><span class=w> </span><span class=nn>com.arkivanov.essenty.backhandler.BackHandler</span>

<span class=kd>actual</span><span class=w> </span><span class=kd>fun</span><span class=w> </span><span class=o>&lt;</span><span class=n>C</span><span class=w> </span><span class=p>:</span><span class=w> </span><span class=n>Any</span><span class=p>,</span><span class=w> </span><span class=n>T</span><span class=w> </span><span class=p>:</span><span class=w> </span><span class=n>Any</span><span class=o>&gt;</span><span class=w> </span><span class=nf>backAnimation</span><span class=p>(</span>
<span class=w>    </span><span class=n>backHandler</span><span class=p>:</span><span class=w> </span><span class=n>BackHandler</span><span class=p>,</span>
<span class=w>    </span><span class=n>onBack</span><span class=p>:</span><span class=w> </span><span class=p>()</span><span class=w> </span><span class=o>-&gt;</span><span class=w> </span><span class=kt>Unit</span><span class=p>,</span>
<span class=p>):</span><span class=w> </span><span class=n>StackAnimation</span><span class=o>&lt;</span><span class=n>C</span><span class=p>,</span><span class=w> </span><span class=n>T</span><span class=o>&gt;</span><span class=w> </span><span class=o>=</span>
<span class=w>    </span><span class=n>stackAnimation</span><span class=p>(</span>
<span class=w>        </span><span class=n>animator</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>fade</span><span class=p>(),</span>
<span class=w>        </span><span class=n>predictiveBackParams</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>PredictiveBackParams</span><span class=p>(</span>
<span class=w>            </span><span class=n>backHandler</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>backHandler</span><span class=p>,</span>
<span class=w>            </span><span class=n>onBack</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>onBack</span><span class=p>,</span>
<span class=w>            </span><span class=n>animatable</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=o>::</span><span class=n>materialPredictiveBackAnimatable</span><span class=p>,</span>
<span class=w>        </span><span class=p>)</span>
<span class=w>    </span><span class=p>)</span>
</code></pre></div> </div> </div> </div> <p>Add the following code in your <code>iosMain</code> source set.</p> <div class="tabbed-set tabbed-alternate" data-tabs=17:2><input checked=checked id=__tabbed_17_1 name=__tabbed_17 type=radio><input id=__tabbed_17_2 name=__tabbed_17 type=radio><div class=tabbed-labels><label for=__tabbed_17_1>Default API</label><label for=__tabbed_17_2>Experimental API</label></div> <div class=tabbed-content> <div class=tabbed-block> <div class=highlight><span class=filename>In iosMain source set</span><pre><span></span><code><span class=k>import</span><span class=w> </span><span class=nn>androidx.compose.animation.core.FiniteAnimationSpec</span>
<span class=k>import</span><span class=w> </span><span class=nn>androidx.compose.animation.core.tween</span>
<span class=k>import</span><span class=w> </span><span class=nn>androidx.compose.ui.Modifier</span>
<span class=k>import</span><span class=w> </span><span class=nn>androidx.compose.ui.draw.drawWithContent</span>
<span class=k>import</span><span class=w> </span><span class=nn>androidx.compose.ui.graphics.Color</span>
<span class=k>import</span><span class=w> </span><span class=nn>androidx.compose.ui.layout.layout</span>
<span class=k>import</span><span class=w> </span><span class=nn>com.arkivanov.decompose.extensions.compose.stack.animation.StackAnimation</span>
<span class=k>import</span><span class=w> </span><span class=nn>com.arkivanov.decompose.extensions.compose.stack.animation.StackAnimator</span>
<span class=k>import</span><span class=w> </span><span class=nn>com.arkivanov.decompose.extensions.compose.stack.animation.isFront</span>
<span class=k>import</span><span class=w> </span><span class=nn>com.arkivanov.decompose.extensions.compose.stack.animation.predictiveback.predictiveBackAnimatable</span>
<span class=k>import</span><span class=w> </span><span class=nn>com.arkivanov.decompose.extensions.compose.stack.animation.predictiveback.predictiveBackAnimation</span>
<span class=k>import</span><span class=w> </span><span class=nn>com.arkivanov.decompose.extensions.compose.stack.animation.stackAnimation</span>
<span class=k>import</span><span class=w> </span><span class=nn>com.arkivanov.decompose.extensions.compose.stack.animation.stackAnimator</span>
<span class=k>import</span><span class=w> </span><span class=nn>com.arkivanov.essenty.backhandler.BackHandler</span>

<span class=kd>actual</span><span class=w> </span><span class=kd>fun</span><span class=w> </span><span class=o>&lt;</span><span class=n>C</span><span class=w> </span><span class=p>:</span><span class=w> </span><span class=n>Any</span><span class=p>,</span><span class=w> </span><span class=n>T</span><span class=w> </span><span class=p>:</span><span class=w> </span><span class=n>Any</span><span class=o>&gt;</span><span class=w> </span><span class=nf>backAnimation</span><span class=p>(</span>
<span class=w>    </span><span class=n>backHandler</span><span class=p>:</span><span class=w> </span><span class=n>BackHandler</span><span class=p>,</span>
<span class=w>    </span><span class=n>onBack</span><span class=p>:</span><span class=w> </span><span class=p>()</span><span class=w> </span><span class=o>-&gt;</span><span class=w> </span><span class=kt>Unit</span><span class=p>,</span>
<span class=p>):</span><span class=w> </span><span class=n>StackAnimation</span><span class=o>&lt;</span><span class=n>C</span><span class=p>,</span><span class=w> </span><span class=n>T</span><span class=o>&gt;</span><span class=w> </span><span class=o>=</span>
<span class=w>    </span><span class=n>predictiveBackAnimation</span><span class=p>(</span>
<span class=w>        </span><span class=n>backHandler</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>backHandler</span><span class=p>,</span>
<span class=w>        </span><span class=n>fallbackAnimation</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>stackAnimation</span><span class=p>(</span><span class=n>iosLikeSlide</span><span class=p>()),</span>
<span class=w>        </span><span class=n>selector</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>{</span><span class=w> </span><span class=n>initialBackEvent</span><span class=p>,</span><span class=w> </span><span class=n>_</span><span class=p>,</span><span class=w> </span><span class=n>_</span><span class=w> </span><span class=o>-&gt;</span>
<span class=w>            </span><span class=n>predictiveBackAnimatable</span><span class=p>(</span>
<span class=w>                </span><span class=n>initialBackEvent</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>initialBackEvent</span><span class=p>,</span>
<span class=w>                </span><span class=n>exitModifier</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>{</span><span class=w> </span><span class=n>progress</span><span class=p>,</span><span class=w> </span><span class=n>_</span><span class=w> </span><span class=o>-&gt;</span><span class=w> </span><span class=n>Modifier</span><span class=p>.</span><span class=na>slideExitModifier</span><span class=p>(</span><span class=n>progress</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>progress</span><span class=p>)</span><span class=w> </span><span class=p>},</span>
<span class=w>                </span><span class=n>enterModifier</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>{</span><span class=w> </span><span class=n>progress</span><span class=p>,</span><span class=w> </span><span class=n>_</span><span class=w> </span><span class=o>-&gt;</span><span class=w> </span><span class=n>Modifier</span><span class=p>.</span><span class=na>slideEnterModifier</span><span class=p>(</span><span class=n>progress</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>progress</span><span class=p>)</span><span class=w> </span><span class=p>},</span>
<span class=w>            </span><span class=p>)</span>
<span class=w>        </span><span class=p>},</span>
<span class=w>        </span><span class=n>onBack</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>onBack</span><span class=p>,</span>
<span class=w>    </span><span class=p>)</span>

<span class=kd>private</span><span class=w> </span><span class=kd>fun</span><span class=w> </span><span class=nf>iosLikeSlide</span><span class=p>(</span><span class=n>animationSpec</span><span class=p>:</span><span class=w> </span><span class=n>FiniteAnimationSpec</span><span class=o>&lt;</span><span class=kt>Float</span><span class=o>&gt;</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>tween</span><span class=p>()):</span><span class=w> </span><span class=n>StackAnimator</span><span class=w> </span><span class=o>=</span>
<span class=w>    </span><span class=n>stackAnimator</span><span class=p>(</span><span class=n>animationSpec</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>animationSpec</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w> </span><span class=n>factor</span><span class=p>,</span><span class=w> </span><span class=n>direction</span><span class=p>,</span><span class=w> </span><span class=n>content</span><span class=w> </span><span class=o>-&gt;</span>
<span class=w>        </span><span class=n>content</span><span class=p>(</span>
<span class=w>            </span><span class=n>Modifier</span>
<span class=w>                </span><span class=p>.</span><span class=na>then</span><span class=p>(</span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>direction</span><span class=p>.</span><span class=na>isFront</span><span class=p>)</span><span class=w> </span><span class=n>Modifier</span><span class=w> </span><span class=k>else</span><span class=w> </span><span class=n>Modifier</span><span class=p>.</span><span class=na>fade</span><span class=p>(</span><span class=n>factor</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=m>1F</span><span class=p>))</span>
<span class=w>                </span><span class=p>.</span><span class=na>offsetXFactor</span><span class=p>(</span><span class=n>factor</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>direction</span><span class=p>.</span><span class=na>isFront</span><span class=p>)</span><span class=w> </span><span class=n>factor</span><span class=w> </span><span class=k>else</span><span class=w> </span><span class=n>factor</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=m>0.5F</span><span class=p>)</span>
<span class=w>        </span><span class=p>)</span>
<span class=w>    </span><span class=p>}</span>

<span class=kd>private</span><span class=w> </span><span class=kd>fun</span><span class=w> </span><span class=n>Modifier</span><span class=p>.</span><span class=nf>slideExitModifier</span><span class=p>(</span><span class=n>progress</span><span class=p>:</span><span class=w> </span><span class=kt>Float</span><span class=p>):</span><span class=w> </span><span class=n>Modifier</span><span class=w> </span><span class=o>=</span>
<span class=w>    </span><span class=n>offsetXFactor</span><span class=p>(</span><span class=n>progress</span><span class=p>)</span>

<span class=kd>private</span><span class=w> </span><span class=kd>fun</span><span class=w> </span><span class=n>Modifier</span><span class=p>.</span><span class=nf>slideEnterModifier</span><span class=p>(</span><span class=n>progress</span><span class=p>:</span><span class=w> </span><span class=kt>Float</span><span class=p>):</span><span class=w> </span><span class=n>Modifier</span><span class=w> </span><span class=o>=</span>
<span class=w>    </span><span class=n>fade</span><span class=p>(</span><span class=n>progress</span><span class=p>).</span><span class=na>offsetXFactor</span><span class=p>((</span><span class=n>progress</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=m>1f</span><span class=p>)</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=m>0.5f</span><span class=p>)</span>

<span class=kd>private</span><span class=w> </span><span class=kd>fun</span><span class=w> </span><span class=n>Modifier</span><span class=p>.</span><span class=nf>fade</span><span class=p>(</span><span class=n>factor</span><span class=p>:</span><span class=w> </span><span class=kt>Float</span><span class=p>)</span><span class=w> </span><span class=o>=</span>
<span class=w>    </span><span class=n>drawWithContent</span><span class=w> </span><span class=p>{</span>
<span class=w>        </span><span class=n>drawContent</span><span class=p>()</span>
<span class=w>        </span><span class=n>drawRect</span><span class=p>(</span><span class=n>color</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>Color</span><span class=p>(</span><span class=n>red</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=m>0F</span><span class=p>,</span><span class=w> </span><span class=n>green</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=m>0F</span><span class=p>,</span><span class=w> </span><span class=n>blue</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=m>0F</span><span class=p>,</span><span class=w> </span><span class=n>alpha</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>(</span><span class=m>1F</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=n>factor</span><span class=p>)</span><span class=w> </span><span class=o>/</span><span class=w> </span><span class=m>4F</span><span class=p>))</span>
<span class=w>    </span><span class=p>}</span>

<span class=kd>private</span><span class=w> </span><span class=kd>fun</span><span class=w> </span><span class=n>Modifier</span><span class=p>.</span><span class=nf>offsetXFactor</span><span class=p>(</span><span class=n>factor</span><span class=p>:</span><span class=w> </span><span class=kt>Float</span><span class=p>):</span><span class=w> </span><span class=n>Modifier</span><span class=w> </span><span class=o>=</span>
<span class=w>    </span><span class=n>layout</span><span class=w> </span><span class=p>{</span><span class=w> </span><span class=n>measurable</span><span class=p>,</span><span class=w> </span><span class=n>constraints</span><span class=w> </span><span class=o>-&gt;</span>
<span class=w>        </span><span class=kd>val</span><span class=w> </span><span class=nv>placeable</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>measurable</span><span class=p>.</span><span class=na>measure</span><span class=p>(</span><span class=n>constraints</span><span class=p>)</span>

<span class=w>        </span><span class=n>layout</span><span class=p>(</span><span class=n>placeable</span><span class=p>.</span><span class=na>width</span><span class=p>,</span><span class=w> </span><span class=n>placeable</span><span class=p>.</span><span class=na>height</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>            </span><span class=n>placeable</span><span class=p>.</span><span class=na>placeRelative</span><span class=p>(</span><span class=n>x</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>(</span><span class=n>placeable</span><span class=p>.</span><span class=na>width</span><span class=p>.</span><span class=na>toFloat</span><span class=p>()</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=n>factor</span><span class=p>).</span><span class=na>toInt</span><span class=p>(),</span><span class=w> </span><span class=n>y</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=m>0</span><span class=p>)</span>
<span class=w>        </span><span class=p>}</span>
<span class=w>    </span><span class=p>}</span>
</code></pre></div> </div> <div class=tabbed-block> <div class=highlight><pre><span></span><code><span class=k>import</span><span class=w> </span><span class=nn>androidx.compose.animation.core.FiniteAnimationSpec</span>
<span class=k>import</span><span class=w> </span><span class=nn>androidx.compose.animation.core.tween</span>
<span class=k>import</span><span class=w> </span><span class=nn>androidx.compose.ui.Modifier</span>
<span class=k>import</span><span class=w> </span><span class=nn>androidx.compose.ui.draw.drawWithContent</span>
<span class=k>import</span><span class=w> </span><span class=nn>androidx.compose.ui.graphics.Color</span>
<span class=k>import</span><span class=w> </span><span class=nn>androidx.compose.ui.layout.layout</span>
<span class=k>import</span><span class=w> </span><span class=nn>com.arkivanov.decompose.extensions.compose.experimental.stack.animation.PredictiveBackParams</span>
<span class=k>import</span><span class=w> </span><span class=nn>com.arkivanov.decompose.extensions.compose.experimental.stack.animation.StackAnimation</span>
<span class=k>import</span><span class=w> </span><span class=nn>com.arkivanov.decompose.extensions.compose.experimental.stack.animation.StackAnimator</span>
<span class=k>import</span><span class=w> </span><span class=nn>com.arkivanov.decompose.extensions.compose.experimental.stack.animation.stackAnimation</span>
<span class=k>import</span><span class=w> </span><span class=nn>com.arkivanov.decompose.extensions.compose.experimental.stack.animation.stackAnimator</span>
<span class=k>import</span><span class=w> </span><span class=nn>com.arkivanov.decompose.extensions.compose.stack.animation.isFront</span>
<span class=k>import</span><span class=w> </span><span class=nn>com.arkivanov.essenty.backhandler.BackHandler</span>

<span class=kd>actual</span><span class=w> </span><span class=kd>fun</span><span class=w> </span><span class=o>&lt;</span><span class=n>C</span><span class=w> </span><span class=p>:</span><span class=w> </span><span class=n>Any</span><span class=p>,</span><span class=w> </span><span class=n>T</span><span class=w> </span><span class=p>:</span><span class=w> </span><span class=n>Any</span><span class=o>&gt;</span><span class=w> </span><span class=nf>backAnimation</span><span class=p>(</span>
<span class=w>    </span><span class=n>backHandler</span><span class=p>:</span><span class=w> </span><span class=n>BackHandler</span><span class=p>,</span>
<span class=w>    </span><span class=n>onBack</span><span class=p>:</span><span class=w> </span><span class=p>()</span><span class=w> </span><span class=o>-&gt;</span><span class=w> </span><span class=kt>Unit</span><span class=p>,</span>
<span class=p>):</span><span class=w> </span><span class=n>StackAnimation</span><span class=o>&lt;</span><span class=n>C</span><span class=p>,</span><span class=w> </span><span class=n>T</span><span class=o>&gt;</span><span class=w> </span><span class=o>=</span>
<span class=w>    </span><span class=n>stackAnimation</span><span class=p>(</span>
<span class=w>        </span><span class=n>animator</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>iosLikeSlide</span><span class=p>(),</span>
<span class=w>        </span><span class=n>predictiveBackParams</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>{</span>
<span class=w>            </span><span class=n>PredictiveBackParams</span><span class=p>(</span>
<span class=w>                </span><span class=n>backHandler</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>backHandler</span><span class=p>,</span>
<span class=w>                </span><span class=n>onBack</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>onBack</span><span class=p>,</span>
<span class=w>            </span><span class=p>)</span>
<span class=w>        </span><span class=p>},</span>
<span class=w>    </span><span class=p>)</span>

<span class=kd>private</span><span class=w> </span><span class=kd>fun</span><span class=w> </span><span class=nf>iosLikeSlide</span><span class=p>(</span><span class=n>animationSpec</span><span class=p>:</span><span class=w> </span><span class=n>FiniteAnimationSpec</span><span class=o>&lt;</span><span class=kt>Float</span><span class=o>&gt;</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>tween</span><span class=p>()):</span><span class=w> </span><span class=n>StackAnimator</span><span class=w> </span><span class=o>=</span>
<span class=w>    </span><span class=n>stackAnimator</span><span class=p>(</span><span class=n>animationSpec</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>animationSpec</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w> </span><span class=n>factor</span><span class=p>,</span><span class=w> </span><span class=n>direction</span><span class=w> </span><span class=o>-&gt;</span>
<span class=w>        </span><span class=n>Modifier</span>
<span class=w>            </span><span class=p>.</span><span class=na>then</span><span class=p>(</span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>direction</span><span class=p>.</span><span class=na>isFront</span><span class=p>)</span><span class=w> </span><span class=n>Modifier</span><span class=w> </span><span class=k>else</span><span class=w> </span><span class=n>Modifier</span><span class=p>.</span><span class=na>fade</span><span class=p>(</span><span class=n>factor</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=m>1F</span><span class=p>))</span>
<span class=w>            </span><span class=p>.</span><span class=na>offsetXFactor</span><span class=p>(</span><span class=n>factor</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>direction</span><span class=p>.</span><span class=na>isFront</span><span class=p>)</span><span class=w> </span><span class=n>factor</span><span class=w> </span><span class=k>else</span><span class=w> </span><span class=n>factor</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=m>0.5F</span><span class=p>)</span>
<span class=w>    </span><span class=p>}</span>

<span class=kd>private</span><span class=w> </span><span class=kd>fun</span><span class=w> </span><span class=n>Modifier</span><span class=p>.</span><span class=nf>fade</span><span class=p>(</span><span class=n>factor</span><span class=p>:</span><span class=w> </span><span class=kt>Float</span><span class=p>)</span><span class=w> </span><span class=o>=</span>
<span class=w>    </span><span class=n>drawWithContent</span><span class=w> </span><span class=p>{</span>
<span class=w>        </span><span class=n>drawContent</span><span class=p>()</span>
<span class=w>        </span><span class=n>drawRect</span><span class=p>(</span><span class=n>color</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>Color</span><span class=p>(</span><span class=n>red</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=m>0F</span><span class=p>,</span><span class=w> </span><span class=n>green</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=m>0F</span><span class=p>,</span><span class=w> </span><span class=n>blue</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=m>0F</span><span class=p>,</span><span class=w> </span><span class=n>alpha</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>(</span><span class=m>1F</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=n>factor</span><span class=p>)</span><span class=w> </span><span class=o>/</span><span class=w> </span><span class=m>4F</span><span class=p>))</span>
<span class=w>    </span><span class=p>}</span>

<span class=kd>private</span><span class=w> </span><span class=kd>fun</span><span class=w> </span><span class=n>Modifier</span><span class=p>.</span><span class=nf>offsetXFactor</span><span class=p>(</span><span class=n>factor</span><span class=p>:</span><span class=w> </span><span class=kt>Float</span><span class=p>):</span><span class=w> </span><span class=n>Modifier</span><span class=w> </span><span class=o>=</span>
<span class=w>    </span><span class=n>layout</span><span class=w> </span><span class=p>{</span><span class=w> </span><span class=n>measurable</span><span class=p>,</span><span class=w> </span><span class=n>constraints</span><span class=w> </span><span class=o>-&gt;</span>
<span class=w>        </span><span class=kd>val</span><span class=w> </span><span class=nv>placeable</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>measurable</span><span class=p>.</span><span class=na>measure</span><span class=p>(</span><span class=n>constraints</span><span class=p>)</span>

<span class=w>        </span><span class=n>layout</span><span class=p>(</span><span class=n>placeable</span><span class=p>.</span><span class=na>width</span><span class=p>,</span><span class=w> </span><span class=n>placeable</span><span class=p>.</span><span class=na>height</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<span class=w>            </span><span class=n>placeable</span><span class=p>.</span><span class=na>placeRelative</span><span class=p>(</span><span class=n>x</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>(</span><span class=n>placeable</span><span class=p>.</span><span class=na>width</span><span class=p>.</span><span class=na>toFloat</span><span class=p>()</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=n>factor</span><span class=p>).</span><span class=na>toInt</span><span class=p>(),</span><span class=w> </span><span class=n>y</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=m>0</span><span class=p>)</span>
<span class=w>        </span><span class=p>}</span>
<span class=w>    </span><span class=p>}</span>
</code></pre></div> </div> </div> </div> </article> </div> <script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script> </div> </main> <footer class=md-footer> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-copyright> <div class=md-copyright__highlight> Copyright &copy; 2020 - 2024 Arkadii Ivanov </div> Made with <a href=https://squidfunk.github.io/mkdocs-material/ target=_blank rel=noopener> Material for MkDocs </a> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <script id=__config type=application/json>{"annotate": null, "base": "../..", "features": ["navigation.tabs", "navigation.expand"], "search": "../../assets/javascripts/workers/search.2c215733.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script> <script src=../../assets/javascripts/bundle.79ae519e.min.js></script> </body> </html>